[0m22:39:00.179624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026133286450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026133530250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026133533B50>]}


============================== 22:39:00.201562 | 2cf15a45-bd8c-4264-acca-4a0edd8e51e4 ==============================
[0m22:39:00.201562 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:39:00.201562 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'logs', 'version_check': 'True', 'profiles_dir': "C:\\Users\\meg\\Documents\\cam\\proj\\It's On Sale\\its-on-sale-tracker\\pipeline\\transform\\its_on_sale", 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:39:00.239434 [info ] [MainThread]: dbt version: 1.8.7
[0m22:39:00.240546 [info ] [MainThread]: python version: 3.11.9
[0m22:39:00.240546 [info ] [MainThread]: python path: C:\Users\meg\Documents\cam\proj\It's On Sale\its-on-sale-tracker\.venv\Scripts\python.exe
[0m22:39:00.241611 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m22:39:00.242628 [error] [MainThread]: Encountered an error:
cannot access local variable 'summary_message' where it is not associated with a value
[0m22:39:00.286433 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\meg\Documents\cam\proj\It's On Sale\its-on-sale-tracker\.venv\Lib\site-packages\dbt\cli\requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\meg\Documents\cam\proj\It's On Sale\its-on-sale-tracker\.venv\Lib\site-packages\dbt\cli\requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\meg\Documents\cam\proj\It's On Sale\its-on-sale-tracker\.venv\Lib\site-packages\dbt\cli\main.py", line 406, in debug
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\meg\Documents\cam\proj\It's On Sale\its-on-sale-tracker\.venv\Lib\site-packages\dbt\task\debug.py", line 120, in run
    load_profile_status: SubtaskStatus = self._load_profile()
                                         ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\meg\Documents\cam\proj\It's On Sale\its-on-sale-tracker\.venv\Lib\site-packages\dbt\task\debug.py", line 207, in _load_profile
    profile_names, summary_message = self._choose_profile_names()
                                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\meg\Documents\cam\proj\It's On Sale\its-on-sale-tracker\.venv\Lib\site-packages\dbt\task\debug.py", line 282, in _choose_profile_names
    return profiles, summary_message
                     ^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'summary_message' where it is not associated with a value

[0m22:39:00.288587 [debug] [MainThread]: Command `dbt debug` failed at 22:39:00.288587 after 0.15 seconds
[0m22:39:00.289596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026133530150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026133530890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026133335B50>]}
[0m22:39:00.290619 [debug] [MainThread]: Flushing usage events
[0m22:41:08.933268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240639BB310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024066C5DC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024066E68D90>]}


============================== 22:41:08.937397 | e418a20e-9ae5-4a7c-86ec-6f49a09c7cfd ==============================
[0m22:41:08.937397 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:41:08.938405 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\meg\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:41:08.961170 [info ] [MainThread]: dbt version: 1.8.7
[0m22:41:08.961170 [info ] [MainThread]: python version: 3.11.9
[0m22:41:08.962176 [info ] [MainThread]: python path: C:\Users\meg\Documents\cam\proj\It's On Sale\its-on-sale-tracker\.venv\Scripts\python.exe
[0m22:41:08.962176 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m22:41:08.963188 [info ] [MainThread]: Using profiles dir at C:\Users\meg\.dbt
[0m22:41:08.964193 [info ] [MainThread]: Using profiles.yml file at C:\Users\meg\.dbt\profiles.yml
[0m22:41:08.964193 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\meg\Documents\cam\proj\It's On Sale\its-on-sale-tracker\pipeline\transform\its_on_sale\dbt_project.yml
[0m22:41:08.965200 [info ] [MainThread]: Configuration:
[0m22:41:08.966205 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m22:41:08.966205 [info ] [MainThread]:   dbt_project.yml file [[31mERROR invalid[0m]
[0m22:41:08.967209 [info ] [MainThread]: Required dependencies:
[0m22:41:08.967209 [debug] [MainThread]: Executing "git --help"
[0m22:41:09.012301 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:41:09.013306 [debug] [MainThread]: STDERR: "b''"
[0m22:41:09.014400 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:41:09.014400 [info ] [MainThread]: Connection test skipped since no profile was found
[0m22:41:09.015406 [info ] [MainThread]: [31m2 checks failed:[0m
[0m22:41:09.015406 [info ] [MainThread]: dbt looked for a profiles.yml file in C:\Users\meg\.dbt\profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m22:41:09.016758 [info ] [MainThread]: Project loading failed for the following reason:
Runtime Error
  dbt_project.yml does not parse to a dictionary


[0m22:41:09.017767 [debug] [MainThread]: Command `dbt debug` failed at 22:41:09.017767 after 0.16 seconds
[0m22:41:09.018779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024066E68A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024066E68150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024066A661D0>]}
[0m22:41:09.019784 [debug] [MainThread]: Flushing usage events
[0m22:42:16.143549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A5C14BA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A5C150350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A5C152010>]}


============================== 22:42:16.148780 | 70b3ca54-a85b-43c9-9316-45d43795b77a ==============================
[0m22:42:16.148780 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:42:16.149798 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': "C:\\Users\\meg\\Documents\\cam\\proj\\It's On Sale\\its-on-sale-tracker\\pipeline\\transform", 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m22:42:16.177326 [info ] [MainThread]: dbt version: 1.8.7
[0m22:42:16.177326 [info ] [MainThread]: python version: 3.11.9
[0m22:42:16.178326 [info ] [MainThread]: python path: C:\Users\meg\Documents\cam\proj\It's On Sale\its-on-sale-tracker\.venv\Scripts\python.exe
[0m22:42:16.179327 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m22:42:16.180327 [error] [MainThread]: Encountered an error:
cannot access local variable 'summary_message' where it is not associated with a value
[0m22:42:16.183328 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\meg\Documents\cam\proj\It's On Sale\its-on-sale-tracker\.venv\Lib\site-packages\dbt\cli\requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\meg\Documents\cam\proj\It's On Sale\its-on-sale-tracker\.venv\Lib\site-packages\dbt\cli\requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\meg\Documents\cam\proj\It's On Sale\its-on-sale-tracker\.venv\Lib\site-packages\dbt\cli\main.py", line 406, in debug
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\meg\Documents\cam\proj\It's On Sale\its-on-sale-tracker\.venv\Lib\site-packages\dbt\task\debug.py", line 120, in run
    load_profile_status: SubtaskStatus = self._load_profile()
                                         ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\meg\Documents\cam\proj\It's On Sale\its-on-sale-tracker\.venv\Lib\site-packages\dbt\task\debug.py", line 207, in _load_profile
    profile_names, summary_message = self._choose_profile_names()
                                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\meg\Documents\cam\proj\It's On Sale\its-on-sale-tracker\.venv\Lib\site-packages\dbt\task\debug.py", line 282, in _choose_profile_names
    return profiles, summary_message
                     ^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'summary_message' where it is not associated with a value

[0m22:42:16.185328 [debug] [MainThread]: Command `dbt debug` failed at 22:42:16.185328 after 0.08 seconds
[0m22:42:16.186328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A5C15F850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A5C15FB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A54930B90>]}
[0m22:42:16.187330 [debug] [MainThread]: Flushing usage events
[0m22:44:14.424341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8C9D9BFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8C8AC0590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8C9D9BCD0>]}


============================== 22:44:14.428359 | 65b0d730-02c9-4629-855d-3dad360d67ac ==============================
[0m22:44:14.428359 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:44:14.429366 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '..\\', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug --profiles-dir ..\\', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:44:14.455870 [info ] [MainThread]: dbt version: 1.8.7
[0m22:44:14.456906 [info ] [MainThread]: python version: 3.11.9
[0m22:44:14.457917 [info ] [MainThread]: python path: C:\Users\meg\Documents\cam\proj\It's On Sale\its-on-sale-tracker\.venv\Scripts\python.exe
[0m22:44:14.457917 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m22:44:14.458922 [error] [MainThread]: Encountered an error:
cannot access local variable 'summary_message' where it is not associated with a value
[0m22:44:14.461938 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\meg\Documents\cam\proj\It's On Sale\its-on-sale-tracker\.venv\Lib\site-packages\dbt\cli\requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\meg\Documents\cam\proj\It's On Sale\its-on-sale-tracker\.venv\Lib\site-packages\dbt\cli\requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\meg\Documents\cam\proj\It's On Sale\its-on-sale-tracker\.venv\Lib\site-packages\dbt\cli\main.py", line 406, in debug
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\meg\Documents\cam\proj\It's On Sale\its-on-sale-tracker\.venv\Lib\site-packages\dbt\task\debug.py", line 120, in run
    load_profile_status: SubtaskStatus = self._load_profile()
                                         ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\meg\Documents\cam\proj\It's On Sale\its-on-sale-tracker\.venv\Lib\site-packages\dbt\task\debug.py", line 207, in _load_profile
    profile_names, summary_message = self._choose_profile_names()
                                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\meg\Documents\cam\proj\It's On Sale\its-on-sale-tracker\.venv\Lib\site-packages\dbt\task\debug.py", line 282, in _choose_profile_names
    return profiles, summary_message
                     ^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'summary_message' where it is not associated with a value

[0m22:44:14.463942 [debug] [MainThread]: Command `dbt debug` failed at 22:44:14.462940 after 0.08 seconds
[0m22:44:14.463942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8C9DA1F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8C9D98D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8C9D98490>]}
[0m22:44:14.465217 [debug] [MainThread]: Flushing usage events
[0m22:44:23.887788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002364813BBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023646E54150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023647F2DFD0>]}


============================== 22:44:23.891913 | 4c8d2ec9-521d-4462-a09f-92e7dfc5807d ==============================
[0m22:44:23.891913 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:44:23.892917 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '..\\', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug --profiles-dir ..\\', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:44:23.915572 [info ] [MainThread]: dbt version: 1.8.7
[0m22:44:23.916747 [info ] [MainThread]: python version: 3.11.9
[0m22:44:23.916747 [info ] [MainThread]: python path: C:\Users\meg\Documents\cam\proj\It's On Sale\its-on-sale-tracker\.venv\Scripts\python.exe
[0m22:44:23.917752 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m22:44:23.918801 [error] [MainThread]: Encountered an error:
cannot access local variable 'summary_message' where it is not associated with a value
[0m22:44:23.922059 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\meg\Documents\cam\proj\It's On Sale\its-on-sale-tracker\.venv\Lib\site-packages\dbt\cli\requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\meg\Documents\cam\proj\It's On Sale\its-on-sale-tracker\.venv\Lib\site-packages\dbt\cli\requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\meg\Documents\cam\proj\It's On Sale\its-on-sale-tracker\.venv\Lib\site-packages\dbt\cli\main.py", line 406, in debug
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\meg\Documents\cam\proj\It's On Sale\its-on-sale-tracker\.venv\Lib\site-packages\dbt\task\debug.py", line 120, in run
    load_profile_status: SubtaskStatus = self._load_profile()
                                         ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\meg\Documents\cam\proj\It's On Sale\its-on-sale-tracker\.venv\Lib\site-packages\dbt\task\debug.py", line 207, in _load_profile
    profile_names, summary_message = self._choose_profile_names()
                                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\meg\Documents\cam\proj\It's On Sale\its-on-sale-tracker\.venv\Lib\site-packages\dbt\task\debug.py", line 282, in _choose_profile_names
    return profiles, summary_message
                     ^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'summary_message' where it is not associated with a value

[0m22:44:23.923125 [debug] [MainThread]: Command `dbt debug` failed at 22:44:23.923125 after 0.07 seconds
[0m22:44:23.924416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023648138B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002364813AD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023640930C50>]}
[0m22:44:23.925424 [debug] [MainThread]: Flushing usage events
[0m22:45:31.338114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ACDE0DD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ACE021D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ACE021FD0>]}


============================== 22:45:31.343152 | d78c7fbd-38c9-46ac-8d96-dc2735518624 ==============================
[0m22:45:31.343152 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:45:31.344264 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': "C:\\Users\\meg\\Documents\\cam\\proj\\It's On Sale\\its-on-sale-tracker\\pipeline\\transform", 'debug': 'False', 'version_check': 'True', 'log_path': 'logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m22:45:31.364427 [info ] [MainThread]: dbt version: 1.8.7
[0m22:45:31.365435 [info ] [MainThread]: python version: 3.11.9
[0m22:45:31.365435 [info ] [MainThread]: python path: C:\Users\meg\Documents\cam\proj\It's On Sale\its-on-sale-tracker\.venv\Scripts\python.exe
[0m22:45:31.366440 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m22:45:31.367444 [error] [MainThread]: Encountered an error:
cannot access local variable 'summary_message' where it is not associated with a value
[0m22:45:31.369547 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\meg\Documents\cam\proj\It's On Sale\its-on-sale-tracker\.venv\Lib\site-packages\dbt\cli\requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\meg\Documents\cam\proj\It's On Sale\its-on-sale-tracker\.venv\Lib\site-packages\dbt\cli\requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\meg\Documents\cam\proj\It's On Sale\its-on-sale-tracker\.venv\Lib\site-packages\dbt\cli\main.py", line 406, in debug
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\meg\Documents\cam\proj\It's On Sale\its-on-sale-tracker\.venv\Lib\site-packages\dbt\task\debug.py", line 120, in run
    load_profile_status: SubtaskStatus = self._load_profile()
                                         ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\meg\Documents\cam\proj\It's On Sale\its-on-sale-tracker\.venv\Lib\site-packages\dbt\task\debug.py", line 207, in _load_profile
    profile_names, summary_message = self._choose_profile_names()
                                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\meg\Documents\cam\proj\It's On Sale\its-on-sale-tracker\.venv\Lib\site-packages\dbt\task\debug.py", line 282, in _choose_profile_names
    return profiles, summary_message
                     ^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'summary_message' where it is not associated with a value

[0m22:45:31.371577 [debug] [MainThread]: Command `dbt debug` failed at 22:45:31.371577 after 0.07 seconds
[0m22:45:31.372580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ACE018D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ACE018150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AC6566D90>]}
[0m22:45:31.372580 [debug] [MainThread]: Flushing usage events
[0m22:46:11.091355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4E078B4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4E0788790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4E0788D90>]}


============================== 22:46:11.095062 | c8c806d7-49a9-4778-923d-4f4bbae17859 ==============================
[0m22:46:11.095062 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:46:11.097264 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '..\\', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug --profiles-dir ..\\', 'send_anonymous_usage_stats': 'True'}
[0m22:46:11.117052 [info ] [MainThread]: dbt version: 1.8.7
[0m22:46:11.118061 [info ] [MainThread]: python version: 3.11.9
[0m22:46:11.119379 [info ] [MainThread]: python path: C:\Users\meg\Documents\cam\proj\It's On Sale\its-on-sale-tracker\.venv\Scripts\python.exe
[0m22:46:11.119379 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m22:46:11.121416 [error] [MainThread]: Encountered an error:
cannot access local variable 'summary_message' where it is not associated with a value
[0m22:46:11.123428 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\meg\Documents\cam\proj\It's On Sale\its-on-sale-tracker\.venv\Lib\site-packages\dbt\cli\requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\meg\Documents\cam\proj\It's On Sale\its-on-sale-tracker\.venv\Lib\site-packages\dbt\cli\requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\meg\Documents\cam\proj\It's On Sale\its-on-sale-tracker\.venv\Lib\site-packages\dbt\cli\main.py", line 406, in debug
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\meg\Documents\cam\proj\It's On Sale\its-on-sale-tracker\.venv\Lib\site-packages\dbt\task\debug.py", line 120, in run
    load_profile_status: SubtaskStatus = self._load_profile()
                                         ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\meg\Documents\cam\proj\It's On Sale\its-on-sale-tracker\.venv\Lib\site-packages\dbt\task\debug.py", line 207, in _load_profile
    profile_names, summary_message = self._choose_profile_names()
                                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\meg\Documents\cam\proj\It's On Sale\its-on-sale-tracker\.venv\Lib\site-packages\dbt\task\debug.py", line 282, in _choose_profile_names
    return profiles, summary_message
                     ^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'summary_message' where it is not associated with a value

[0m22:46:11.125495 [debug] [MainThread]: Command `dbt debug` failed at 22:46:11.125495 after 0.06 seconds
[0m22:46:11.125495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4E079F810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4E079FB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4D8CF6F50>]}
[0m22:46:11.126499 [debug] [MainThread]: Flushing usage events
[0m22:47:59.453893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E54639090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E54640310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E54641C10>]}


============================== 22:47:59.458011 | 7b8eec47-a855-4282-89ea-673c96589fe7 ==============================
[0m22:47:59.458011 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:47:59.460025 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'logs', 'profiles_dir': '..\\', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug --profiles-dir ..\\', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:47:59.482539 [info ] [MainThread]: dbt version: 1.8.7
[0m22:47:59.483587 [info ] [MainThread]: python version: 3.11.9
[0m22:47:59.483587 [info ] [MainThread]: python path: C:\Users\meg\Documents\cam\proj\It's On Sale\its-on-sale-tracker\.venv\Scripts\python.exe
[0m22:47:59.484701 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m22:47:59.485709 [error] [MainThread]: Encountered an error:
cannot access local variable 'summary_message' where it is not associated with a value
[0m22:47:59.487830 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\meg\Documents\cam\proj\It's On Sale\its-on-sale-tracker\.venv\Lib\site-packages\dbt\cli\requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\meg\Documents\cam\proj\It's On Sale\its-on-sale-tracker\.venv\Lib\site-packages\dbt\cli\requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\meg\Documents\cam\proj\It's On Sale\its-on-sale-tracker\.venv\Lib\site-packages\dbt\cli\main.py", line 406, in debug
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\meg\Documents\cam\proj\It's On Sale\its-on-sale-tracker\.venv\Lib\site-packages\dbt\task\debug.py", line 120, in run
    load_profile_status: SubtaskStatus = self._load_profile()
                                         ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\meg\Documents\cam\proj\It's On Sale\its-on-sale-tracker\.venv\Lib\site-packages\dbt\task\debug.py", line 207, in _load_profile
    profile_names, summary_message = self._choose_profile_names()
                                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\meg\Documents\cam\proj\It's On Sale\its-on-sale-tracker\.venv\Lib\site-packages\dbt\task\debug.py", line 282, in _choose_profile_names
    return profiles, summary_message
                     ^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'summary_message' where it is not associated with a value

[0m22:47:59.489844 [debug] [MainThread]: Command `dbt debug` failed at 22:47:59.489844 after 0.07 seconds
[0m22:47:59.490851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E5464FB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E5464FE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E4CBA7050>]}
[0m22:47:59.490851 [debug] [MainThread]: Flushing usage events
[0m22:48:04.181886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002892D532990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002892D5328D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002892D532690>]}


============================== 22:48:04.185947 | 6abda680-4fc0-47db-ad31-127cb83a06e9 ==============================
[0m22:48:04.185947 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:48:04.186955 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '..\\', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir ..\\', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:48:04.187961 [error] [MainThread]: Encountered an error:
Runtime Error
  dbt_project.yml does not parse to a dictionary
[0m22:48:04.188966 [debug] [MainThread]: Command `dbt run` failed at 22:48:04.188966 after 0.04 seconds
[0m22:48:04.189973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002892D543D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002892D543AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002892D319FD0>]}
[0m22:48:04.190977 [debug] [MainThread]: Flushing usage events
[0m22:48:08.767687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D7AE32350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D7AB92450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D7AC1E2D0>]}


============================== 22:48:08.772127 | 45e7db90-192c-4b77-aec6-d9465f71ccb8 ==============================
[0m22:48:08.772127 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:48:08.772127 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'logs', 'profiles_dir': '..\\', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --profiles-dir ..\\', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:48:08.773429 [error] [MainThread]: Encountered an error:
Runtime Error
  dbt_project.yml does not parse to a dictionary
[0m22:48:08.775448 [debug] [MainThread]: Command `dbt test` failed at 22:48:08.775448 after 0.04 seconds
[0m22:48:08.775448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D7AE30910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D7AE31D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D7AE29990>]}
[0m22:48:08.776452 [debug] [MainThread]: Flushing usage events
[0m22:52:19.071416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AC8DB10E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AC8DB133D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AC8DB12C50>]}


============================== 22:52:19.076519 | 3e0fd75a-768f-4f0d-807d-51016f90e6b0 ==============================
[0m22:52:19.076519 [info ] [MainThread]: Running with dbt=1.8.8
[0m22:52:19.077522 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': "C:\\Users\\meg\\Documents\\cam\\proj\\It's On Sale\\its-on-sale-tracker\\pipeline\\transform\\its_on_sale\\logs", 'fail_fast': 'False', 'profiles_dir': '..\\', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug --profiles-dir ..\\', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:52:19.103817 [info ] [MainThread]: dbt version: 1.8.8
[0m22:52:19.103817 [info ] [MainThread]: python version: 3.11.9
[0m22:52:19.104821 [info ] [MainThread]: python path: C:\Users\meg\Documents\cam\proj\It's On Sale\its-on-sale-tracker\.venv\Scripts\python.exe
[0m22:52:19.105887 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m22:52:19.108908 [info ] [MainThread]: Using profiles dir at ..\
[0m22:52:19.109915 [info ] [MainThread]: Using profiles.yml file at ..\profiles.yml
[0m22:52:19.110922 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\meg\Documents\cam\proj\It's On Sale\its-on-sale-tracker\pipeline\transform\its_on_sale\dbt_project.yml
[0m22:52:19.212558 [info ] [MainThread]: Configuration:
[0m22:52:19.213571 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m22:52:19.214576 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:52:19.214576 [info ] [MainThread]: Required dependencies:
[0m22:52:19.215581 [debug] [MainThread]: Executing "git --help"
[0m22:52:19.262697 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:52:19.263701 [debug] [MainThread]: STDERR: "b''"
[0m22:52:19.264705 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:52:19.264705 [info ] [MainThread]: Connection test skipped since no profile was found
[0m22:52:19.265708 [info ] [MainThread]: [31m1 check failed:[0m
[0m22:52:19.266719 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  
  dbt encountered an error while trying to read your profiles.yml file.
  
  The profiles.yml file at ..\profiles.yml is empty
  


[0m22:52:19.267794 [debug] [MainThread]: Command `dbt debug` failed at 22:52:19.267794 after 0.23 seconds
[0m22:52:19.268803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AC86320D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AC8AA504D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AC8DB0FE50>]}
[0m22:52:19.268803 [debug] [MainThread]: Flushing usage events
[0m22:52:24.020458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC7E8A3010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC7E8A2E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC7E8A2F50>]}


============================== 22:52:24.025727 | 792271f0-3699-4cd0-b4b6-4b3d271920bb ==============================
[0m22:52:24.025727 [info ] [MainThread]: Running with dbt=1.8.8
[0m22:52:24.026735 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': "C:\\Users\\meg\\Documents\\cam\\proj\\It's On Sale\\its-on-sale-tracker\\pipeline\\transform\\its_on_sale\\logs", 'profiles_dir': '..\\', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir ..\\', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:52:24.029748 [error] [MainThread]: Encountered an error:
Runtime Error
  
  dbt encountered an error while trying to read your profiles.yml file.
  
  The profiles.yml file at ..\profiles.yml is empty
  
[0m22:52:24.030893 [debug] [MainThread]: Command `dbt run` failed at 22:52:24.030893 after 0.04 seconds
[0m22:52:24.031900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC7E8AB410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC77110E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC7E89FC50>]}
[0m22:52:24.032919 [debug] [MainThread]: Flushing usage events
[0m22:52:28.766528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F3082CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F3081610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F3083510>]}


============================== 22:52:28.771075 | dfd6f00d-8ae8-4fe7-b2da-e5972fca0bd3 ==============================
[0m22:52:28.771075 [info ] [MainThread]: Running with dbt=1.8.8
[0m22:52:28.772362 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '..\\', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': "C:\\Users\\meg\\Documents\\cam\\proj\\It's On Sale\\its-on-sale-tracker\\pipeline\\transform\\its_on_sale\\logs", 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --profiles-dir ..\\', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:52:28.775497 [error] [MainThread]: Encountered an error:
Runtime Error
  
  dbt encountered an error while trying to read your profiles.yml file.
  
  The profiles.yml file at ..\profiles.yml is empty
  
[0m22:52:28.777587 [debug] [MainThread]: Command `dbt test` failed at 22:52:28.777587 after 0.04 seconds
[0m22:52:28.777587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F3080210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F3083510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F307F210>]}
[0m22:52:28.778608 [debug] [MainThread]: Flushing usage events
[0m22:54:04.385064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A56AFE0290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A56AFDF5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A569CEB050>]}


============================== 22:54:04.389103 | d09488ae-8e1a-4822-9243-7c91e8a7027d ==============================
[0m22:54:04.389103 [info ] [MainThread]: Running with dbt=1.8.8
[0m22:54:04.390108 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\meg\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': "c:\\Users\\meg\\Documents\\cam\\proj\\It's On Sale\\its-on-sale-tracker\\pipeline\\transform\\its_on_sale\\logs", 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:54:04.566340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd09488ae-8e1a-4822-9243-7c91e8a7027d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A56BFF5990>]}
[0m22:54:04.600909 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m22:54:04.601917 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m22:54:04.604348 [debug] [MainThread]: Command `cli deps` succeeded at 22:54:04.604348 after 0.30 seconds
[0m22:54:04.605494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A56BFF7250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A56AFDF110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A563436810>]}
[0m22:54:04.606508 [debug] [MainThread]: Flushing usage events
[0m22:54:49.548847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024503381890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002450337F150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245043998D0>]}


============================== 22:54:49.552876 | e62351b8-fa8e-4f82-a82a-1f0e3528bbf3 ==============================
[0m22:54:49.552876 [info ] [MainThread]: Running with dbt=1.8.8
[0m22:54:49.553895 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '..\\', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': "C:\\Users\\meg\\Documents\\cam\\proj\\It's On Sale\\its-on-sale-tracker\\pipeline\\transform\\its_on_sale\\logs", 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt debug --profiles-dir ..\\', 'send_anonymous_usage_stats': 'True'}
[0m22:54:49.572175 [info ] [MainThread]: dbt version: 1.8.8
[0m22:54:49.572175 [info ] [MainThread]: python version: 3.11.9
[0m22:54:49.573184 [info ] [MainThread]: python path: C:\Users\meg\Documents\cam\proj\It's On Sale\its-on-sale-tracker\.venv\Scripts\python.exe
[0m22:54:49.574188 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m22:54:49.636440 [info ] [MainThread]: Using profiles dir at ..\
[0m22:54:49.637442 [info ] [MainThread]: Using profiles.yml file at ..\profiles.yml
[0m22:54:49.638454 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\meg\Documents\cam\proj\It's On Sale\its-on-sale-tracker\pipeline\transform\its_on_sale\dbt_project.yml
[0m22:54:49.728514 [info ] [MainThread]: Configuration:
[0m22:54:49.729517 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m22:54:49.729517 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:54:49.730521 [info ] [MainThread]: Required dependencies:
[0m22:54:49.731528 [debug] [MainThread]: Executing "git --help"
[0m22:54:49.775809 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:54:49.776816 [debug] [MainThread]: STDERR: "b''"
[0m22:54:49.777820 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:54:49.777820 [info ] [MainThread]: Connection test skipped since no profile was found
[0m22:54:49.778843 [info ] [MainThread]: [31m1 check failed:[0m
[0m22:54:49.778843 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "its_on_sale", target "dev" invalid: '5432' is not of type 'integer'


[0m22:54:49.780899 [debug] [MainThread]: Command `dbt debug` failed at 22:54:49.780899 after 0.32 seconds
[0m22:54:49.780899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002457BB90CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002457BB90D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245003E7890>]}
[0m22:54:49.781905 [debug] [MainThread]: Flushing usage events
[0m22:54:54.376955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9D1A52E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9D2A6BBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9D2A6B250>]}


============================== 22:54:54.381099 | 0a2890cc-9a77-4356-8f13-ad1c5aac4a60 ==============================
[0m22:54:54.381099 [info ] [MainThread]: Running with dbt=1.8.8
[0m22:54:54.382104 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '..\\', 'version_check': 'True', 'warn_error': 'None', 'log_path': "C:\\Users\\meg\\Documents\\cam\\proj\\It's On Sale\\its-on-sale-tracker\\pipeline\\transform\\its_on_sale\\logs", 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir ..\\', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:54:54.442908 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "its_on_sale", target "dev" invalid: '5432' is not of type 'integer'
[0m22:54:54.444934 [debug] [MainThread]: Command `dbt run` failed at 22:54:54.443927 after 0.14 seconds
[0m22:54:54.444934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9D2A706D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9C9FC6F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9D1A4FF10>]}
[0m22:54:54.445948 [debug] [MainThread]: Flushing usage events
[0m22:54:58.875636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEEF2F0090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEEE2DF750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEEE2E3890>]}


============================== 22:54:58.880666 | ebe045d9-b9f4-4f29-8b18-a8798519ef84 ==============================
[0m22:54:58.880666 [info ] [MainThread]: Running with dbt=1.8.8
[0m22:54:58.881671 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '..\\', 'fail_fast': 'False', 'debug': 'False', 'log_path': "C:\\Users\\meg\\Documents\\cam\\proj\\It's On Sale\\its-on-sale-tracker\\pipeline\\transform\\its_on_sale\\logs", 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir ..\\', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:54:58.938951 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "its_on_sale", target "dev" invalid: '5432' is not of type 'integer'
[0m22:54:58.941101 [debug] [MainThread]: Command `dbt test` failed at 22:54:58.941101 after 0.14 seconds
[0m22:54:58.942108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEEE2E3150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEEE2E0390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEE6AD0E10>]}
[0m22:54:58.943127 [debug] [MainThread]: Flushing usage events
[0m22:56:18.327882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213D5313C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213D530F410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213D5313D10>]}


============================== 22:56:18.333122 | eeacaccc-1f5d-4349-8b48-fe2c70c1efee ==============================
[0m22:56:18.333122 [info ] [MainThread]: Running with dbt=1.8.8
[0m22:56:18.334320 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '..\\', 'log_path': "C:\\Users\\meg\\Documents\\cam\\proj\\It's On Sale\\its-on-sale-tracker\\pipeline\\transform\\its_on_sale\\logs", 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug --profiles-dir ..\\', 'send_anonymous_usage_stats': 'True'}
[0m22:56:18.355030 [info ] [MainThread]: dbt version: 1.8.8
[0m22:56:18.356031 [info ] [MainThread]: python version: 3.11.9
[0m22:56:18.357030 [info ] [MainThread]: python path: C:\Users\meg\Documents\cam\proj\It's On Sale\its-on-sale-tracker\.venv\Scripts\python.exe
[0m22:56:18.358455 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m22:56:18.440299 [info ] [MainThread]: Using profiles dir at ..\
[0m22:56:18.441307 [info ] [MainThread]: Using profiles.yml file at ..\profiles.yml
[0m22:56:18.442324 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\meg\Documents\cam\proj\It's On Sale\its-on-sale-tracker\pipeline\transform\its_on_sale\dbt_project.yml
[0m22:56:18.444598 [info ] [MainThread]: adapter type: postgres
[0m22:56:18.445604 [info ] [MainThread]: adapter version: 1.8.2
[0m22:56:18.577978 [info ] [MainThread]: Configuration:
[0m22:56:18.579030 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:56:18.580037 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:56:18.581098 [info ] [MainThread]: Required dependencies:
[0m22:56:18.582209 [debug] [MainThread]: Executing "git --help"
[0m22:56:18.637889 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:56:18.638910 [debug] [MainThread]: STDERR: "b''"
[0m22:56:18.638910 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:56:18.639963 [info ] [MainThread]: Connection:
[0m22:56:18.640968 [info ] [MainThread]:   host: ep-broad-wind-abjb6cfi-pooler.eu-west-2.aws.neon.tech
[0m22:56:18.641976 [info ] [MainThread]:   port: 5432
[0m22:56:18.641976 [info ] [MainThread]:   user: neondb_owner
[0m22:56:18.643385 [info ] [MainThread]:   database: neondb
[0m22:56:18.643385 [info ] [MainThread]:   schema: public
[0m22:56:18.644485 [info ] [MainThread]:   connect_timeout: 10
[0m22:56:18.645491 [info ] [MainThread]:   role: None
[0m22:56:18.645491 [info ] [MainThread]:   search_path: None
[0m22:56:18.646569 [info ] [MainThread]:   keepalives_idle: 0
[0m22:56:18.647572 [info ] [MainThread]:   sslmode: require
[0m22:56:18.648705 [info ] [MainThread]:   sslcert: None
[0m22:56:18.649725 [info ] [MainThread]:   sslkey: None
[0m22:56:18.649725 [info ] [MainThread]:   sslrootcert: None
[0m22:56:18.650743 [info ] [MainThread]:   application_name: dbt
[0m22:56:18.651764 [info ] [MainThread]:   retries: 1
[0m22:56:18.652845 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:56:18.654003 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m22:56:21.884525 [debug] [MainThread]: Using postgres connection "debug"
[0m22:56:21.884525 [debug] [MainThread]: On debug: select 1 as id
[0m22:56:21.885533 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:56:22.289517 [debug] [MainThread]: SQL status: SELECT 1 in 0.404 seconds
[0m22:56:22.291533 [debug] [MainThread]: On debug: Close
[0m22:56:22.292589 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m22:56:22.292589 [info ] [MainThread]: [32mAll checks passed![0m
[0m22:56:22.294601 [debug] [MainThread]: Command `dbt debug` succeeded at 22:56:22.294601 after 4.05 seconds
[0m22:56:22.295614 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m22:56:22.296622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213D63201D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213CDB00D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213D6479C90>]}
[0m22:56:22.296622 [debug] [MainThread]: Flushing usage events
[0m22:56:26.866326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237226AF590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002372249CD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237226AF2D0>]}


============================== 22:56:26.870741 | d90f41af-5784-49cf-8c53-42498eb47eeb ==============================
[0m22:56:26.870741 [info ] [MainThread]: Running with dbt=1.8.8
[0m22:56:26.871744 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '..\\', 'version_check': 'True', 'debug': 'False', 'log_path': "C:\\Users\\meg\\Documents\\cam\\proj\\It's On Sale\\its-on-sale-tracker\\pipeline\\transform\\its_on_sale\\logs", 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir ..\\', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:56:27.097697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd90f41af-5784-49cf-8c53-42498eb47eeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002372381A050>]}
[0m22:56:27.149706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd90f41af-5784-49cf-8c53-42498eb47eeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002371F6FC750>]}
[0m22:56:27.151716 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:56:27.181215 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m22:56:27.182223 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:56:27.183226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd90f41af-5784-49cf-8c53-42498eb47eeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023721C75FD0>]}
[0m22:56:29.281381 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:56:29.282443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd90f41af-5784-49cf-8c53-42498eb47eeb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002371F6FEFD0>]}
[0m22:56:29.512661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd90f41af-5784-49cf-8c53-42498eb47eeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023723A2DF90>]}
[0m22:56:29.624061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd90f41af-5784-49cf-8c53-42498eb47eeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023723C8C850>]}
[0m22:56:29.625065 [info ] [MainThread]: Found 3 models, 14 data tests, 423 macros
[0m22:56:29.625065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd90f41af-5784-49cf-8c53-42498eb47eeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002372395C210>]}
[0m22:56:29.627073 [info ] [MainThread]: 
[0m22:56:29.628080 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:56:29.633105 [debug] [ThreadPool]: Acquiring new postgres connection 'list_neondb'
[0m22:56:29.755400 [debug] [ThreadPool]: Using postgres connection "list_neondb"
[0m22:56:29.756402 [debug] [ThreadPool]: On list_neondb: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "connection_name": "list_neondb"} */

    select distinct nspname from pg_namespace
  
[0m22:56:29.756402 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:56:29.887079 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.130 seconds
[0m22:56:29.888094 [debug] [ThreadPool]: On list_neondb: Close
[0m22:56:29.890125 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_neondb, now create_neondb_public_staging)
[0m22:56:29.890125 [debug] [ThreadPool]: Creating schema "database: "neondb"
schema: "public_staging"
"
[0m22:56:29.896238 [debug] [ThreadPool]: Using postgres connection "create_neondb_public_staging"
[0m22:56:29.896238 [debug] [ThreadPool]: On create_neondb_public_staging: BEGIN
[0m22:56:29.897242 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:56:29.981518 [debug] [ThreadPool]: SQL status: BEGIN in 0.085 seconds
[0m22:56:29.982524 [debug] [ThreadPool]: Using postgres connection "create_neondb_public_staging"
[0m22:56:29.983532 [debug] [ThreadPool]: On create_neondb_public_staging: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "connection_name": "create_neondb_public_staging"} */
create schema if not exists "public_staging"
[0m22:56:30.002712 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.019 seconds
[0m22:56:30.003803 [debug] [ThreadPool]: On create_neondb_public_staging: COMMIT
[0m22:56:30.004808 [debug] [ThreadPool]: Using postgres connection "create_neondb_public_staging"
[0m22:56:30.004808 [debug] [ThreadPool]: On create_neondb_public_staging: COMMIT
[0m22:56:30.012726 [debug] [ThreadPool]: SQL status: COMMIT in 0.007 seconds
[0m22:56:30.012726 [debug] [ThreadPool]: On create_neondb_public_staging: Close
[0m22:56:30.014797 [debug] [ThreadPool]: Acquiring new postgres connection 'list_neondb_public_staging'
[0m22:56:30.015801 [debug] [ThreadPool]: Acquiring new postgres connection 'list_neondb_public_marts'
[0m22:56:30.021907 [debug] [ThreadPool]: Using postgres connection "list_neondb_public_staging"
[0m22:56:30.024941 [debug] [ThreadPool]: Using postgres connection "list_neondb_public_marts"
[0m22:56:30.024941 [debug] [ThreadPool]: On list_neondb_public_staging: BEGIN
[0m22:56:30.025945 [debug] [ThreadPool]: On list_neondb_public_marts: BEGIN
[0m22:56:30.025945 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:56:30.026951 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:56:30.079501 [debug] [ThreadPool]: SQL status: BEGIN in 0.053 seconds
[0m22:56:30.080505 [debug] [ThreadPool]: Using postgres connection "list_neondb_public_marts"
[0m22:56:30.080505 [debug] [ThreadPool]: On list_neondb_public_marts: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "connection_name": "list_neondb_public_marts"} */
select
      'neondb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'neondb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'neondb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m22:56:30.085483 [debug] [ThreadPool]: SQL status: BEGIN in 0.059 seconds
[0m22:56:30.085483 [debug] [ThreadPool]: Using postgres connection "list_neondb_public_staging"
[0m22:56:30.086491 [debug] [ThreadPool]: On list_neondb_public_staging: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "connection_name": "list_neondb_public_staging"} */
select
      'neondb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'neondb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'neondb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m22:56:30.113370 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.026 seconds
[0m22:56:30.113370 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.032 seconds
[0m22:56:30.114555 [debug] [ThreadPool]: On list_neondb_public_staging: ROLLBACK
[0m22:56:30.115569 [debug] [ThreadPool]: On list_neondb_public_marts: ROLLBACK
[0m22:56:30.123188 [debug] [ThreadPool]: On list_neondb_public_marts: Close
[0m22:56:30.123188 [debug] [ThreadPool]: On list_neondb_public_staging: Close
[0m22:56:30.128258 [debug] [MainThread]: Using postgres connection "master"
[0m22:56:30.128258 [debug] [MainThread]: On master: BEGIN
[0m22:56:30.129280 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:56:30.210451 [debug] [MainThread]: SQL status: BEGIN in 0.081 seconds
[0m22:56:30.210839 [debug] [MainThread]: Using postgres connection "master"
[0m22:56:30.211839 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:56:30.235345 [debug] [MainThread]: SQL status: SELECT 0 in 0.023 seconds
[0m22:56:30.236351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd90f41af-5784-49cf-8c53-42498eb47eeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023723C84410>]}
[0m22:56:30.237413 [debug] [MainThread]: On master: ROLLBACK
[0m22:56:30.243322 [debug] [MainThread]: Using postgres connection "master"
[0m22:56:30.243322 [debug] [MainThread]: On master: BEGIN
[0m22:56:30.257170 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m22:56:30.257170 [debug] [MainThread]: On master: COMMIT
[0m22:56:30.258177 [debug] [MainThread]: Using postgres connection "master"
[0m22:56:30.258177 [debug] [MainThread]: On master: COMMIT
[0m22:56:30.264974 [debug] [MainThread]: SQL status: COMMIT in 0.006 seconds
[0m22:56:30.264974 [debug] [MainThread]: On master: Close
[0m22:56:30.266197 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:56:30.267220 [info ] [MainThread]: 
[0m22:56:30.291764 [debug] [Thread-1 (]: Began running node model.its_on_sale.stg_price_history
[0m22:56:30.292764 [debug] [Thread-2 (]: Began running node model.its_on_sale.stg_product
[0m22:56:30.293764 [info ] [Thread-1 (]: 1 of 2 START sql view model public_staging.stg_price_history ................... [RUN]
[0m22:56:30.294765 [info ] [Thread-2 (]: 2 of 2 START sql view model public_staging.stg_product ......................... [RUN]
[0m22:56:30.295766 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.its_on_sale.stg_price_history'
[0m22:56:30.296766 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.its_on_sale.stg_product'
[0m22:56:30.297766 [debug] [Thread-1 (]: Began compiling node model.its_on_sale.stg_price_history
[0m22:56:30.297766 [debug] [Thread-2 (]: Began compiling node model.its_on_sale.stg_product
[0m22:56:30.305300 [debug] [Thread-1 (]: Writing injected SQL for node "model.its_on_sale.stg_price_history"
[0m22:56:30.308312 [debug] [Thread-2 (]: Writing injected SQL for node "model.its_on_sale.stg_product"
[0m22:56:30.312395 [debug] [Thread-1 (]: Began executing node model.its_on_sale.stg_price_history
[0m22:56:30.312395 [debug] [Thread-2 (]: Began executing node model.its_on_sale.stg_product
[0m22:56:30.348797 [debug] [Thread-1 (]: Writing runtime sql for node "model.its_on_sale.stg_price_history"
[0m22:56:30.352820 [debug] [Thread-2 (]: Writing runtime sql for node "model.its_on_sale.stg_product"
[0m22:56:30.355844 [debug] [Thread-2 (]: Using postgres connection "model.its_on_sale.stg_product"
[0m22:56:30.357302 [debug] [Thread-1 (]: Using postgres connection "model.its_on_sale.stg_price_history"
[0m22:56:30.357302 [debug] [Thread-2 (]: On model.its_on_sale.stg_product: BEGIN
[0m22:56:30.358317 [debug] [Thread-1 (]: On model.its_on_sale.stg_price_history: BEGIN
[0m22:56:30.359329 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:56:30.359329 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:56:30.416150 [debug] [Thread-2 (]: SQL status: BEGIN in 0.057 seconds
[0m22:56:30.417151 [debug] [Thread-2 (]: Using postgres connection "model.its_on_sale.stg_product"
[0m22:56:30.417151 [debug] [Thread-2 (]: On model.its_on_sale.stg_product: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "node_id": "model.its_on_sale.stg_product"} */

  create view "neondb"."public_staging"."stg_product__dbt_tmp"
    
    
  as (
    -- Basic staging view over product

select
  product_id,
  site,
  url,
  name,
  created_at
from public.product
  );
[0m22:56:30.421214 [debug] [Thread-1 (]: SQL status: BEGIN in 0.062 seconds
[0m22:56:30.422223 [debug] [Thread-1 (]: Using postgres connection "model.its_on_sale.stg_price_history"
[0m22:56:30.423282 [debug] [Thread-1 (]: On model.its_on_sale.stg_price_history: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "node_id": "model.its_on_sale.stg_price_history"} */

  create view "neondb"."public_staging"."stg_price_history__dbt_tmp"
    
    
  as (
    -- Basic staging view over price_history

select
  id,
  product_id,
  ts_utc,
  cast(price_numeric as numeric(12,2)) as price,
  currency,
  in_stock_bool as in_stock,
  on_sale_bool as on_sale,
  source_hash
from public.price_history
  );
[0m22:56:30.456385 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.038 seconds
[0m22:56:30.456385 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.033 seconds
[0m22:56:30.463516 [debug] [Thread-2 (]: Using postgres connection "model.its_on_sale.stg_product"
[0m22:56:30.467534 [debug] [Thread-1 (]: Using postgres connection "model.its_on_sale.stg_price_history"
[0m22:56:30.468538 [debug] [Thread-2 (]: On model.its_on_sale.stg_product: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "node_id": "model.its_on_sale.stg_product"} */
alter table "neondb"."public_staging"."stg_product__dbt_tmp" rename to "stg_product"
[0m22:56:30.468538 [debug] [Thread-1 (]: On model.its_on_sale.stg_price_history: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "node_id": "model.its_on_sale.stg_price_history"} */
alter table "neondb"."public_staging"."stg_price_history__dbt_tmp" rename to "stg_price_history"
[0m22:56:30.475789 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m22:56:30.476794 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m22:56:30.491950 [debug] [Thread-2 (]: On model.its_on_sale.stg_product: COMMIT
[0m22:56:30.493960 [debug] [Thread-1 (]: On model.its_on_sale.stg_price_history: COMMIT
[0m22:56:30.493960 [debug] [Thread-2 (]: Using postgres connection "model.its_on_sale.stg_product"
[0m22:56:30.494964 [debug] [Thread-1 (]: Using postgres connection "model.its_on_sale.stg_price_history"
[0m22:56:30.495967 [debug] [Thread-2 (]: On model.its_on_sale.stg_product: COMMIT
[0m22:56:30.495967 [debug] [Thread-1 (]: On model.its_on_sale.stg_price_history: COMMIT
[0m22:56:30.504892 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m22:56:30.504892 [debug] [Thread-2 (]: SQL status: COMMIT in 0.008 seconds
[0m22:56:30.511923 [debug] [Thread-1 (]: Applying DROP to: "neondb"."public_staging"."stg_price_history__dbt_backup"
[0m22:56:30.514940 [debug] [Thread-2 (]: Applying DROP to: "neondb"."public_staging"."stg_product__dbt_backup"
[0m22:56:30.521030 [debug] [Thread-1 (]: Using postgres connection "model.its_on_sale.stg_price_history"
[0m22:56:30.522036 [debug] [Thread-2 (]: Using postgres connection "model.its_on_sale.stg_product"
[0m22:56:30.522036 [debug] [Thread-1 (]: On model.its_on_sale.stg_price_history: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "node_id": "model.its_on_sale.stg_price_history"} */
drop view if exists "neondb"."public_staging"."stg_price_history__dbt_backup" cascade
[0m22:56:30.523040 [debug] [Thread-2 (]: On model.its_on_sale.stg_product: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "node_id": "model.its_on_sale.stg_product"} */
drop view if exists "neondb"."public_staging"."stg_product__dbt_backup" cascade
[0m22:56:30.530520 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.006 seconds
[0m22:56:30.530520 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.007 seconds
[0m22:56:30.533626 [debug] [Thread-2 (]: On model.its_on_sale.stg_product: Close
[0m22:56:30.534630 [debug] [Thread-1 (]: On model.its_on_sale.stg_price_history: Close
[0m22:56:30.536642 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd90f41af-5784-49cf-8c53-42498eb47eeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002372402FD50>]}
[0m22:56:30.537645 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd90f41af-5784-49cf-8c53-42498eb47eeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023723FC2950>]}
[0m22:56:30.538655 [info ] [Thread-2 (]: 2 of 2 OK created sql view model public_staging.stg_product .................... [[32mCREATE VIEW[0m in 0.24s]
[0m22:56:30.539660 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public_staging.stg_price_history .............. [[32mCREATE VIEW[0m in 0.24s]
[0m22:56:30.540665 [debug] [Thread-2 (]: Finished running node model.its_on_sale.stg_product
[0m22:56:30.541672 [debug] [Thread-1 (]: Finished running node model.its_on_sale.stg_price_history
[0m22:56:30.542833 [debug] [MainThread]: Using postgres connection "master"
[0m22:56:30.543837 [debug] [MainThread]: On master: BEGIN
[0m22:56:30.544845 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:56:30.601738 [debug] [MainThread]: SQL status: BEGIN in 0.057 seconds
[0m22:56:30.601738 [debug] [MainThread]: On master: COMMIT
[0m22:56:30.602740 [debug] [MainThread]: Using postgres connection "master"
[0m22:56:30.602740 [debug] [MainThread]: On master: COMMIT
[0m22:56:30.609696 [debug] [MainThread]: SQL status: COMMIT in 0.006 seconds
[0m22:56:30.610700 [debug] [MainThread]: On master: Close
[0m22:56:30.611703 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:56:30.611703 [debug] [MainThread]: Connection 'create_neondb_public_staging' was properly closed.
[0m22:56:30.613153 [debug] [MainThread]: Connection 'list_neondb_public_staging' was properly closed.
[0m22:56:30.613153 [debug] [MainThread]: Connection 'list_neondb_public_marts' was properly closed.
[0m22:56:30.614159 [debug] [MainThread]: Connection 'model.its_on_sale.stg_price_history' was properly closed.
[0m22:56:30.614159 [debug] [MainThread]: Connection 'model.its_on_sale.stg_product' was properly closed.
[0m22:56:30.615171 [info ] [MainThread]: 
[0m22:56:30.615171 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.99 seconds (0.99s).
[0m22:56:30.617180 [debug] [MainThread]: Command end result
[0m22:56:30.653919 [info ] [MainThread]: 
[0m22:56:30.655371 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:56:30.656602 [info ] [MainThread]: 
[0m22:56:30.656602 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:56:30.658622 [debug] [MainThread]: Command `dbt run` succeeded at 22:56:30.658622 after 3.87 seconds
[0m22:56:30.659646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237236D7A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237212C0650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237226ABE50>]}
[0m22:56:30.660654 [debug] [MainThread]: Flushing usage events
[0m22:56:35.064062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A7781B390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A765ED090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A767FF350>]}


============================== 22:56:35.069206 | b68d9377-8bde-4a41-8f6c-8a40dbdbde23 ==============================
[0m22:56:35.069206 [info ] [MainThread]: Running with dbt=1.8.8
[0m22:56:35.070209 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': "C:\\Users\\meg\\Documents\\cam\\proj\\It's On Sale\\its-on-sale-tracker\\pipeline\\transform\\its_on_sale\\logs", 'fail_fast': 'False', 'profiles_dir': '..\\', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir ..\\', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:56:35.292722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b68d9377-8bde-4a41-8f6c-8a40dbdbde23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A7796E5D0>]}
[0m22:56:35.345272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b68d9377-8bde-4a41-8f6c-8a40dbdbde23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A75DC6010>]}
[0m22:56:35.347280 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:56:35.356356 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m22:56:35.540050 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:56:35.541130 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:56:35.579457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b68d9377-8bde-4a41-8f6c-8a40dbdbde23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A77B01F10>]}
[0m22:56:35.697938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b68d9377-8bde-4a41-8f6c-8a40dbdbde23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A77D73ED0>]}
[0m22:56:35.698942 [info ] [MainThread]: Found 3 models, 14 data tests, 423 macros
[0m22:56:35.698942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b68d9377-8bde-4a41-8f6c-8a40dbdbde23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A77A0FF50>]}
[0m22:56:35.701961 [info ] [MainThread]: 
[0m22:56:35.702965 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:56:35.707987 [debug] [ThreadPool]: Acquiring new postgres connection 'list_neondb_public_staging'
[0m22:56:35.707987 [debug] [ThreadPool]: Acquiring new postgres connection 'list_neondb_public_marts'
[0m22:56:35.921394 [debug] [ThreadPool]: Using postgres connection "list_neondb_public_staging"
[0m22:56:35.922508 [debug] [ThreadPool]: Using postgres connection "list_neondb_public_marts"
[0m22:56:35.922508 [debug] [ThreadPool]: On list_neondb_public_staging: BEGIN
[0m22:56:35.923512 [debug] [ThreadPool]: On list_neondb_public_marts: BEGIN
[0m22:56:35.923512 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:56:35.924515 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:56:36.004848 [debug] [ThreadPool]: SQL status: BEGIN in 0.081 seconds
[0m22:56:36.004848 [debug] [ThreadPool]: Using postgres connection "list_neondb_public_staging"
[0m22:56:36.006054 [debug] [ThreadPool]: On list_neondb_public_staging: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "connection_name": "list_neondb_public_staging"} */
select
      'neondb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'neondb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'neondb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m22:56:36.008064 [debug] [ThreadPool]: SQL status: BEGIN in 0.084 seconds
[0m22:56:36.009089 [debug] [ThreadPool]: Using postgres connection "list_neondb_public_marts"
[0m22:56:36.009089 [debug] [ThreadPool]: On list_neondb_public_marts: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "connection_name": "list_neondb_public_marts"} */
select
      'neondb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'neondb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'neondb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m22:56:36.014121 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.007 seconds
[0m22:56:36.015125 [debug] [ThreadPool]: On list_neondb_public_staging: ROLLBACK
[0m22:56:36.017136 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m22:56:36.018200 [debug] [ThreadPool]: On list_neondb_public_marts: ROLLBACK
[0m22:56:36.022221 [debug] [ThreadPool]: On list_neondb_public_staging: Close
[0m22:56:36.024250 [debug] [ThreadPool]: On list_neondb_public_marts: Close
[0m22:56:36.029274 [debug] [MainThread]: Using postgres connection "master"
[0m22:56:36.030278 [debug] [MainThread]: On master: BEGIN
[0m22:56:36.030278 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:56:36.089122 [debug] [MainThread]: SQL status: BEGIN in 0.059 seconds
[0m22:56:36.090129 [debug] [MainThread]: Using postgres connection "master"
[0m22:56:36.090129 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:56:36.102267 [debug] [MainThread]: SQL status: SELECT 2 in 0.011 seconds
[0m22:56:36.104273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b68d9377-8bde-4a41-8f6c-8a40dbdbde23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A77B370D0>]}
[0m22:56:36.105276 [debug] [MainThread]: On master: ROLLBACK
[0m22:56:36.110388 [debug] [MainThread]: Using postgres connection "master"
[0m22:56:36.111395 [debug] [MainThread]: On master: BEGIN
[0m22:56:36.123465 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m22:56:36.123465 [debug] [MainThread]: On master: COMMIT
[0m22:56:36.124535 [debug] [MainThread]: Using postgres connection "master"
[0m22:56:36.124535 [debug] [MainThread]: On master: COMMIT
[0m22:56:36.130578 [debug] [MainThread]: SQL status: COMMIT in 0.006 seconds
[0m22:56:36.131584 [debug] [MainThread]: On master: Close
[0m22:56:36.132588 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:56:36.132588 [info ] [MainThread]: 
[0m22:56:36.136609 [debug] [Thread-1 (]: Began running node test.its_on_sale.not_null_fact_price_history_id.110f7c1113
[0m22:56:36.137613 [debug] [Thread-2 (]: Began running node test.its_on_sale.not_null_fact_price_history_ts_utc.78d3e6c462
[0m22:56:36.137613 [debug] [Thread-3 (]: Began running node test.its_on_sale.not_null_stg_price_history_id.cb86572049
[0m22:56:36.138616 [debug] [Thread-4 (]: Began running node test.its_on_sale.not_null_stg_price_history_product_id.082361509e
[0m22:56:36.139710 [info ] [Thread-1 (]: 1 of 14 START test not_null_fact_price_history_id .............................. [RUN]
[0m22:56:36.139710 [info ] [Thread-2 (]: 2 of 14 START test not_null_fact_price_history_ts_utc .......................... [RUN]
[0m22:56:36.140782 [info ] [Thread-3 (]: 3 of 14 START test not_null_stg_price_history_id ............................... [RUN]
[0m22:56:36.141789 [info ] [Thread-4 (]: 4 of 14 START test not_null_stg_price_history_product_id ....................... [RUN]
[0m22:56:36.141789 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.its_on_sale.not_null_fact_price_history_id.110f7c1113'
[0m22:56:36.143123 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.its_on_sale.not_null_fact_price_history_ts_utc.78d3e6c462'
[0m22:56:36.144144 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.its_on_sale.not_null_stg_price_history_id.cb86572049'
[0m22:56:36.145147 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.its_on_sale.not_null_stg_price_history_product_id.082361509e'
[0m22:56:36.145147 [debug] [Thread-1 (]: Began compiling node test.its_on_sale.not_null_fact_price_history_id.110f7c1113
[0m22:56:36.146487 [debug] [Thread-2 (]: Began compiling node test.its_on_sale.not_null_fact_price_history_ts_utc.78d3e6c462
[0m22:56:36.146487 [debug] [Thread-3 (]: Began compiling node test.its_on_sale.not_null_stg_price_history_id.cb86572049
[0m22:56:36.147490 [debug] [Thread-4 (]: Began compiling node test.its_on_sale.not_null_stg_price_history_product_id.082361509e
[0m22:56:36.165783 [debug] [Thread-1 (]: Writing injected SQL for node "test.its_on_sale.not_null_fact_price_history_id.110f7c1113"
[0m22:56:36.169796 [debug] [Thread-2 (]: Writing injected SQL for node "test.its_on_sale.not_null_fact_price_history_ts_utc.78d3e6c462"
[0m22:56:36.176065 [debug] [Thread-3 (]: Writing injected SQL for node "test.its_on_sale.not_null_stg_price_history_id.cb86572049"
[0m22:56:36.181113 [debug] [Thread-4 (]: Writing injected SQL for node "test.its_on_sale.not_null_stg_price_history_product_id.082361509e"
[0m22:56:36.184171 [debug] [Thread-1 (]: Began executing node test.its_on_sale.not_null_fact_price_history_id.110f7c1113
[0m22:56:36.185181 [debug] [Thread-2 (]: Began executing node test.its_on_sale.not_null_fact_price_history_ts_utc.78d3e6c462
[0m22:56:36.186507 [debug] [Thread-3 (]: Began executing node test.its_on_sale.not_null_stg_price_history_id.cb86572049
[0m22:56:36.186507 [debug] [Thread-4 (]: Began executing node test.its_on_sale.not_null_stg_price_history_product_id.082361509e
[0m22:56:36.204642 [debug] [Thread-1 (]: Writing runtime sql for node "test.its_on_sale.not_null_fact_price_history_id.110f7c1113"
[0m22:56:36.207657 [debug] [Thread-2 (]: Writing runtime sql for node "test.its_on_sale.not_null_fact_price_history_ts_utc.78d3e6c462"
[0m22:56:36.210664 [debug] [Thread-3 (]: Writing runtime sql for node "test.its_on_sale.not_null_stg_price_history_id.cb86572049"
[0m22:56:36.213940 [debug] [Thread-4 (]: Writing runtime sql for node "test.its_on_sale.not_null_stg_price_history_product_id.082361509e"
[0m22:56:36.217180 [debug] [Thread-2 (]: Using postgres connection "test.its_on_sale.not_null_fact_price_history_ts_utc.78d3e6c462"
[0m22:56:36.217180 [debug] [Thread-3 (]: Using postgres connection "test.its_on_sale.not_null_stg_price_history_id.cb86572049"
[0m22:56:36.218417 [debug] [Thread-4 (]: Using postgres connection "test.its_on_sale.not_null_stg_price_history_product_id.082361509e"
[0m22:56:36.218417 [debug] [Thread-1 (]: Using postgres connection "test.its_on_sale.not_null_fact_price_history_id.110f7c1113"
[0m22:56:36.219475 [debug] [Thread-2 (]: On test.its_on_sale.not_null_fact_price_history_ts_utc.78d3e6c462: BEGIN
[0m22:56:36.220483 [debug] [Thread-3 (]: On test.its_on_sale.not_null_stg_price_history_id.cb86572049: BEGIN
[0m22:56:36.220483 [debug] [Thread-4 (]: On test.its_on_sale.not_null_stg_price_history_product_id.082361509e: BEGIN
[0m22:56:36.221538 [debug] [Thread-1 (]: On test.its_on_sale.not_null_fact_price_history_id.110f7c1113: BEGIN
[0m22:56:36.222568 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:56:36.222568 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:56:36.223572 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:56:36.223572 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:56:36.280105 [debug] [Thread-4 (]: SQL status: BEGIN in 0.056 seconds
[0m22:56:36.281116 [debug] [Thread-4 (]: Using postgres connection "test.its_on_sale.not_null_stg_price_history_product_id.082361509e"
[0m22:56:36.281116 [debug] [Thread-4 (]: On test.its_on_sale.not_null_stg_price_history_product_id.082361509e: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "node_id": "test.its_on_sale.not_null_stg_price_history_product_id.082361509e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from "neondb"."public_staging"."stg_price_history"
where product_id is null



      
    ) dbt_internal_test
[0m22:56:36.293511 [debug] [Thread-1 (]: SQL status: BEGIN in 0.069 seconds
[0m22:56:36.294521 [debug] [Thread-1 (]: Using postgres connection "test.its_on_sale.not_null_fact_price_history_id.110f7c1113"
[0m22:56:36.294521 [debug] [Thread-1 (]: On test.its_on_sale.not_null_fact_price_history_id.110f7c1113: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "node_id": "test.its_on_sale.not_null_fact_price_history_id.110f7c1113"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "neondb"."public_marts"."fact_price_history"
where id is null



      
    ) dbt_internal_test
[0m22:56:36.299088 [debug] [Thread-2 (]: SQL status: BEGIN in 0.077 seconds
[0m22:56:36.300092 [debug] [Thread-3 (]: SQL status: BEGIN in 0.077 seconds
[0m22:56:36.300092 [debug] [Thread-2 (]: Using postgres connection "test.its_on_sale.not_null_fact_price_history_ts_utc.78d3e6c462"
[0m22:56:36.301099 [debug] [Thread-3 (]: Using postgres connection "test.its_on_sale.not_null_stg_price_history_id.cb86572049"
[0m22:56:36.301099 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.019 seconds
[0m22:56:36.302111 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public_marts.fact_price_history" does not exist
LINE 14: from "neondb"."public_marts"."fact_price_history"
              ^

[0m22:56:36.303284 [debug] [Thread-2 (]: On test.its_on_sale.not_null_fact_price_history_ts_utc.78d3e6c462: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "node_id": "test.its_on_sale.not_null_fact_price_history_ts_utc.78d3e6c462"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ts_utc
from "neondb"."public_marts"."fact_price_history"
where ts_utc is null



      
    ) dbt_internal_test
[0m22:56:36.304289 [debug] [Thread-3 (]: On test.its_on_sale.not_null_stg_price_history_id.cb86572049: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "node_id": "test.its_on_sale.not_null_stg_price_history_id.cb86572049"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "neondb"."public_staging"."stg_price_history"
where id is null



      
    ) dbt_internal_test
[0m22:56:36.308321 [debug] [Thread-4 (]: On test.its_on_sale.not_null_stg_price_history_product_id.082361509e: ROLLBACK
[0m22:56:36.309355 [debug] [Thread-1 (]: On test.its_on_sale.not_null_fact_price_history_id.110f7c1113: ROLLBACK
[0m22:56:36.316501 [debug] [Thread-4 (]: On test.its_on_sale.not_null_stg_price_history_product_id.082361509e: Close
[0m22:56:36.316501 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.007 seconds
[0m22:56:36.317506 [debug] [Thread-1 (]: On test.its_on_sale.not_null_fact_price_history_id.110f7c1113: Close
[0m22:56:36.317506 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "public_marts.fact_price_history" does not exist
LINE 14: from "neondb"."public_marts"."fact_price_history"
              ^

[0m22:56:36.319531 [debug] [Thread-3 (]: On test.its_on_sale.not_null_stg_price_history_id.cb86572049: ROLLBACK
[0m22:56:36.320536 [info ] [Thread-4 (]: 4 of 14 PASS not_null_stg_price_history_product_id ............................. [[32mPASS[0m in 0.18s]
[0m22:56:36.321596 [debug] [Thread-2 (]: On test.its_on_sale.not_null_fact_price_history_ts_utc.78d3e6c462: ROLLBACK
[0m22:56:36.323609 [debug] [Thread-4 (]: Finished running node test.its_on_sale.not_null_stg_price_history_product_id.082361509e
[0m22:56:36.325763 [debug] [Thread-4 (]: Began running node test.its_on_sale.not_null_stg_price_history_ts_utc.a6f1e7003a
[0m22:56:36.327147 [info ] [Thread-4 (]: 5 of 14 START test not_null_stg_price_history_ts_utc ........................... [RUN]
[0m22:56:36.328148 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.its_on_sale.not_null_stg_price_history_product_id.082361509e, now test.its_on_sale.not_null_stg_price_history_ts_utc.a6f1e7003a)
[0m22:56:36.329550 [debug] [Thread-3 (]: On test.its_on_sale.not_null_stg_price_history_id.cb86572049: Close
[0m22:56:36.330619 [debug] [Thread-4 (]: Began compiling node test.its_on_sale.not_null_stg_price_history_ts_utc.a6f1e7003a
[0m22:56:36.331636 [debug] [Thread-2 (]: On test.its_on_sale.not_null_fact_price_history_ts_utc.78d3e6c462: Close
[0m22:56:36.337717 [debug] [Thread-4 (]: Writing injected SQL for node "test.its_on_sale.not_null_stg_price_history_ts_utc.a6f1e7003a"
[0m22:56:36.332654 [info ] [Thread-3 (]: 3 of 14 PASS not_null_stg_price_history_id ..................................... [[32mPASS[0m in 0.19s]
[0m22:56:36.340715 [debug] [Thread-3 (]: Finished running node test.its_on_sale.not_null_stg_price_history_id.cb86572049
[0m22:56:36.341716 [debug] [Thread-3 (]: Began running node test.its_on_sale.not_null_stg_product_product_id.5e35fa3f95
[0m22:56:36.342716 [debug] [Thread-4 (]: Began executing node test.its_on_sale.not_null_stg_price_history_ts_utc.a6f1e7003a
[0m22:56:36.342716 [info ] [Thread-3 (]: 6 of 14 START test not_null_stg_product_product_id ............................. [RUN]
[0m22:56:36.345855 [debug] [Thread-4 (]: Writing runtime sql for node "test.its_on_sale.not_null_stg_price_history_ts_utc.a6f1e7003a"
[0m22:56:36.347867 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.its_on_sale.not_null_stg_price_history_id.cb86572049, now test.its_on_sale.not_null_stg_product_product_id.5e35fa3f95)
[0m22:56:36.348873 [debug] [Thread-3 (]: Began compiling node test.its_on_sale.not_null_stg_product_product_id.5e35fa3f95
[0m22:56:36.354290 [debug] [Thread-3 (]: Writing injected SQL for node "test.its_on_sale.not_null_stg_product_product_id.5e35fa3f95"
[0m22:56:36.354290 [debug] [Thread-4 (]: Using postgres connection "test.its_on_sale.not_null_stg_price_history_ts_utc.a6f1e7003a"
[0m22:56:36.355386 [debug] [Thread-4 (]: On test.its_on_sale.not_null_stg_price_history_ts_utc.a6f1e7003a: BEGIN
[0m22:56:36.355386 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:56:36.356701 [debug] [Thread-3 (]: Began executing node test.its_on_sale.not_null_stg_product_product_id.5e35fa3f95
[0m22:56:36.360789 [debug] [Thread-3 (]: Writing runtime sql for node "test.its_on_sale.not_null_stg_product_product_id.5e35fa3f95"
[0m22:56:36.362817 [debug] [Thread-3 (]: Using postgres connection "test.its_on_sale.not_null_stg_product_product_id.5e35fa3f95"
[0m22:56:36.362817 [debug] [Thread-3 (]: On test.its_on_sale.not_null_stg_product_product_id.5e35fa3f95: BEGIN
[0m22:56:36.364927 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:56:36.400561 [debug] [Thread-2 (]: Database Error in test not_null_fact_price_history_ts_utc (models\marts\marts.yml)
  relation "public_marts.fact_price_history" does not exist
  LINE 14: from "neondb"."public_marts"."fact_price_history"
                ^
  compiled code at target\run\its_on_sale\models\marts\marts.yml\not_null_fact_price_history_ts_utc.sql
[0m22:56:36.401574 [debug] [Thread-1 (]: Database Error in test not_null_fact_price_history_id (models\marts\marts.yml)
  relation "public_marts.fact_price_history" does not exist
  LINE 14: from "neondb"."public_marts"."fact_price_history"
                ^
  compiled code at target\run\its_on_sale\models\marts\marts.yml\not_null_fact_price_history_id.sql
[0m22:56:36.402586 [error] [Thread-2 (]: 2 of 14 ERROR not_null_fact_price_history_ts_utc ............................... [[31mERROR[0m in 0.26s]
[0m22:56:36.403662 [error] [Thread-1 (]: 1 of 14 ERROR not_null_fact_price_history_id ................................... [[31mERROR[0m in 0.26s]
[0m22:56:36.403662 [debug] [Thread-2 (]: Finished running node test.its_on_sale.not_null_fact_price_history_ts_utc.78d3e6c462
[0m22:56:36.404671 [debug] [Thread-1 (]: Finished running node test.its_on_sale.not_null_fact_price_history_id.110f7c1113
[0m22:56:36.405677 [debug] [Thread-2 (]: Began running node test.its_on_sale.not_null_stg_product_site.712843232d
[0m22:56:36.407701 [debug] [Thread-1 (]: Began running node test.its_on_sale.not_null_stg_product_url.2f8ccdc1e9
[0m22:56:36.408706 [info ] [Thread-2 (]: 7 of 14 START test not_null_stg_product_site ................................... [RUN]
[0m22:56:36.409711 [info ] [Thread-1 (]: 8 of 14 START test not_null_stg_product_url .................................... [RUN]
[0m22:56:36.409711 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.its_on_sale.not_null_fact_price_history_ts_utc.78d3e6c462, now test.its_on_sale.not_null_stg_product_site.712843232d)
[0m22:56:36.410718 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.its_on_sale.not_null_fact_price_history_id.110f7c1113, now test.its_on_sale.not_null_stg_product_url.2f8ccdc1e9)
[0m22:56:36.411729 [debug] [Thread-2 (]: Began compiling node test.its_on_sale.not_null_stg_product_site.712843232d
[0m22:56:36.411729 [debug] [Thread-1 (]: Began compiling node test.its_on_sale.not_null_stg_product_url.2f8ccdc1e9
[0m22:56:36.417824 [debug] [Thread-4 (]: SQL status: BEGIN in 0.061 seconds
[0m22:56:36.417824 [debug] [Thread-2 (]: Writing injected SQL for node "test.its_on_sale.not_null_stg_product_site.712843232d"
[0m22:56:36.425006 [debug] [Thread-1 (]: Writing injected SQL for node "test.its_on_sale.not_null_stg_product_url.2f8ccdc1e9"
[0m22:56:36.426014 [debug] [Thread-4 (]: Using postgres connection "test.its_on_sale.not_null_stg_price_history_ts_utc.a6f1e7003a"
[0m22:56:36.428041 [debug] [Thread-4 (]: On test.its_on_sale.not_null_stg_price_history_ts_utc.a6f1e7003a: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "node_id": "test.its_on_sale.not_null_stg_price_history_ts_utc.a6f1e7003a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ts_utc
from "neondb"."public_staging"."stg_price_history"
where ts_utc is null



      
    ) dbt_internal_test
[0m22:56:36.429103 [debug] [Thread-2 (]: Began executing node test.its_on_sale.not_null_stg_product_site.712843232d
[0m22:56:36.430110 [debug] [Thread-1 (]: Began executing node test.its_on_sale.not_null_stg_product_url.2f8ccdc1e9
[0m22:56:36.432126 [debug] [Thread-2 (]: Writing runtime sql for node "test.its_on_sale.not_null_stg_product_site.712843232d"
[0m22:56:36.435334 [debug] [Thread-1 (]: Writing runtime sql for node "test.its_on_sale.not_null_stg_product_url.2f8ccdc1e9"
[0m22:56:36.436603 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.007 seconds
[0m22:56:36.438615 [debug] [Thread-4 (]: On test.its_on_sale.not_null_stg_price_history_ts_utc.a6f1e7003a: ROLLBACK
[0m22:56:36.439672 [debug] [Thread-2 (]: Using postgres connection "test.its_on_sale.not_null_stg_product_site.712843232d"
[0m22:56:36.440686 [debug] [Thread-1 (]: Using postgres connection "test.its_on_sale.not_null_stg_product_url.2f8ccdc1e9"
[0m22:56:36.441767 [debug] [Thread-3 (]: SQL status: BEGIN in 0.077 seconds
[0m22:56:36.441767 [debug] [Thread-2 (]: On test.its_on_sale.not_null_stg_product_site.712843232d: BEGIN
[0m22:56:36.442768 [debug] [Thread-1 (]: On test.its_on_sale.not_null_stg_product_url.2f8ccdc1e9: BEGIN
[0m22:56:36.442768 [debug] [Thread-3 (]: Using postgres connection "test.its_on_sale.not_null_stg_product_product_id.5e35fa3f95"
[0m22:56:36.443765 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:56:36.445092 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:56:36.445092 [debug] [Thread-3 (]: On test.its_on_sale.not_null_stg_product_product_id.5e35fa3f95: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "node_id": "test.its_on_sale.not_null_stg_product_product_id.5e35fa3f95"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from "neondb"."public_staging"."stg_product"
where product_id is null



      
    ) dbt_internal_test
[0m22:56:36.447102 [debug] [Thread-4 (]: On test.its_on_sale.not_null_stg_price_history_ts_utc.a6f1e7003a: Close
[0m22:56:36.448120 [info ] [Thread-4 (]: 5 of 14 PASS not_null_stg_price_history_ts_utc ................................. [[32mPASS[0m in 0.12s]
[0m22:56:36.450437 [debug] [Thread-4 (]: Finished running node test.its_on_sale.not_null_stg_price_history_ts_utc.a6f1e7003a
[0m22:56:36.450437 [debug] [Thread-4 (]: Began running node test.its_on_sale.relationships_fact_price_history_product_id__product_id__ref_stg_product_.42bbec0ccf
[0m22:56:36.451442 [info ] [Thread-4 (]: 9 of 14 START test relationships_fact_price_history_product_id__product_id__ref_stg_product_  [RUN]
[0m22:56:36.452451 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.its_on_sale.not_null_stg_price_history_ts_utc.a6f1e7003a, now test.its_on_sale.relationships_fact_price_history_product_id__product_id__ref_stg_product_.42bbec0ccf)
[0m22:56:36.452451 [debug] [Thread-4 (]: Began compiling node test.its_on_sale.relationships_fact_price_history_product_id__product_id__ref_stg_product_.42bbec0ccf
[0m22:56:36.461545 [debug] [Thread-4 (]: Writing injected SQL for node "test.its_on_sale.relationships_fact_price_history_product_id__product_id__ref_stg_product_.42bbec0ccf"
[0m22:56:36.462554 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.016 seconds
[0m22:56:36.464565 [debug] [Thread-3 (]: On test.its_on_sale.not_null_stg_product_product_id.5e35fa3f95: ROLLBACK
[0m22:56:36.464565 [debug] [Thread-4 (]: Began executing node test.its_on_sale.relationships_fact_price_history_product_id__product_id__ref_stg_product_.42bbec0ccf
[0m22:56:36.467769 [debug] [Thread-4 (]: Writing runtime sql for node "test.its_on_sale.relationships_fact_price_history_product_id__product_id__ref_stg_product_.42bbec0ccf"
[0m22:56:36.470808 [debug] [Thread-4 (]: Using postgres connection "test.its_on_sale.relationships_fact_price_history_product_id__product_id__ref_stg_product_.42bbec0ccf"
[0m22:56:36.471827 [debug] [Thread-4 (]: On test.its_on_sale.relationships_fact_price_history_product_id__product_id__ref_stg_product_.42bbec0ccf: BEGIN
[0m22:56:36.471827 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:56:36.472834 [debug] [Thread-3 (]: On test.its_on_sale.not_null_stg_product_product_id.5e35fa3f95: Close
[0m22:56:36.473856 [info ] [Thread-3 (]: 6 of 14 PASS not_null_stg_product_product_id ................................... [[32mPASS[0m in 0.13s]
[0m22:56:36.474866 [debug] [Thread-3 (]: Finished running node test.its_on_sale.not_null_stg_product_product_id.5e35fa3f95
[0m22:56:36.476920 [debug] [Thread-3 (]: Began running node test.its_on_sale.relationships_stg_price_history_product_id__product_id__ref_stg_product_.055b801818
[0m22:56:36.478021 [info ] [Thread-3 (]: 10 of 14 START test relationships_stg_price_history_product_id__product_id__ref_stg_product_  [RUN]
[0m22:56:36.479072 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.its_on_sale.not_null_stg_product_product_id.5e35fa3f95, now test.its_on_sale.relationships_stg_price_history_product_id__product_id__ref_stg_product_.055b801818)
[0m22:56:36.479072 [debug] [Thread-3 (]: Began compiling node test.its_on_sale.relationships_stg_price_history_product_id__product_id__ref_stg_product_.055b801818
[0m22:56:36.488344 [debug] [Thread-3 (]: Writing injected SQL for node "test.its_on_sale.relationships_stg_price_history_product_id__product_id__ref_stg_product_.055b801818"
[0m22:56:36.491421 [debug] [Thread-3 (]: Began executing node test.its_on_sale.relationships_stg_price_history_product_id__product_id__ref_stg_product_.055b801818
[0m22:56:36.495421 [debug] [Thread-3 (]: Writing runtime sql for node "test.its_on_sale.relationships_stg_price_history_product_id__product_id__ref_stg_product_.055b801818"
[0m22:56:36.497520 [debug] [Thread-3 (]: Using postgres connection "test.its_on_sale.relationships_stg_price_history_product_id__product_id__ref_stg_product_.055b801818"
[0m22:56:36.498611 [debug] [Thread-3 (]: On test.its_on_sale.relationships_stg_price_history_product_id__product_id__ref_stg_product_.055b801818: BEGIN
[0m22:56:36.498611 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:56:36.507777 [debug] [Thread-2 (]: SQL status: BEGIN in 0.063 seconds
[0m22:56:36.507777 [debug] [Thread-2 (]: Using postgres connection "test.its_on_sale.not_null_stg_product_site.712843232d"
[0m22:56:36.508828 [debug] [Thread-2 (]: On test.its_on_sale.not_null_stg_product_site.712843232d: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "node_id": "test.its_on_sale.not_null_stg_product_site.712843232d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select site
from "neondb"."public_staging"."stg_product"
where site is null



      
    ) dbt_internal_test
[0m22:56:36.517078 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.007 seconds
[0m22:56:36.519121 [debug] [Thread-2 (]: On test.its_on_sale.not_null_stg_product_site.712843232d: ROLLBACK
[0m22:56:36.522138 [debug] [Thread-1 (]: SQL status: BEGIN in 0.077 seconds
[0m22:56:36.523144 [debug] [Thread-1 (]: Using postgres connection "test.its_on_sale.not_null_stg_product_url.2f8ccdc1e9"
[0m22:56:36.523144 [debug] [Thread-1 (]: On test.its_on_sale.not_null_stg_product_url.2f8ccdc1e9: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "node_id": "test.its_on_sale.not_null_stg_product_url.2f8ccdc1e9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select url
from "neondb"."public_staging"."stg_product"
where url is null



      
    ) dbt_internal_test
[0m22:56:36.525179 [debug] [Thread-2 (]: On test.its_on_sale.not_null_stg_product_site.712843232d: Close
[0m22:56:36.527247 [info ] [Thread-2 (]: 7 of 14 PASS not_null_stg_product_site ......................................... [[32mPASS[0m in 0.12s]
[0m22:56:36.528253 [debug] [Thread-2 (]: Finished running node test.its_on_sale.not_null_stg_product_site.712843232d
[0m22:56:36.528253 [debug] [Thread-2 (]: Began running node test.its_on_sale.unique_fact_price_history_id.0da56e5a2d
[0m22:56:36.529276 [info ] [Thread-2 (]: 11 of 14 START test unique_fact_price_history_id ............................... [RUN]
[0m22:56:36.530321 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.its_on_sale.not_null_stg_product_site.712843232d, now test.its_on_sale.unique_fact_price_history_id.0da56e5a2d)
[0m22:56:36.530321 [debug] [Thread-2 (]: Began compiling node test.its_on_sale.unique_fact_price_history_id.0da56e5a2d
[0m22:56:36.531331 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m22:56:36.538409 [debug] [Thread-2 (]: Writing injected SQL for node "test.its_on_sale.unique_fact_price_history_id.0da56e5a2d"
[0m22:56:36.538409 [debug] [Thread-4 (]: SQL status: BEGIN in 0.067 seconds
[0m22:56:36.540421 [debug] [Thread-1 (]: On test.its_on_sale.not_null_stg_product_url.2f8ccdc1e9: ROLLBACK
[0m22:56:36.542550 [debug] [Thread-2 (]: Began executing node test.its_on_sale.unique_fact_price_history_id.0da56e5a2d
[0m22:56:36.545919 [debug] [Thread-4 (]: Using postgres connection "test.its_on_sale.relationships_fact_price_history_product_id__product_id__ref_stg_product_.42bbec0ccf"
[0m22:56:36.549976 [debug] [Thread-2 (]: Writing runtime sql for node "test.its_on_sale.unique_fact_price_history_id.0da56e5a2d"
[0m22:56:36.549976 [debug] [Thread-4 (]: On test.its_on_sale.relationships_fact_price_history_product_id__product_id__ref_stg_product_.42bbec0ccf: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "node_id": "test.its_on_sale.relationships_fact_price_history_product_id__product_id__ref_stg_product_.42bbec0ccf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_id as from_field
    from "neondb"."public_marts"."fact_price_history"
    where product_id is not null
),

parent as (
    select product_id as to_field
    from "neondb"."public_staging"."stg_product"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m22:56:36.551991 [debug] [Thread-1 (]: On test.its_on_sale.not_null_stg_product_url.2f8ccdc1e9: Close
[0m22:56:36.553006 [debug] [Thread-2 (]: Using postgres connection "test.its_on_sale.unique_fact_price_history_id.0da56e5a2d"
[0m22:56:36.553006 [debug] [Thread-2 (]: On test.its_on_sale.unique_fact_price_history_id.0da56e5a2d: BEGIN
[0m22:56:36.554484 [info ] [Thread-1 (]: 8 of 14 PASS not_null_stg_product_url .......................................... [[32mPASS[0m in 0.14s]
[0m22:56:36.554484 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:56:36.555489 [debug] [Thread-1 (]: Finished running node test.its_on_sale.not_null_stg_product_url.2f8ccdc1e9
[0m22:56:36.556496 [debug] [Thread-1 (]: Began running node test.its_on_sale.unique_stg_price_history_id.b6bbfe8a58
[0m22:56:36.557505 [info ] [Thread-1 (]: 12 of 14 START test unique_stg_price_history_id ................................ [RUN]
[0m22:56:36.558632 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "public_marts.fact_price_history" does not exist
LINE 13:     from "neondb"."public_marts"."fact_price_history"
                  ^

[0m22:56:36.559646 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.its_on_sale.not_null_stg_product_url.2f8ccdc1e9, now test.its_on_sale.unique_stg_price_history_id.b6bbfe8a58)
[0m22:56:36.559646 [debug] [Thread-4 (]: On test.its_on_sale.relationships_fact_price_history_product_id__product_id__ref_stg_product_.42bbec0ccf: ROLLBACK
[0m22:56:36.560904 [debug] [Thread-1 (]: Began compiling node test.its_on_sale.unique_stg_price_history_id.b6bbfe8a58
[0m22:56:36.566974 [debug] [Thread-1 (]: Writing injected SQL for node "test.its_on_sale.unique_stg_price_history_id.b6bbfe8a58"
[0m22:56:36.567980 [debug] [Thread-3 (]: SQL status: BEGIN in 0.069 seconds
[0m22:56:36.567980 [debug] [Thread-3 (]: Using postgres connection "test.its_on_sale.relationships_stg_price_history_product_id__product_id__ref_stg_product_.055b801818"
[0m22:56:36.569012 [debug] [Thread-3 (]: On test.its_on_sale.relationships_stg_price_history_product_id__product_id__ref_stg_product_.055b801818: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "node_id": "test.its_on_sale.relationships_stg_price_history_product_id__product_id__ref_stg_product_.055b801818"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_id as from_field
    from "neondb"."public_staging"."stg_price_history"
    where product_id is not null
),

parent as (
    select product_id as to_field
    from "neondb"."public_staging"."stg_product"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m22:56:36.570019 [debug] [Thread-1 (]: Began executing node test.its_on_sale.unique_stg_price_history_id.b6bbfe8a58
[0m22:56:36.570019 [debug] [Thread-4 (]: On test.its_on_sale.relationships_fact_price_history_product_id__product_id__ref_stg_product_.42bbec0ccf: Close
[0m22:56:36.574184 [debug] [Thread-1 (]: Writing runtime sql for node "test.its_on_sale.unique_stg_price_history_id.b6bbfe8a58"
[0m22:56:36.577454 [debug] [Thread-1 (]: Using postgres connection "test.its_on_sale.unique_stg_price_history_id.b6bbfe8a58"
[0m22:56:36.578481 [debug] [Thread-1 (]: On test.its_on_sale.unique_stg_price_history_id.b6bbfe8a58: BEGIN
[0m22:56:36.579539 [debug] [Thread-4 (]: Database Error in test relationships_fact_price_history_product_id__product_id__ref_stg_product_ (models\marts\marts.yml)
  relation "public_marts.fact_price_history" does not exist
  LINE 13:     from "neondb"."public_marts"."fact_price_history"
                    ^
  compiled code at target\run\its_on_sale\models\marts\marts.yml\relationships_fact_price_histo_850030980a5b931f9742074e40b00449.sql
[0m22:56:36.580564 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:56:36.581577 [error] [Thread-4 (]: 9 of 14 ERROR relationships_fact_price_history_product_id__product_id__ref_stg_product_  [[31mERROR[0m in 0.13s]
[0m22:56:36.582726 [debug] [Thread-4 (]: Finished running node test.its_on_sale.relationships_fact_price_history_product_id__product_id__ref_stg_product_.42bbec0ccf
[0m22:56:36.583732 [debug] [Thread-4 (]: Began running node test.its_on_sale.unique_stg_product_product_id.fd1037e514
[0m22:56:36.584736 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.014 seconds
[0m22:56:36.584736 [info ] [Thread-4 (]: 13 of 14 START test unique_stg_product_product_id .............................. [RUN]
[0m22:56:36.586792 [debug] [Thread-3 (]: On test.its_on_sale.relationships_stg_price_history_product_id__product_id__ref_stg_product_.055b801818: ROLLBACK
[0m22:56:36.587803 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.its_on_sale.relationships_fact_price_history_product_id__product_id__ref_stg_product_.42bbec0ccf, now test.its_on_sale.unique_stg_product_product_id.fd1037e514)
[0m22:56:36.588811 [debug] [Thread-4 (]: Began compiling node test.its_on_sale.unique_stg_product_product_id.fd1037e514
[0m22:56:36.593122 [debug] [Thread-4 (]: Writing injected SQL for node "test.its_on_sale.unique_stg_product_product_id.fd1037e514"
[0m22:56:36.595163 [debug] [Thread-3 (]: On test.its_on_sale.relationships_stg_price_history_product_id__product_id__ref_stg_product_.055b801818: Close
[0m22:56:36.596168 [debug] [Thread-4 (]: Began executing node test.its_on_sale.unique_stg_product_product_id.fd1037e514
[0m22:56:36.600215 [debug] [Thread-4 (]: Writing runtime sql for node "test.its_on_sale.unique_stg_product_product_id.fd1037e514"
[0m22:56:36.601227 [info ] [Thread-3 (]: 10 of 14 PASS relationships_stg_price_history_product_id__product_id__ref_stg_product_  [[32mPASS[0m in 0.12s]
[0m22:56:36.602234 [debug] [Thread-3 (]: Finished running node test.its_on_sale.relationships_stg_price_history_product_id__product_id__ref_stg_product_.055b801818
[0m22:56:36.603241 [debug] [Thread-3 (]: Began running node test.its_on_sale.unique_stg_product_url.35c93a6d66
[0m22:56:36.603241 [debug] [Thread-4 (]: Using postgres connection "test.its_on_sale.unique_stg_product_product_id.fd1037e514"
[0m22:56:36.604255 [info ] [Thread-3 (]: 14 of 14 START test unique_stg_product_url ..................................... [RUN]
[0m22:56:36.605357 [debug] [Thread-4 (]: On test.its_on_sale.unique_stg_product_product_id.fd1037e514: BEGIN
[0m22:56:36.605357 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.its_on_sale.relationships_stg_price_history_product_id__product_id__ref_stg_product_.055b801818, now test.its_on_sale.unique_stg_product_url.35c93a6d66)
[0m22:56:36.606363 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:56:36.607375 [debug] [Thread-3 (]: Began compiling node test.its_on_sale.unique_stg_product_url.35c93a6d66
[0m22:56:36.612447 [debug] [Thread-3 (]: Writing injected SQL for node "test.its_on_sale.unique_stg_product_url.35c93a6d66"
[0m22:56:36.613453 [debug] [Thread-3 (]: Began executing node test.its_on_sale.unique_stg_product_url.35c93a6d66
[0m22:56:36.616634 [debug] [Thread-3 (]: Writing runtime sql for node "test.its_on_sale.unique_stg_product_url.35c93a6d66"
[0m22:56:36.617639 [debug] [Thread-2 (]: SQL status: BEGIN in 0.062 seconds
[0m22:56:36.618643 [debug] [Thread-2 (]: Using postgres connection "test.its_on_sale.unique_fact_price_history_id.0da56e5a2d"
[0m22:56:36.618643 [debug] [Thread-2 (]: On test.its_on_sale.unique_fact_price_history_id.0da56e5a2d: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "node_id": "test.its_on_sale.unique_fact_price_history_id.0da56e5a2d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "neondb"."public_marts"."fact_price_history"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:56:36.619646 [debug] [Thread-3 (]: Using postgres connection "test.its_on_sale.unique_stg_product_url.35c93a6d66"
[0m22:56:36.620723 [debug] [Thread-3 (]: On test.its_on_sale.unique_stg_product_url.35c93a6d66: BEGIN
[0m22:56:36.620723 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:56:36.625836 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "public_marts.fact_price_history" does not exist
LINE 15: from "neondb"."public_marts"."fact_price_history"
              ^

[0m22:56:36.626845 [debug] [Thread-2 (]: On test.its_on_sale.unique_fact_price_history_id.0da56e5a2d: ROLLBACK
[0m22:56:36.634105 [debug] [Thread-2 (]: On test.its_on_sale.unique_fact_price_history_id.0da56e5a2d: Close
[0m22:56:36.638261 [debug] [Thread-2 (]: Database Error in test unique_fact_price_history_id (models\marts\marts.yml)
  relation "public_marts.fact_price_history" does not exist
  LINE 15: from "neondb"."public_marts"."fact_price_history"
                ^
  compiled code at target\run\its_on_sale\models\marts\marts.yml\unique_fact_price_history_id.sql
[0m22:56:36.639282 [error] [Thread-2 (]: 11 of 14 ERROR unique_fact_price_history_id .................................... [[31mERROR[0m in 0.11s]
[0m22:56:36.639282 [debug] [Thread-1 (]: SQL status: BEGIN in 0.059 seconds
[0m22:56:36.640286 [debug] [Thread-2 (]: Finished running node test.its_on_sale.unique_fact_price_history_id.0da56e5a2d
[0m22:56:36.640286 [debug] [Thread-1 (]: Using postgres connection "test.its_on_sale.unique_stg_price_history_id.b6bbfe8a58"
[0m22:56:36.642311 [debug] [Thread-1 (]: On test.its_on_sale.unique_stg_price_history_id.b6bbfe8a58: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "node_id": "test.its_on_sale.unique_stg_price_history_id.b6bbfe8a58"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "neondb"."public_staging"."stg_price_history"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:56:36.649449 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m22:56:36.651663 [debug] [Thread-1 (]: On test.its_on_sale.unique_stg_price_history_id.b6bbfe8a58: ROLLBACK
[0m22:56:36.656664 [debug] [Thread-1 (]: On test.its_on_sale.unique_stg_price_history_id.b6bbfe8a58: Close
[0m22:56:36.658772 [info ] [Thread-1 (]: 12 of 14 PASS unique_stg_price_history_id ...................................... [[32mPASS[0m in 0.10s]
[0m22:56:36.660088 [debug] [Thread-1 (]: Finished running node test.its_on_sale.unique_stg_price_history_id.b6bbfe8a58
[0m22:56:36.674378 [debug] [Thread-4 (]: SQL status: BEGIN in 0.068 seconds
[0m22:56:36.675384 [debug] [Thread-4 (]: Using postgres connection "test.its_on_sale.unique_stg_product_product_id.fd1037e514"
[0m22:56:36.675384 [debug] [Thread-4 (]: On test.its_on_sale.unique_stg_product_product_id.fd1037e514: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "node_id": "test.its_on_sale.unique_stg_product_product_id.fd1037e514"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "neondb"."public_staging"."stg_product"
where product_id is not null
group by product_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:56:36.678422 [debug] [Thread-3 (]: SQL status: BEGIN in 0.057 seconds
[0m22:56:36.678422 [debug] [Thread-3 (]: Using postgres connection "test.its_on_sale.unique_stg_product_url.35c93a6d66"
[0m22:56:36.679427 [debug] [Thread-3 (]: On test.its_on_sale.unique_stg_product_url.35c93a6d66: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "node_id": "test.its_on_sale.unique_stg_product_url.35c93a6d66"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    url as unique_field,
    count(*) as n_records

from "neondb"."public_staging"."stg_product"
where url is not null
group by url
having count(*) > 1



      
    ) dbt_internal_test
[0m22:56:36.684567 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.008 seconds
[0m22:56:36.686583 [debug] [Thread-4 (]: On test.its_on_sale.unique_stg_product_product_id.fd1037e514: ROLLBACK
[0m22:56:36.686583 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.007 seconds
[0m22:56:36.688592 [debug] [Thread-3 (]: On test.its_on_sale.unique_stg_product_url.35c93a6d66: ROLLBACK
[0m22:56:36.694790 [debug] [Thread-4 (]: On test.its_on_sale.unique_stg_product_product_id.fd1037e514: Close
[0m22:56:36.695794 [debug] [Thread-3 (]: On test.its_on_sale.unique_stg_product_url.35c93a6d66: Close
[0m22:56:36.696800 [info ] [Thread-4 (]: 13 of 14 PASS unique_stg_product_product_id .................................... [[32mPASS[0m in 0.11s]
[0m22:56:36.698198 [debug] [Thread-4 (]: Finished running node test.its_on_sale.unique_stg_product_product_id.fd1037e514
[0m22:56:36.698198 [info ] [Thread-3 (]: 14 of 14 PASS unique_stg_product_url ........................................... [[32mPASS[0m in 0.09s]
[0m22:56:36.699538 [debug] [Thread-3 (]: Finished running node test.its_on_sale.unique_stg_product_url.35c93a6d66
[0m22:56:36.701553 [debug] [MainThread]: Using postgres connection "master"
[0m22:56:36.701553 [debug] [MainThread]: On master: BEGIN
[0m22:56:36.702561 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:56:36.767105 [debug] [MainThread]: SQL status: BEGIN in 0.065 seconds
[0m22:56:36.768366 [debug] [MainThread]: On master: COMMIT
[0m22:56:36.769379 [debug] [MainThread]: Using postgres connection "master"
[0m22:56:36.769379 [debug] [MainThread]: On master: COMMIT
[0m22:56:36.775392 [debug] [MainThread]: SQL status: COMMIT in 0.005 seconds
[0m22:56:36.775392 [debug] [MainThread]: On master: Close
[0m22:56:36.776773 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:56:36.777778 [debug] [MainThread]: Connection 'list_neondb_public_staging' was properly closed.
[0m22:56:36.777778 [debug] [MainThread]: Connection 'list_neondb_public_marts' was properly closed.
[0m22:56:36.778783 [debug] [MainThread]: Connection 'test.its_on_sale.unique_stg_price_history_id.b6bbfe8a58' was properly closed.
[0m22:56:36.778783 [debug] [MainThread]: Connection 'test.its_on_sale.unique_fact_price_history_id.0da56e5a2d' was properly closed.
[0m22:56:36.779787 [debug] [MainThread]: Connection 'test.its_on_sale.unique_stg_product_url.35c93a6d66' was properly closed.
[0m22:56:36.779787 [debug] [MainThread]: Connection 'test.its_on_sale.unique_stg_product_product_id.fd1037e514' was properly closed.
[0m22:56:36.780791 [info ] [MainThread]: 
[0m22:56:36.781793 [info ] [MainThread]: Finished running 14 data tests in 0 hours 0 minutes and 1.08 seconds (1.08s).
[0m22:56:36.784965 [debug] [MainThread]: Command end result
[0m22:56:36.836276 [info ] [MainThread]: 
[0m22:56:36.837567 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m22:56:36.838576 [info ] [MainThread]: 
[0m22:56:36.839594 [error] [MainThread]:   Database Error in test not_null_fact_price_history_ts_utc (models\marts\marts.yml)
  relation "public_marts.fact_price_history" does not exist
  LINE 14: from "neondb"."public_marts"."fact_price_history"
                ^
  compiled code at target\run\its_on_sale\models\marts\marts.yml\not_null_fact_price_history_ts_utc.sql
[0m22:56:36.840621 [info ] [MainThread]: 
[0m22:56:36.841943 [error] [MainThread]:   Database Error in test not_null_fact_price_history_id (models\marts\marts.yml)
  relation "public_marts.fact_price_history" does not exist
  LINE 14: from "neondb"."public_marts"."fact_price_history"
                ^
  compiled code at target\run\its_on_sale\models\marts\marts.yml\not_null_fact_price_history_id.sql
[0m22:56:36.844039 [info ] [MainThread]: 
[0m22:56:36.845039 [error] [MainThread]:   Database Error in test relationships_fact_price_history_product_id__product_id__ref_stg_product_ (models\marts\marts.yml)
  relation "public_marts.fact_price_history" does not exist
  LINE 13:     from "neondb"."public_marts"."fact_price_history"
                    ^
  compiled code at target\run\its_on_sale\models\marts\marts.yml\relationships_fact_price_histo_850030980a5b931f9742074e40b00449.sql
[0m22:56:36.846039 [info ] [MainThread]: 
[0m22:56:36.847040 [error] [MainThread]:   Database Error in test unique_fact_price_history_id (models\marts\marts.yml)
  relation "public_marts.fact_price_history" does not exist
  LINE 15: from "neondb"."public_marts"."fact_price_history"
                ^
  compiled code at target\run\its_on_sale\models\marts\marts.yml\unique_fact_price_history_id.sql
[0m22:56:36.848041 [info ] [MainThread]: 
[0m22:56:36.849205 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=4 SKIP=0 TOTAL=14
[0m22:56:36.853462 [debug] [MainThread]: Command `dbt test` failed at 22:56:36.853462 after 1.86 seconds
[0m22:56:36.854461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A6F0C0E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A6F0C0CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A76802FD0>]}
[0m22:56:36.854461 [debug] [MainThread]: Flushing usage events
[0m22:58:35.236020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024FEDE92410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024FEA60E190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024FEDA95490>]}


============================== 22:58:35.240043 | a69f1b90-49cf-4eca-862c-5320987283a5 ==============================
[0m22:58:35.240043 [info ] [MainThread]: Running with dbt=1.8.8
[0m22:58:35.241046 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '..\\', 'fail_fast': 'False', 'debug': 'False', 'log_path': "C:\\Users\\meg\\Documents\\cam\\proj\\It's On Sale\\its-on-sale-tracker\\pipeline\\transform\\its_on_sale\\logs", 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ls --resource-type model --profiles-dir ..\\', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:58:35.470412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a69f1b90-49cf-4eca-862c-5320987283a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024FEDE91C10>]}
[0m22:58:35.533711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a69f1b90-49cf-4eca-862c-5320987283a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024FEAF08B90>]}
[0m22:58:35.535806 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:58:35.549249 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m22:58:35.739289 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:58:35.739289 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:58:35.777429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a69f1b90-49cf-4eca-862c-5320987283a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024FEF008890>]}
[0m22:58:35.897925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a69f1b90-49cf-4eca-862c-5320987283a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024FEF413F90>]}
[0m22:58:35.898934 [info ] [MainThread]: Found 3 models, 14 data tests, 423 macros
[0m22:58:35.899940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a69f1b90-49cf-4eca-862c-5320987283a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024FEF11E1D0>]}
[0m22:58:35.902010 [debug] [MainThread]: Command `dbt ls` succeeded at 22:58:35.902010 after 0.74 seconds
[0m22:58:35.903015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024FEEEB6650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024FEEEB64D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024FEDC80D50>]}
[0m22:58:35.904036 [debug] [MainThread]: Flushing usage events
[0m22:59:12.829911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001914C0C3890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001914D0D0550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001914C0C2750>]}


============================== 22:59:12.833508 | 25db3c70-0c3d-4135-b356-b136ac185352 ==============================
[0m22:59:12.833508 [info ] [MainThread]: Running with dbt=1.8.8
[0m22:59:12.834509 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': "C:\\Users\\meg\\Documents\\cam\\proj\\It's On Sale\\its-on-sale-tracker\\pipeline\\transform\\its_on_sale\\logs", 'profiles_dir': '..\\', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir ..\\', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:59:13.057029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '25db3c70-0c3d-4135-b356-b136ac185352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001914BEAD010>]}
[0m22:59:13.109507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '25db3c70-0c3d-4135-b356-b136ac185352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191491144D0>]}
[0m22:59:13.111519 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:59:13.121776 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m22:59:13.292084 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:59:13.292084 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:59:13.333689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25db3c70-0c3d-4135-b356-b136ac185352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001914D408490>]}
[0m22:59:13.439474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25db3c70-0c3d-4135-b356-b136ac185352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001914D50B150>]}
[0m22:59:13.440482 [info ] [MainThread]: Found 3 models, 14 data tests, 423 macros
[0m22:59:13.441486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25db3c70-0c3d-4135-b356-b136ac185352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001914BFB6910>]}
[0m22:59:13.443498 [info ] [MainThread]: 
[0m22:59:13.443498 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:59:13.448521 [debug] [ThreadPool]: Acquiring new postgres connection 'list_neondb'
[0m22:59:13.572456 [debug] [ThreadPool]: Using postgres connection "list_neondb"
[0m22:59:13.573457 [debug] [ThreadPool]: On list_neondb: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "connection_name": "list_neondb"} */

    select distinct nspname from pg_namespace
  
[0m22:59:13.574457 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:59:13.647548 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.073 seconds
[0m22:59:13.648563 [debug] [ThreadPool]: On list_neondb: Close
[0m22:59:13.650592 [debug] [ThreadPool]: Acquiring new postgres connection 'list_neondb_public_marts'
[0m22:59:13.651608 [debug] [ThreadPool]: Acquiring new postgres connection 'list_neondb_public_staging'
[0m22:59:13.727037 [debug] [ThreadPool]: Using postgres connection "list_neondb_public_marts"
[0m22:59:13.729070 [debug] [ThreadPool]: Using postgres connection "list_neondb_public_staging"
[0m22:59:13.730090 [debug] [ThreadPool]: On list_neondb_public_marts: BEGIN
[0m22:59:13.730090 [debug] [ThreadPool]: On list_neondb_public_staging: BEGIN
[0m22:59:13.731105 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:59:13.731105 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:59:13.791650 [debug] [ThreadPool]: SQL status: BEGIN in 0.061 seconds
[0m22:59:13.792708 [debug] [ThreadPool]: Using postgres connection "list_neondb_public_marts"
[0m22:59:13.792708 [debug] [ThreadPool]: On list_neondb_public_marts: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "connection_name": "list_neondb_public_marts"} */
select
      'neondb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'neondb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'neondb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m22:59:13.802136 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.008 seconds
[0m22:59:13.803140 [debug] [ThreadPool]: On list_neondb_public_marts: ROLLBACK
[0m22:59:13.809356 [debug] [ThreadPool]: On list_neondb_public_marts: Close
[0m22:59:13.815253 [debug] [ThreadPool]: SQL status: BEGIN in 0.084 seconds
[0m22:59:13.815253 [debug] [ThreadPool]: Using postgres connection "list_neondb_public_staging"
[0m22:59:13.816255 [debug] [ThreadPool]: On list_neondb_public_staging: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "connection_name": "list_neondb_public_staging"} */
select
      'neondb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'neondb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'neondb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m22:59:13.824237 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.007 seconds
[0m22:59:13.825243 [debug] [ThreadPool]: On list_neondb_public_staging: ROLLBACK
[0m22:59:13.831402 [debug] [ThreadPool]: On list_neondb_public_staging: Close
[0m22:59:13.836430 [debug] [MainThread]: Using postgres connection "master"
[0m22:59:13.836430 [debug] [MainThread]: On master: BEGIN
[0m22:59:13.837434 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:59:13.899082 [debug] [MainThread]: SQL status: BEGIN in 0.061 seconds
[0m22:59:13.899082 [debug] [MainThread]: Using postgres connection "master"
[0m22:59:13.900090 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:59:13.908491 [debug] [MainThread]: SQL status: SELECT 2 in 0.007 seconds
[0m22:59:13.909499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25db3c70-0c3d-4135-b356-b136ac185352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001914D51D090>]}
[0m22:59:13.910503 [debug] [MainThread]: On master: ROLLBACK
[0m22:59:13.916072 [debug] [MainThread]: Using postgres connection "master"
[0m22:59:13.916072 [debug] [MainThread]: On master: BEGIN
[0m22:59:13.927401 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m22:59:13.927401 [debug] [MainThread]: On master: COMMIT
[0m22:59:13.928408 [debug] [MainThread]: Using postgres connection "master"
[0m22:59:13.928408 [debug] [MainThread]: On master: COMMIT
[0m22:59:13.934118 [debug] [MainThread]: SQL status: COMMIT in 0.005 seconds
[0m22:59:13.934118 [debug] [MainThread]: On master: Close
[0m22:59:13.935124 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:59:13.936128 [info ] [MainThread]: 
[0m22:59:13.939683 [debug] [Thread-1 (]: Began running node model.its_on_sale.stg_price_history
[0m22:59:13.939683 [debug] [Thread-2 (]: Began running node model.its_on_sale.stg_product
[0m22:59:13.940700 [info ] [Thread-1 (]: 1 of 2 START sql view model public_staging.stg_price_history ................... [RUN]
[0m22:59:13.941860 [info ] [Thread-2 (]: 2 of 2 START sql view model public_staging.stg_product ......................... [RUN]
[0m22:59:13.941860 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.its_on_sale.stg_price_history'
[0m22:59:13.943255 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.its_on_sale.stg_product'
[0m22:59:13.943255 [debug] [Thread-1 (]: Began compiling node model.its_on_sale.stg_price_history
[0m22:59:13.944352 [debug] [Thread-2 (]: Began compiling node model.its_on_sale.stg_product
[0m22:59:13.951629 [debug] [Thread-1 (]: Writing injected SQL for node "model.its_on_sale.stg_price_history"
[0m22:59:13.953705 [debug] [Thread-2 (]: Writing injected SQL for node "model.its_on_sale.stg_product"
[0m22:59:13.955912 [debug] [Thread-1 (]: Began executing node model.its_on_sale.stg_price_history
[0m22:59:13.955912 [debug] [Thread-2 (]: Began executing node model.its_on_sale.stg_product
[0m22:59:13.992933 [debug] [Thread-1 (]: Writing runtime sql for node "model.its_on_sale.stg_price_history"
[0m22:59:13.996956 [debug] [Thread-2 (]: Writing runtime sql for node "model.its_on_sale.stg_product"
[0m22:59:13.998327 [debug] [Thread-1 (]: Using postgres connection "model.its_on_sale.stg_price_history"
[0m22:59:13.998327 [debug] [Thread-1 (]: On model.its_on_sale.stg_price_history: BEGIN
[0m22:59:13.998327 [debug] [Thread-2 (]: Using postgres connection "model.its_on_sale.stg_product"
[0m22:59:13.999470 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:59:13.999470 [debug] [Thread-2 (]: On model.its_on_sale.stg_product: BEGIN
[0m22:59:14.000715 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:59:14.059196 [debug] [Thread-2 (]: SQL status: BEGIN in 0.058 seconds
[0m22:59:14.060200 [debug] [Thread-2 (]: Using postgres connection "model.its_on_sale.stg_product"
[0m22:59:14.060200 [debug] [Thread-1 (]: SQL status: BEGIN in 0.061 seconds
[0m22:59:14.061629 [debug] [Thread-2 (]: On model.its_on_sale.stg_product: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "node_id": "model.its_on_sale.stg_product"} */

  create view "neondb"."public_staging"."stg_product__dbt_tmp"
    
    
  as (
    -- Basic staging view over product

select
  product_id,
  site,
  url,
  name,
  created_at
from public.product
  );
[0m22:59:14.061629 [debug] [Thread-1 (]: Using postgres connection "model.its_on_sale.stg_price_history"
[0m22:59:14.063001 [debug] [Thread-1 (]: On model.its_on_sale.stg_price_history: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "node_id": "model.its_on_sale.stg_price_history"} */

  create view "neondb"."public_staging"."stg_price_history__dbt_tmp"
    
    
  as (
    -- Basic staging view over price_history

select
  id,
  product_id,
  ts_utc,
  cast(price_numeric as numeric(12,2)) as price,
  currency,
  in_stock_bool as in_stock,
  on_sale_bool as on_sale,
  source_hash
from public.price_history
  );
[0m22:59:14.071548 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m22:59:14.071548 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m22:59:14.079700 [debug] [Thread-2 (]: Using postgres connection "model.its_on_sale.stg_product"
[0m22:59:14.084781 [debug] [Thread-1 (]: Using postgres connection "model.its_on_sale.stg_price_history"
[0m22:59:14.085796 [debug] [Thread-2 (]: On model.its_on_sale.stg_product: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "node_id": "model.its_on_sale.stg_product"} */
alter table "neondb"."public_staging"."stg_product" rename to "stg_product__dbt_backup"
[0m22:59:14.085796 [debug] [Thread-1 (]: On model.its_on_sale.stg_price_history: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "node_id": "model.its_on_sale.stg_price_history"} */
alter table "neondb"."public_staging"."stg_price_history" rename to "stg_price_history__dbt_backup"
[0m22:59:14.093865 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m22:59:14.093865 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.008 seconds
[0m22:59:14.097986 [debug] [Thread-1 (]: Using postgres connection "model.its_on_sale.stg_price_history"
[0m22:59:14.100990 [debug] [Thread-2 (]: Using postgres connection "model.its_on_sale.stg_product"
[0m22:59:14.100990 [debug] [Thread-1 (]: On model.its_on_sale.stg_price_history: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "node_id": "model.its_on_sale.stg_price_history"} */
alter table "neondb"."public_staging"."stg_price_history__dbt_tmp" rename to "stg_price_history"
[0m22:59:14.102475 [debug] [Thread-2 (]: On model.its_on_sale.stg_product: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "node_id": "model.its_on_sale.stg_product"} */
alter table "neondb"."public_staging"."stg_product__dbt_tmp" rename to "stg_product"
[0m22:59:14.108947 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m22:59:14.109952 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m22:59:14.127270 [debug] [Thread-1 (]: On model.its_on_sale.stg_price_history: COMMIT
[0m22:59:14.129329 [debug] [Thread-2 (]: On model.its_on_sale.stg_product: COMMIT
[0m22:59:14.130446 [debug] [Thread-1 (]: Using postgres connection "model.its_on_sale.stg_price_history"
[0m22:59:14.130446 [debug] [Thread-2 (]: Using postgres connection "model.its_on_sale.stg_product"
[0m22:59:14.131449 [debug] [Thread-1 (]: On model.its_on_sale.stg_price_history: COMMIT
[0m22:59:14.131449 [debug] [Thread-2 (]: On model.its_on_sale.stg_product: COMMIT
[0m22:59:14.139711 [debug] [Thread-2 (]: SQL status: COMMIT in 0.007 seconds
[0m22:59:14.140711 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m22:59:14.149021 [debug] [Thread-2 (]: Applying DROP to: "neondb"."public_staging"."stg_product__dbt_backup"
[0m22:59:14.153096 [debug] [Thread-1 (]: Applying DROP to: "neondb"."public_staging"."stg_price_history__dbt_backup"
[0m22:59:14.159391 [debug] [Thread-2 (]: Using postgres connection "model.its_on_sale.stg_product"
[0m22:59:14.161482 [debug] [Thread-1 (]: Using postgres connection "model.its_on_sale.stg_price_history"
[0m22:59:14.162511 [debug] [Thread-2 (]: On model.its_on_sale.stg_product: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "node_id": "model.its_on_sale.stg_product"} */
drop view if exists "neondb"."public_staging"."stg_product__dbt_backup" cascade
[0m22:59:14.163516 [debug] [Thread-1 (]: On model.its_on_sale.stg_price_history: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "node_id": "model.its_on_sale.stg_price_history"} */
drop view if exists "neondb"."public_staging"."stg_price_history__dbt_backup" cascade
[0m22:59:14.178576 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.013 seconds
[0m22:59:14.179599 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.014 seconds
[0m22:59:14.182759 [debug] [Thread-2 (]: On model.its_on_sale.stg_product: Close
[0m22:59:14.184766 [debug] [Thread-1 (]: On model.its_on_sale.stg_price_history: Close
[0m22:59:14.188147 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25db3c70-0c3d-4135-b356-b136ac185352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001914D7C0550>]}
[0m22:59:14.188147 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25db3c70-0c3d-4135-b356-b136ac185352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001914D7C0AD0>]}
[0m22:59:14.189152 [info ] [Thread-2 (]: 2 of 2 OK created sql view model public_staging.stg_product .................... [[32mCREATE VIEW[0m in 0.24s]
[0m22:59:14.190152 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public_staging.stg_price_history .............. [[32mCREATE VIEW[0m in 0.25s]
[0m22:59:14.192153 [debug] [Thread-2 (]: Finished running node model.its_on_sale.stg_product
[0m22:59:14.193152 [debug] [Thread-1 (]: Finished running node model.its_on_sale.stg_price_history
[0m22:59:14.194153 [debug] [MainThread]: Using postgres connection "master"
[0m22:59:14.195616 [debug] [MainThread]: On master: BEGIN
[0m22:59:14.196623 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:59:14.254059 [debug] [MainThread]: SQL status: BEGIN in 0.057 seconds
[0m22:59:14.254059 [debug] [MainThread]: On master: COMMIT
[0m22:59:14.255082 [debug] [MainThread]: Using postgres connection "master"
[0m22:59:14.256117 [debug] [MainThread]: On master: COMMIT
[0m22:59:14.261118 [debug] [MainThread]: SQL status: COMMIT in 0.005 seconds
[0m22:59:14.263330 [debug] [MainThread]: On master: Close
[0m22:59:14.264441 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:59:14.264441 [debug] [MainThread]: Connection 'list_neondb' was properly closed.
[0m22:59:14.265445 [debug] [MainThread]: Connection 'list_neondb_public_marts' was properly closed.
[0m22:59:14.266446 [debug] [MainThread]: Connection 'list_neondb_public_staging' was properly closed.
[0m22:59:14.266446 [debug] [MainThread]: Connection 'model.its_on_sale.stg_price_history' was properly closed.
[0m22:59:14.267446 [debug] [MainThread]: Connection 'model.its_on_sale.stg_product' was properly closed.
[0m22:59:14.267446 [info ] [MainThread]: 
[0m22:59:14.268448 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.82 seconds (0.82s).
[0m22:59:14.270448 [debug] [MainThread]: Command end result
[0m22:59:14.314106 [info ] [MainThread]: 
[0m22:59:14.314106 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:59:14.315111 [info ] [MainThread]: 
[0m22:59:14.316115 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:59:14.317119 [debug] [MainThread]: Command `dbt run` succeeded at 22:59:14.317119 after 1.56 seconds
[0m22:59:14.318123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191445B7050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191445B6DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191445B6F50>]}
[0m22:59:14.318123 [debug] [MainThread]: Flushing usage events
[0m22:59:18.865879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E002D39D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E002CF7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E002D33D0>]}


============================== 22:59:18.869902 | cb4f88b0-2f15-4988-8ca9-f299dea02d90 ==============================
[0m22:59:18.869902 [info ] [MainThread]: Running with dbt=1.8.8
[0m22:59:18.870906 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '..\\', 'version_check': 'True', 'fail_fast': 'False', 'log_path': "C:\\Users\\meg\\Documents\\cam\\proj\\It's On Sale\\its-on-sale-tracker\\pipeline\\transform\\its_on_sale\\logs", 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir ..\\', 'send_anonymous_usage_stats': 'True'}
[0m22:59:19.093719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb4f88b0-2f15-4988-8ca9-f299dea02d90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E0148BDD0>]}
[0m22:59:19.145281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb4f88b0-2f15-4988-8ca9-f299dea02d90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E7D264510>]}
[0m22:59:19.147292 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:59:19.157460 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m22:59:19.326708 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:59:19.327712 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:59:19.365109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb4f88b0-2f15-4988-8ca9-f299dea02d90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E015C2AD0>]}
[0m22:59:19.480436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb4f88b0-2f15-4988-8ca9-f299dea02d90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E0182FE10>]}
[0m22:59:19.481878 [info ] [MainThread]: Found 3 models, 14 data tests, 423 macros
[0m22:59:19.481878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb4f88b0-2f15-4988-8ca9-f299dea02d90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E0148BD90>]}
[0m22:59:19.484250 [info ] [MainThread]: 
[0m22:59:19.485250 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:59:19.489388 [debug] [ThreadPool]: Acquiring new postgres connection 'list_neondb_public_marts'
[0m22:59:19.490882 [debug] [ThreadPool]: Acquiring new postgres connection 'list_neondb_public_staging'
[0m22:59:19.688314 [debug] [ThreadPool]: Using postgres connection "list_neondb_public_marts"
[0m22:59:19.688314 [debug] [ThreadPool]: Using postgres connection "list_neondb_public_staging"
[0m22:59:19.689336 [debug] [ThreadPool]: On list_neondb_public_marts: BEGIN
[0m22:59:19.689336 [debug] [ThreadPool]: On list_neondb_public_staging: BEGIN
[0m22:59:19.690343 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:59:19.690343 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:59:19.762866 [debug] [ThreadPool]: SQL status: BEGIN in 0.073 seconds
[0m22:59:19.763628 [debug] [ThreadPool]: Using postgres connection "list_neondb_public_marts"
[0m22:59:19.763628 [debug] [ThreadPool]: On list_neondb_public_marts: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "connection_name": "list_neondb_public_marts"} */
select
      'neondb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'neondb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'neondb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m22:59:19.768411 [debug] [ThreadPool]: SQL status: BEGIN in 0.078 seconds
[0m22:59:19.769461 [debug] [ThreadPool]: Using postgres connection "list_neondb_public_staging"
[0m22:59:19.769461 [debug] [ThreadPool]: On list_neondb_public_staging: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "connection_name": "list_neondb_public_staging"} */
select
      'neondb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'neondb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'neondb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m22:59:19.770466 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m22:59:19.772481 [debug] [ThreadPool]: On list_neondb_public_marts: ROLLBACK
[0m22:59:19.782723 [debug] [ThreadPool]: On list_neondb_public_marts: Close
[0m22:59:19.782723 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.013 seconds
[0m22:59:19.784776 [debug] [ThreadPool]: On list_neondb_public_staging: ROLLBACK
[0m22:59:19.790847 [debug] [ThreadPool]: On list_neondb_public_staging: Close
[0m22:59:19.796896 [debug] [MainThread]: Using postgres connection "master"
[0m22:59:19.796896 [debug] [MainThread]: On master: BEGIN
[0m22:59:19.797902 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:59:19.858089 [debug] [MainThread]: SQL status: BEGIN in 0.060 seconds
[0m22:59:19.858089 [debug] [MainThread]: Using postgres connection "master"
[0m22:59:19.859094 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:59:19.869355 [debug] [MainThread]: SQL status: SELECT 2 in 0.009 seconds
[0m22:59:19.870358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb4f88b0-2f15-4988-8ca9-f299dea02d90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E015F70D0>]}
[0m22:59:19.871362 [debug] [MainThread]: On master: ROLLBACK
[0m22:59:19.876010 [debug] [MainThread]: Using postgres connection "master"
[0m22:59:19.877019 [debug] [MainThread]: On master: BEGIN
[0m22:59:19.890215 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m22:59:19.891221 [debug] [MainThread]: On master: COMMIT
[0m22:59:19.891221 [debug] [MainThread]: Using postgres connection "master"
[0m22:59:19.892232 [debug] [MainThread]: On master: COMMIT
[0m22:59:19.901223 [debug] [MainThread]: SQL status: COMMIT in 0.008 seconds
[0m22:59:19.901223 [debug] [MainThread]: On master: Close
[0m22:59:19.902232 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:59:19.903237 [info ] [MainThread]: 
[0m22:59:19.907426 [debug] [Thread-1 (]: Began running node test.its_on_sale.not_null_fact_price_history_id.110f7c1113
[0m22:59:19.907426 [debug] [Thread-2 (]: Began running node test.its_on_sale.not_null_fact_price_history_ts_utc.78d3e6c462
[0m22:59:19.908500 [debug] [Thread-3 (]: Began running node test.its_on_sale.not_null_stg_price_history_id.cb86572049
[0m22:59:19.908500 [debug] [Thread-4 (]: Began running node test.its_on_sale.not_null_stg_price_history_product_id.082361509e
[0m22:59:19.909532 [info ] [Thread-1 (]: 1 of 14 START test not_null_fact_price_history_id .............................. [RUN]
[0m22:59:19.910548 [info ] [Thread-2 (]: 2 of 14 START test not_null_fact_price_history_ts_utc .......................... [RUN]
[0m22:59:19.910548 [info ] [Thread-3 (]: 3 of 14 START test not_null_stg_price_history_id ............................... [RUN]
[0m22:59:19.911553 [info ] [Thread-4 (]: 4 of 14 START test not_null_stg_price_history_product_id ....................... [RUN]
[0m22:59:19.912628 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.its_on_sale.not_null_fact_price_history_id.110f7c1113'
[0m22:59:19.913633 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.its_on_sale.not_null_fact_price_history_ts_utc.78d3e6c462'
[0m22:59:19.913633 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.its_on_sale.not_null_stg_price_history_id.cb86572049'
[0m22:59:19.914653 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.its_on_sale.not_null_stg_price_history_product_id.082361509e'
[0m22:59:19.915660 [debug] [Thread-1 (]: Began compiling node test.its_on_sale.not_null_fact_price_history_id.110f7c1113
[0m22:59:19.915660 [debug] [Thread-2 (]: Began compiling node test.its_on_sale.not_null_fact_price_history_ts_utc.78d3e6c462
[0m22:59:19.916667 [debug] [Thread-3 (]: Began compiling node test.its_on_sale.not_null_stg_price_history_id.cb86572049
[0m22:59:19.917673 [debug] [Thread-4 (]: Began compiling node test.its_on_sale.not_null_stg_price_history_product_id.082361509e
[0m22:59:19.937339 [debug] [Thread-1 (]: Writing injected SQL for node "test.its_on_sale.not_null_fact_price_history_id.110f7c1113"
[0m22:59:19.942829 [debug] [Thread-2 (]: Writing injected SQL for node "test.its_on_sale.not_null_fact_price_history_ts_utc.78d3e6c462"
[0m22:59:19.948872 [debug] [Thread-3 (]: Writing injected SQL for node "test.its_on_sale.not_null_stg_price_history_id.cb86572049"
[0m22:59:19.952897 [debug] [Thread-4 (]: Writing injected SQL for node "test.its_on_sale.not_null_stg_price_history_product_id.082361509e"
[0m22:59:19.955061 [debug] [Thread-1 (]: Began executing node test.its_on_sale.not_null_fact_price_history_id.110f7c1113
[0m22:59:19.955061 [debug] [Thread-2 (]: Began executing node test.its_on_sale.not_null_fact_price_history_ts_utc.78d3e6c462
[0m22:59:19.956064 [debug] [Thread-3 (]: Began executing node test.its_on_sale.not_null_stg_price_history_id.cb86572049
[0m22:59:19.971657 [debug] [Thread-1 (]: Writing runtime sql for node "test.its_on_sale.not_null_fact_price_history_id.110f7c1113"
[0m22:59:19.974686 [debug] [Thread-2 (]: Writing runtime sql for node "test.its_on_sale.not_null_fact_price_history_ts_utc.78d3e6c462"
[0m22:59:19.975690 [debug] [Thread-4 (]: Began executing node test.its_on_sale.not_null_stg_price_history_product_id.082361509e
[0m22:59:19.978700 [debug] [Thread-3 (]: Writing runtime sql for node "test.its_on_sale.not_null_stg_price_history_id.cb86572049"
[0m22:59:19.981724 [debug] [Thread-4 (]: Writing runtime sql for node "test.its_on_sale.not_null_stg_price_history_product_id.082361509e"
[0m22:59:19.982728 [debug] [Thread-1 (]: Using postgres connection "test.its_on_sale.not_null_fact_price_history_id.110f7c1113"
[0m22:59:19.982728 [debug] [Thread-2 (]: Using postgres connection "test.its_on_sale.not_null_fact_price_history_ts_utc.78d3e6c462"
[0m22:59:19.983732 [debug] [Thread-3 (]: Using postgres connection "test.its_on_sale.not_null_stg_price_history_id.cb86572049"
[0m22:59:19.984736 [debug] [Thread-1 (]: On test.its_on_sale.not_null_fact_price_history_id.110f7c1113: BEGIN
[0m22:59:19.984736 [debug] [Thread-2 (]: On test.its_on_sale.not_null_fact_price_history_ts_utc.78d3e6c462: BEGIN
[0m22:59:19.985837 [debug] [Thread-4 (]: Using postgres connection "test.its_on_sale.not_null_stg_price_history_product_id.082361509e"
[0m22:59:19.985837 [debug] [Thread-3 (]: On test.its_on_sale.not_null_stg_price_history_id.cb86572049: BEGIN
[0m22:59:19.986848 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:59:19.986848 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:59:19.987853 [debug] [Thread-4 (]: On test.its_on_sale.not_null_stg_price_history_product_id.082361509e: BEGIN
[0m22:59:19.988871 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:59:19.989874 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:59:20.051896 [debug] [Thread-2 (]: SQL status: BEGIN in 0.064 seconds
[0m22:59:20.052899 [debug] [Thread-2 (]: Using postgres connection "test.its_on_sale.not_null_fact_price_history_ts_utc.78d3e6c462"
[0m22:59:20.052899 [debug] [Thread-2 (]: On test.its_on_sale.not_null_fact_price_history_ts_utc.78d3e6c462: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "node_id": "test.its_on_sale.not_null_fact_price_history_ts_utc.78d3e6c462"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ts_utc
from "neondb"."public_marts"."fact_price_history"
where ts_utc is null



      
    ) dbt_internal_test
[0m22:59:20.056264 [debug] [Thread-1 (]: SQL status: BEGIN in 0.069 seconds
[0m22:59:20.056264 [debug] [Thread-1 (]: Using postgres connection "test.its_on_sale.not_null_fact_price_history_id.110f7c1113"
[0m22:59:20.057267 [debug] [Thread-1 (]: On test.its_on_sale.not_null_fact_price_history_id.110f7c1113: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "node_id": "test.its_on_sale.not_null_fact_price_history_id.110f7c1113"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "neondb"."public_marts"."fact_price_history"
where id is null



      
    ) dbt_internal_test
[0m22:59:20.059404 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "public_marts.fact_price_history" does not exist
LINE 14: from "neondb"."public_marts"."fact_price_history"
              ^

[0m22:59:20.059404 [debug] [Thread-2 (]: On test.its_on_sale.not_null_fact_price_history_ts_utc.78d3e6c462: ROLLBACK
[0m22:59:20.063752 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public_marts.fact_price_history" does not exist
LINE 14: from "neondb"."public_marts"."fact_price_history"
              ^

[0m22:59:20.063752 [debug] [Thread-1 (]: On test.its_on_sale.not_null_fact_price_history_id.110f7c1113: ROLLBACK
[0m22:59:20.064923 [debug] [Thread-4 (]: SQL status: BEGIN in 0.075 seconds
[0m22:59:20.064923 [debug] [Thread-2 (]: On test.its_on_sale.not_null_fact_price_history_ts_utc.78d3e6c462: Close
[0m22:59:20.065931 [debug] [Thread-4 (]: Using postgres connection "test.its_on_sale.not_null_stg_price_history_product_id.082361509e"
[0m22:59:20.066935 [debug] [Thread-4 (]: On test.its_on_sale.not_null_stg_price_history_product_id.082361509e: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "node_id": "test.its_on_sale.not_null_stg_price_history_product_id.082361509e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from "neondb"."public_staging"."stg_price_history"
where product_id is null



      
    ) dbt_internal_test
[0m22:59:20.069950 [debug] [Thread-1 (]: On test.its_on_sale.not_null_fact_price_history_id.110f7c1113: Close
[0m22:59:20.074973 [debug] [Thread-2 (]: Database Error in test not_null_fact_price_history_ts_utc (models\marts\marts.yml)
  relation "public_marts.fact_price_history" does not exist
  LINE 14: from "neondb"."public_marts"."fact_price_history"
                ^
  compiled code at target\run\its_on_sale\models\marts\marts.yml\not_null_fact_price_history_ts_utc.sql
[0m22:59:20.074973 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.007 seconds
[0m22:59:20.075980 [debug] [Thread-3 (]: SQL status: BEGIN in 0.087 seconds
[0m22:59:20.076991 [debug] [Thread-1 (]: Database Error in test not_null_fact_price_history_id (models\marts\marts.yml)
  relation "public_marts.fact_price_history" does not exist
  LINE 14: from "neondb"."public_marts"."fact_price_history"
                ^
  compiled code at target\run\its_on_sale\models\marts\marts.yml\not_null_fact_price_history_id.sql
[0m22:59:20.078055 [error] [Thread-2 (]: 2 of 14 ERROR not_null_fact_price_history_ts_utc ............................... [[31mERROR[0m in 0.17s]
[0m22:59:20.082093 [debug] [Thread-4 (]: On test.its_on_sale.not_null_stg_price_history_product_id.082361509e: ROLLBACK
[0m22:59:20.083098 [debug] [Thread-3 (]: Using postgres connection "test.its_on_sale.not_null_stg_price_history_id.cb86572049"
[0m22:59:20.083098 [error] [Thread-1 (]: 1 of 14 ERROR not_null_fact_price_history_id ................................... [[31mERROR[0m in 0.17s]
[0m22:59:20.084105 [debug] [Thread-2 (]: Finished running node test.its_on_sale.not_null_fact_price_history_ts_utc.78d3e6c462
[0m22:59:20.085110 [debug] [Thread-3 (]: On test.its_on_sale.not_null_stg_price_history_id.cb86572049: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "node_id": "test.its_on_sale.not_null_stg_price_history_id.cb86572049"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "neondb"."public_staging"."stg_price_history"
where id is null



      
    ) dbt_internal_test
[0m22:59:20.086117 [debug] [Thread-1 (]: Finished running node test.its_on_sale.not_null_fact_price_history_id.110f7c1113
[0m22:59:20.087121 [debug] [Thread-2 (]: Began running node test.its_on_sale.not_null_stg_price_history_ts_utc.a6f1e7003a
[0m22:59:20.089132 [debug] [Thread-1 (]: Began running node test.its_on_sale.not_null_stg_product_product_id.5e35fa3f95
[0m22:59:20.089132 [debug] [Thread-4 (]: On test.its_on_sale.not_null_stg_price_history_product_id.082361509e: Close
[0m22:59:20.090141 [info ] [Thread-2 (]: 5 of 14 START test not_null_stg_price_history_ts_utc ........................... [RUN]
[0m22:59:20.091153 [info ] [Thread-1 (]: 6 of 14 START test not_null_stg_product_product_id ............................. [RUN]
[0m22:59:20.092166 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.its_on_sale.not_null_fact_price_history_ts_utc.78d3e6c462, now test.its_on_sale.not_null_stg_price_history_ts_utc.a6f1e7003a)
[0m22:59:20.093337 [info ] [Thread-4 (]: 4 of 14 PASS not_null_stg_price_history_product_id ............................. [[32mPASS[0m in 0.18s]
[0m22:59:20.093337 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.its_on_sale.not_null_fact_price_history_id.110f7c1113, now test.its_on_sale.not_null_stg_product_product_id.5e35fa3f95)
[0m22:59:20.094360 [debug] [Thread-2 (]: Began compiling node test.its_on_sale.not_null_stg_price_history_ts_utc.a6f1e7003a
[0m22:59:20.095365 [debug] [Thread-4 (]: Finished running node test.its_on_sale.not_null_stg_price_history_product_id.082361509e
[0m22:59:20.096372 [debug] [Thread-1 (]: Began compiling node test.its_on_sale.not_null_stg_product_product_id.5e35fa3f95
[0m22:59:20.100394 [debug] [Thread-2 (]: Writing injected SQL for node "test.its_on_sale.not_null_stg_price_history_ts_utc.a6f1e7003a"
[0m22:59:20.101400 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.013 seconds
[0m22:59:20.101400 [debug] [Thread-4 (]: Began running node test.its_on_sale.not_null_stg_product_site.712843232d
[0m22:59:20.106431 [debug] [Thread-1 (]: Writing injected SQL for node "test.its_on_sale.not_null_stg_product_product_id.5e35fa3f95"
[0m22:59:20.109583 [debug] [Thread-3 (]: On test.its_on_sale.not_null_stg_price_history_id.cb86572049: ROLLBACK
[0m22:59:20.110588 [debug] [Thread-2 (]: Began executing node test.its_on_sale.not_null_stg_price_history_ts_utc.a6f1e7003a
[0m22:59:20.111604 [info ] [Thread-4 (]: 7 of 14 START test not_null_stg_product_site ................................... [RUN]
[0m22:59:20.114625 [debug] [Thread-2 (]: Writing runtime sql for node "test.its_on_sale.not_null_stg_price_history_ts_utc.a6f1e7003a"
[0m22:59:20.115630 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.its_on_sale.not_null_stg_price_history_product_id.082361509e, now test.its_on_sale.not_null_stg_product_site.712843232d)
[0m22:59:20.116640 [debug] [Thread-1 (]: Began executing node test.its_on_sale.not_null_stg_product_product_id.5e35fa3f95
[0m22:59:20.117651 [debug] [Thread-4 (]: Began compiling node test.its_on_sale.not_null_stg_product_site.712843232d
[0m22:59:20.117651 [debug] [Thread-2 (]: Using postgres connection "test.its_on_sale.not_null_stg_price_history_ts_utc.a6f1e7003a"
[0m22:59:20.121681 [debug] [Thread-1 (]: Writing runtime sql for node "test.its_on_sale.not_null_stg_product_product_id.5e35fa3f95"
[0m22:59:20.121681 [debug] [Thread-3 (]: On test.its_on_sale.not_null_stg_price_history_id.cb86572049: Close
[0m22:59:20.125818 [debug] [Thread-4 (]: Writing injected SQL for node "test.its_on_sale.not_null_stg_product_site.712843232d"
[0m22:59:20.126829 [debug] [Thread-2 (]: On test.its_on_sale.not_null_stg_price_history_ts_utc.a6f1e7003a: BEGIN
[0m22:59:20.128840 [debug] [Thread-1 (]: Using postgres connection "test.its_on_sale.not_null_stg_product_product_id.5e35fa3f95"
[0m22:59:20.128840 [info ] [Thread-3 (]: 3 of 14 PASS not_null_stg_price_history_id ..................................... [[32mPASS[0m in 0.22s]
[0m22:59:20.129845 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:59:20.130849 [debug] [Thread-4 (]: Began executing node test.its_on_sale.not_null_stg_product_site.712843232d
[0m22:59:20.130849 [debug] [Thread-1 (]: On test.its_on_sale.not_null_stg_product_product_id.5e35fa3f95: BEGIN
[0m22:59:20.131861 [debug] [Thread-3 (]: Finished running node test.its_on_sale.not_null_stg_price_history_id.cb86572049
[0m22:59:20.136903 [debug] [Thread-4 (]: Writing runtime sql for node "test.its_on_sale.not_null_stg_product_site.712843232d"
[0m22:59:20.137911 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:59:20.137911 [debug] [Thread-3 (]: Began running node test.its_on_sale.not_null_stg_product_url.2f8ccdc1e9
[0m22:59:20.140008 [debug] [Thread-4 (]: Using postgres connection "test.its_on_sale.not_null_stg_product_site.712843232d"
[0m22:59:20.140008 [info ] [Thread-3 (]: 8 of 14 START test not_null_stg_product_url .................................... [RUN]
[0m22:59:20.141411 [debug] [Thread-4 (]: On test.its_on_sale.not_null_stg_product_site.712843232d: BEGIN
[0m22:59:20.142420 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.its_on_sale.not_null_stg_price_history_id.cb86572049, now test.its_on_sale.not_null_stg_product_url.2f8ccdc1e9)
[0m22:59:20.143426 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:59:20.143426 [debug] [Thread-3 (]: Began compiling node test.its_on_sale.not_null_stg_product_url.2f8ccdc1e9
[0m22:59:20.148455 [debug] [Thread-3 (]: Writing injected SQL for node "test.its_on_sale.not_null_stg_product_url.2f8ccdc1e9"
[0m22:59:20.149458 [debug] [Thread-3 (]: Began executing node test.its_on_sale.not_null_stg_product_url.2f8ccdc1e9
[0m22:59:20.152479 [debug] [Thread-3 (]: Writing runtime sql for node "test.its_on_sale.not_null_stg_product_url.2f8ccdc1e9"
[0m22:59:20.153489 [debug] [Thread-3 (]: Using postgres connection "test.its_on_sale.not_null_stg_product_url.2f8ccdc1e9"
[0m22:59:20.154572 [debug] [Thread-3 (]: On test.its_on_sale.not_null_stg_product_url.2f8ccdc1e9: BEGIN
[0m22:59:20.155577 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:59:20.184149 [debug] [Thread-2 (]: SQL status: BEGIN in 0.054 seconds
[0m22:59:20.185155 [debug] [Thread-2 (]: Using postgres connection "test.its_on_sale.not_null_stg_price_history_ts_utc.a6f1e7003a"
[0m22:59:20.185155 [debug] [Thread-2 (]: On test.its_on_sale.not_null_stg_price_history_ts_utc.a6f1e7003a: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "node_id": "test.its_on_sale.not_null_stg_price_history_ts_utc.a6f1e7003a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ts_utc
from "neondb"."public_staging"."stg_price_history"
where ts_utc is null



      
    ) dbt_internal_test
[0m22:59:20.191308 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.005 seconds
[0m22:59:20.192384 [debug] [Thread-2 (]: On test.its_on_sale.not_null_stg_price_history_ts_utc.a6f1e7003a: ROLLBACK
[0m22:59:20.198294 [debug] [Thread-2 (]: On test.its_on_sale.not_null_stg_price_history_ts_utc.a6f1e7003a: Close
[0m22:59:20.199317 [info ] [Thread-2 (]: 5 of 14 PASS not_null_stg_price_history_ts_utc ................................. [[32mPASS[0m in 0.11s]
[0m22:59:20.200322 [debug] [Thread-2 (]: Finished running node test.its_on_sale.not_null_stg_price_history_ts_utc.a6f1e7003a
[0m22:59:20.200322 [debug] [Thread-1 (]: SQL status: BEGIN in 0.063 seconds
[0m22:59:20.201452 [debug] [Thread-2 (]: Began running node test.its_on_sale.relationships_fact_price_history_product_id__product_id__ref_stg_product_.42bbec0ccf
[0m22:59:20.201452 [debug] [Thread-1 (]: Using postgres connection "test.its_on_sale.not_null_stg_product_product_id.5e35fa3f95"
[0m22:59:20.202535 [info ] [Thread-2 (]: 9 of 14 START test relationships_fact_price_history_product_id__product_id__ref_stg_product_  [RUN]
[0m22:59:20.203543 [debug] [Thread-1 (]: On test.its_on_sale.not_null_stg_product_product_id.5e35fa3f95: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "node_id": "test.its_on_sale.not_null_stg_product_product_id.5e35fa3f95"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from "neondb"."public_staging"."stg_product"
where product_id is null



      
    ) dbt_internal_test
[0m22:59:20.203543 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.its_on_sale.not_null_stg_price_history_ts_utc.a6f1e7003a, now test.its_on_sale.relationships_fact_price_history_product_id__product_id__ref_stg_product_.42bbec0ccf)
[0m22:59:20.204546 [debug] [Thread-2 (]: Began compiling node test.its_on_sale.relationships_fact_price_history_product_id__product_id__ref_stg_product_.42bbec0ccf
[0m22:59:20.212593 [debug] [Thread-2 (]: Writing injected SQL for node "test.its_on_sale.relationships_fact_price_history_product_id__product_id__ref_stg_product_.42bbec0ccf"
[0m22:59:20.213596 [debug] [Thread-3 (]: SQL status: BEGIN in 0.058 seconds
[0m22:59:20.213596 [debug] [Thread-4 (]: SQL status: BEGIN in 0.071 seconds
[0m22:59:20.214614 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.010 seconds
[0m22:59:20.215622 [debug] [Thread-3 (]: Using postgres connection "test.its_on_sale.not_null_stg_product_url.2f8ccdc1e9"
[0m22:59:20.215622 [debug] [Thread-4 (]: Using postgres connection "test.its_on_sale.not_null_stg_product_site.712843232d"
[0m22:59:20.216699 [debug] [Thread-2 (]: Began executing node test.its_on_sale.relationships_fact_price_history_product_id__product_id__ref_stg_product_.42bbec0ccf
[0m22:59:20.217942 [debug] [Thread-1 (]: On test.its_on_sale.not_null_stg_product_product_id.5e35fa3f95: ROLLBACK
[0m22:59:20.218945 [debug] [Thread-3 (]: On test.its_on_sale.not_null_stg_product_url.2f8ccdc1e9: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "node_id": "test.its_on_sale.not_null_stg_product_url.2f8ccdc1e9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select url
from "neondb"."public_staging"."stg_product"
where url is null



      
    ) dbt_internal_test
[0m22:59:20.219952 [debug] [Thread-4 (]: On test.its_on_sale.not_null_stg_product_site.712843232d: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "node_id": "test.its_on_sale.not_null_stg_product_site.712843232d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select site
from "neondb"."public_staging"."stg_product"
where site is null



      
    ) dbt_internal_test
[0m22:59:20.222972 [debug] [Thread-2 (]: Writing runtime sql for node "test.its_on_sale.relationships_fact_price_history_product_id__product_id__ref_stg_product_.42bbec0ccf"
[0m22:59:20.224980 [debug] [Thread-2 (]: Using postgres connection "test.its_on_sale.relationships_fact_price_history_product_id__product_id__ref_stg_product_.42bbec0ccf"
[0m22:59:20.225983 [debug] [Thread-2 (]: On test.its_on_sale.relationships_fact_price_history_product_id__product_id__ref_stg_product_.42bbec0ccf: BEGIN
[0m22:59:20.225983 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:59:20.230054 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.006 seconds
[0m22:59:20.231058 [debug] [Thread-3 (]: On test.its_on_sale.not_null_stg_product_url.2f8ccdc1e9: ROLLBACK
[0m22:59:20.232199 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.008 seconds
[0m22:59:20.232199 [debug] [Thread-1 (]: On test.its_on_sale.not_null_stg_product_product_id.5e35fa3f95: Close
[0m22:59:20.234208 [debug] [Thread-4 (]: On test.its_on_sale.not_null_stg_product_site.712843232d: ROLLBACK
[0m22:59:20.236221 [debug] [Thread-3 (]: On test.its_on_sale.not_null_stg_product_url.2f8ccdc1e9: Close
[0m22:59:20.236221 [info ] [Thread-1 (]: 6 of 14 PASS not_null_stg_product_product_id ................................... [[32mPASS[0m in 0.14s]
[0m22:59:20.238277 [debug] [Thread-1 (]: Finished running node test.its_on_sale.not_null_stg_product_product_id.5e35fa3f95
[0m22:59:20.237224 [info ] [Thread-3 (]: 8 of 14 PASS not_null_stg_product_url .......................................... [[32mPASS[0m in 0.09s]
[0m22:59:20.239280 [debug] [Thread-1 (]: Began running node test.its_on_sale.relationships_stg_price_history_product_id__product_id__ref_stg_product_.055b801818
[0m22:59:20.240433 [debug] [Thread-3 (]: Finished running node test.its_on_sale.not_null_stg_product_url.2f8ccdc1e9
[0m22:59:20.240433 [debug] [Thread-4 (]: On test.its_on_sale.not_null_stg_product_site.712843232d: Close
[0m22:59:20.241437 [info ] [Thread-1 (]: 10 of 14 START test relationships_stg_price_history_product_id__product_id__ref_stg_product_  [RUN]
[0m22:59:20.241437 [debug] [Thread-3 (]: Began running node test.its_on_sale.unique_fact_price_history_id.0da56e5a2d
[0m22:59:20.243452 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.its_on_sale.not_null_stg_product_product_id.5e35fa3f95, now test.its_on_sale.relationships_stg_price_history_product_id__product_id__ref_stg_product_.055b801818)
[0m22:59:20.243452 [info ] [Thread-4 (]: 7 of 14 PASS not_null_stg_product_site ......................................... [[32mPASS[0m in 0.13s]
[0m22:59:20.244492 [info ] [Thread-3 (]: 11 of 14 START test unique_fact_price_history_id ............................... [RUN]
[0m22:59:20.245504 [debug] [Thread-1 (]: Began compiling node test.its_on_sale.relationships_stg_price_history_product_id__product_id__ref_stg_product_.055b801818
[0m22:59:20.246508 [debug] [Thread-4 (]: Finished running node test.its_on_sale.not_null_stg_product_site.712843232d
[0m22:59:20.247579 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.its_on_sale.not_null_stg_product_url.2f8ccdc1e9, now test.its_on_sale.unique_fact_price_history_id.0da56e5a2d)
[0m22:59:20.253620 [debug] [Thread-1 (]: Writing injected SQL for node "test.its_on_sale.relationships_stg_price_history_product_id__product_id__ref_stg_product_.055b801818"
[0m22:59:20.253620 [debug] [Thread-4 (]: Began running node test.its_on_sale.unique_stg_price_history_id.b6bbfe8a58
[0m22:59:20.254624 [debug] [Thread-3 (]: Began compiling node test.its_on_sale.unique_fact_price_history_id.0da56e5a2d
[0m22:59:20.255640 [info ] [Thread-4 (]: 12 of 14 START test unique_stg_price_history_id ................................ [RUN]
[0m22:59:20.261790 [debug] [Thread-1 (]: Began executing node test.its_on_sale.relationships_stg_price_history_product_id__product_id__ref_stg_product_.055b801818
[0m22:59:20.262981 [debug] [Thread-3 (]: Writing injected SQL for node "test.its_on_sale.unique_fact_price_history_id.0da56e5a2d"
[0m22:59:20.263991 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.its_on_sale.not_null_stg_product_site.712843232d, now test.its_on_sale.unique_stg_price_history_id.b6bbfe8a58)
[0m22:59:20.267005 [debug] [Thread-1 (]: Writing runtime sql for node "test.its_on_sale.relationships_stg_price_history_product_id__product_id__ref_stg_product_.055b801818"
[0m22:59:20.268327 [debug] [Thread-4 (]: Began compiling node test.its_on_sale.unique_stg_price_history_id.b6bbfe8a58
[0m22:59:20.269331 [debug] [Thread-3 (]: Began executing node test.its_on_sale.unique_fact_price_history_id.0da56e5a2d
[0m22:59:20.273568 [debug] [Thread-4 (]: Writing injected SQL for node "test.its_on_sale.unique_stg_price_history_id.b6bbfe8a58"
[0m22:59:20.276599 [debug] [Thread-3 (]: Writing runtime sql for node "test.its_on_sale.unique_fact_price_history_id.0da56e5a2d"
[0m22:59:20.277602 [debug] [Thread-1 (]: Using postgres connection "test.its_on_sale.relationships_stg_price_history_product_id__product_id__ref_stg_product_.055b801818"
[0m22:59:20.279658 [debug] [Thread-4 (]: Began executing node test.its_on_sale.unique_stg_price_history_id.b6bbfe8a58
[0m22:59:20.279658 [debug] [Thread-1 (]: On test.its_on_sale.relationships_stg_price_history_product_id__product_id__ref_stg_product_.055b801818: BEGIN
[0m22:59:20.280658 [debug] [Thread-3 (]: Using postgres connection "test.its_on_sale.unique_fact_price_history_id.0da56e5a2d"
[0m22:59:20.283152 [debug] [Thread-4 (]: Writing runtime sql for node "test.its_on_sale.unique_stg_price_history_id.b6bbfe8a58"
[0m22:59:20.284155 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:59:20.285199 [debug] [Thread-3 (]: On test.its_on_sale.unique_fact_price_history_id.0da56e5a2d: BEGIN
[0m22:59:20.286205 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:59:20.287209 [debug] [Thread-4 (]: Using postgres connection "test.its_on_sale.unique_stg_price_history_id.b6bbfe8a58"
[0m22:59:20.288356 [debug] [Thread-4 (]: On test.its_on_sale.unique_stg_price_history_id.b6bbfe8a58: BEGIN
[0m22:59:20.288356 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:59:20.289379 [debug] [Thread-2 (]: SQL status: BEGIN in 0.063 seconds
[0m22:59:20.290384 [debug] [Thread-2 (]: Using postgres connection "test.its_on_sale.relationships_fact_price_history_product_id__product_id__ref_stg_product_.42bbec0ccf"
[0m22:59:20.290384 [debug] [Thread-2 (]: On test.its_on_sale.relationships_fact_price_history_product_id__product_id__ref_stg_product_.42bbec0ccf: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "node_id": "test.its_on_sale.relationships_fact_price_history_product_id__product_id__ref_stg_product_.42bbec0ccf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_id as from_field
    from "neondb"."public_marts"."fact_price_history"
    where product_id is not null
),

parent as (
    select product_id as to_field
    from "neondb"."public_staging"."stg_product"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m22:59:20.297598 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "public_marts.fact_price_history" does not exist
LINE 13:     from "neondb"."public_marts"."fact_price_history"
                  ^

[0m22:59:20.297598 [debug] [Thread-2 (]: On test.its_on_sale.relationships_fact_price_history_product_id__product_id__ref_stg_product_.42bbec0ccf: ROLLBACK
[0m22:59:20.308882 [debug] [Thread-2 (]: On test.its_on_sale.relationships_fact_price_history_product_id__product_id__ref_stg_product_.42bbec0ccf: Close
[0m22:59:20.312072 [debug] [Thread-2 (]: Database Error in test relationships_fact_price_history_product_id__product_id__ref_stg_product_ (models\marts\marts.yml)
  relation "public_marts.fact_price_history" does not exist
  LINE 13:     from "neondb"."public_marts"."fact_price_history"
                    ^
  compiled code at target\run\its_on_sale\models\marts\marts.yml\relationships_fact_price_histo_850030980a5b931f9742074e40b00449.sql
[0m22:59:20.313082 [error] [Thread-2 (]: 9 of 14 ERROR relationships_fact_price_history_product_id__product_id__ref_stg_product_  [[31mERROR[0m in 0.11s]
[0m22:59:20.314085 [debug] [Thread-2 (]: Finished running node test.its_on_sale.relationships_fact_price_history_product_id__product_id__ref_stg_product_.42bbec0ccf
[0m22:59:20.315138 [debug] [Thread-2 (]: Began running node test.its_on_sale.unique_stg_product_product_id.fd1037e514
[0m22:59:20.315138 [info ] [Thread-2 (]: 13 of 14 START test unique_stg_product_product_id .............................. [RUN]
[0m22:59:20.316141 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.its_on_sale.relationships_fact_price_history_product_id__product_id__ref_stg_product_.42bbec0ccf, now test.its_on_sale.unique_stg_product_product_id.fd1037e514)
[0m22:59:20.316141 [debug] [Thread-2 (]: Began compiling node test.its_on_sale.unique_stg_product_product_id.fd1037e514
[0m22:59:20.321334 [debug] [Thread-2 (]: Writing injected SQL for node "test.its_on_sale.unique_stg_product_product_id.fd1037e514"
[0m22:59:20.322341 [debug] [Thread-2 (]: Began executing node test.its_on_sale.unique_stg_product_product_id.fd1037e514
[0m22:59:20.327629 [debug] [Thread-2 (]: Writing runtime sql for node "test.its_on_sale.unique_stg_product_product_id.fd1037e514"
[0m22:59:20.328654 [debug] [Thread-2 (]: Using postgres connection "test.its_on_sale.unique_stg_product_product_id.fd1037e514"
[0m22:59:20.329989 [debug] [Thread-2 (]: On test.its_on_sale.unique_stg_product_product_id.fd1037e514: BEGIN
[0m22:59:20.329989 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:59:20.344334 [debug] [Thread-3 (]: SQL status: BEGIN in 0.058 seconds
[0m22:59:20.345334 [debug] [Thread-3 (]: Using postgres connection "test.its_on_sale.unique_fact_price_history_id.0da56e5a2d"
[0m22:59:20.345334 [debug] [Thread-3 (]: On test.its_on_sale.unique_fact_price_history_id.0da56e5a2d: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "node_id": "test.its_on_sale.unique_fact_price_history_id.0da56e5a2d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "neondb"."public_marts"."fact_price_history"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:59:20.351579 [debug] [Thread-1 (]: SQL status: BEGIN in 0.067 seconds
[0m22:59:20.351579 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "public_marts.fact_price_history" does not exist
LINE 15: from "neondb"."public_marts"."fact_price_history"
              ^

[0m22:59:20.352581 [debug] [Thread-1 (]: Using postgres connection "test.its_on_sale.relationships_stg_price_history_product_id__product_id__ref_stg_product_.055b801818"
[0m22:59:20.353585 [debug] [Thread-3 (]: On test.its_on_sale.unique_fact_price_history_id.0da56e5a2d: ROLLBACK
[0m22:59:20.353585 [debug] [Thread-1 (]: On test.its_on_sale.relationships_stg_price_history_product_id__product_id__ref_stg_product_.055b801818: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "node_id": "test.its_on_sale.relationships_stg_price_history_product_id__product_id__ref_stg_product_.055b801818"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_id as from_field
    from "neondb"."public_staging"."stg_price_history"
    where product_id is not null
),

parent as (
    select product_id as to_field
    from "neondb"."public_staging"."stg_product"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m22:59:20.358536 [debug] [Thread-3 (]: On test.its_on_sale.unique_fact_price_history_id.0da56e5a2d: Close
[0m22:59:20.358536 [debug] [Thread-4 (]: SQL status: BEGIN in 0.070 seconds
[0m22:59:20.360547 [debug] [Thread-4 (]: Using postgres connection "test.its_on_sale.unique_stg_price_history_id.b6bbfe8a58"
[0m22:59:20.361552 [debug] [Thread-4 (]: On test.its_on_sale.unique_stg_price_history_id.b6bbfe8a58: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "node_id": "test.its_on_sale.unique_stg_price_history_id.b6bbfe8a58"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "neondb"."public_staging"."stg_price_history"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:59:20.362563 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m22:59:20.363567 [debug] [Thread-3 (]: Database Error in test unique_fact_price_history_id (models\marts\marts.yml)
  relation "public_marts.fact_price_history" does not exist
  LINE 15: from "neondb"."public_marts"."fact_price_history"
                ^
  compiled code at target\run\its_on_sale\models\marts\marts.yml\unique_fact_price_history_id.sql
[0m22:59:20.365594 [debug] [Thread-1 (]: On test.its_on_sale.relationships_stg_price_history_product_id__product_id__ref_stg_product_.055b801818: ROLLBACK
[0m22:59:20.366598 [error] [Thread-3 (]: 11 of 14 ERROR unique_fact_price_history_id .................................... [[31mERROR[0m in 0.12s]
[0m22:59:20.367602 [debug] [Thread-3 (]: Finished running node test.its_on_sale.unique_fact_price_history_id.0da56e5a2d
[0m22:59:20.367602 [debug] [Thread-3 (]: Began running node test.its_on_sale.unique_stg_product_url.35c93a6d66
[0m22:59:20.368613 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.006 seconds
[0m22:59:20.368613 [info ] [Thread-3 (]: 14 of 14 START test unique_stg_product_url ..................................... [RUN]
[0m22:59:20.370664 [debug] [Thread-4 (]: On test.its_on_sale.unique_stg_price_history_id.b6bbfe8a58: ROLLBACK
[0m22:59:20.370664 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.its_on_sale.unique_fact_price_history_id.0da56e5a2d, now test.its_on_sale.unique_stg_product_url.35c93a6d66)
[0m22:59:20.371766 [debug] [Thread-3 (]: Began compiling node test.its_on_sale.unique_stg_product_url.35c93a6d66
[0m22:59:20.376804 [debug] [Thread-3 (]: Writing injected SQL for node "test.its_on_sale.unique_stg_product_url.35c93a6d66"
[0m22:59:20.376804 [debug] [Thread-1 (]: On test.its_on_sale.relationships_stg_price_history_product_id__product_id__ref_stg_product_.055b801818: Close
[0m22:59:20.377809 [debug] [Thread-4 (]: On test.its_on_sale.unique_stg_price_history_id.b6bbfe8a58: Close
[0m22:59:20.378828 [debug] [Thread-3 (]: Began executing node test.its_on_sale.unique_stg_product_url.35c93a6d66
[0m22:59:20.378828 [info ] [Thread-1 (]: 10 of 14 PASS relationships_stg_price_history_product_id__product_id__ref_stg_product_  [[32mPASS[0m in 0.14s]
[0m22:59:20.379833 [info ] [Thread-4 (]: 12 of 14 PASS unique_stg_price_history_id ...................................... [[32mPASS[0m in 0.12s]
[0m22:59:20.382911 [debug] [Thread-3 (]: Writing runtime sql for node "test.its_on_sale.unique_stg_product_url.35c93a6d66"
[0m22:59:20.383917 [debug] [Thread-2 (]: SQL status: BEGIN in 0.053 seconds
[0m22:59:20.383917 [debug] [Thread-1 (]: Finished running node test.its_on_sale.relationships_stg_price_history_product_id__product_id__ref_stg_product_.055b801818
[0m22:59:20.384920 [debug] [Thread-4 (]: Finished running node test.its_on_sale.unique_stg_price_history_id.b6bbfe8a58
[0m22:59:20.385928 [debug] [Thread-2 (]: Using postgres connection "test.its_on_sale.unique_stg_product_product_id.fd1037e514"
[0m22:59:20.387049 [debug] [Thread-3 (]: Using postgres connection "test.its_on_sale.unique_stg_product_url.35c93a6d66"
[0m22:59:20.388054 [debug] [Thread-2 (]: On test.its_on_sale.unique_stg_product_product_id.fd1037e514: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "node_id": "test.its_on_sale.unique_stg_product_product_id.fd1037e514"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "neondb"."public_staging"."stg_product"
where product_id is not null
group by product_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:59:20.389066 [debug] [Thread-3 (]: On test.its_on_sale.unique_stg_product_url.35c93a6d66: BEGIN
[0m22:59:20.390070 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:59:20.396177 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.006 seconds
[0m22:59:20.397182 [debug] [Thread-2 (]: On test.its_on_sale.unique_stg_product_product_id.fd1037e514: ROLLBACK
[0m22:59:20.403144 [debug] [Thread-2 (]: On test.its_on_sale.unique_stg_product_product_id.fd1037e514: Close
[0m22:59:20.404152 [info ] [Thread-2 (]: 13 of 14 PASS unique_stg_product_product_id .................................... [[32mPASS[0m in 0.09s]
[0m22:59:20.406166 [debug] [Thread-2 (]: Finished running node test.its_on_sale.unique_stg_product_product_id.fd1037e514
[0m22:59:20.449886 [debug] [Thread-3 (]: SQL status: BEGIN in 0.060 seconds
[0m22:59:20.450892 [debug] [Thread-3 (]: Using postgres connection "test.its_on_sale.unique_stg_product_url.35c93a6d66"
[0m22:59:20.450892 [debug] [Thread-3 (]: On test.its_on_sale.unique_stg_product_url.35c93a6d66: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "node_id": "test.its_on_sale.unique_stg_product_url.35c93a6d66"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    url as unique_field,
    count(*) as n_records

from "neondb"."public_staging"."stg_product"
where url is not null
group by url
having count(*) > 1



      
    ) dbt_internal_test
[0m22:59:20.458355 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.007 seconds
[0m22:59:20.459359 [debug] [Thread-3 (]: On test.its_on_sale.unique_stg_product_url.35c93a6d66: ROLLBACK
[0m22:59:20.466211 [debug] [Thread-3 (]: On test.its_on_sale.unique_stg_product_url.35c93a6d66: Close
[0m22:59:20.467215 [info ] [Thread-3 (]: 14 of 14 PASS unique_stg_product_url ........................................... [[32mPASS[0m in 0.10s]
[0m22:59:20.468225 [debug] [Thread-3 (]: Finished running node test.its_on_sale.unique_stg_product_url.35c93a6d66
[0m22:59:20.470251 [debug] [MainThread]: Using postgres connection "master"
[0m22:59:20.470251 [debug] [MainThread]: On master: BEGIN
[0m22:59:20.471256 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:59:20.522716 [debug] [MainThread]: SQL status: BEGIN in 0.051 seconds
[0m22:59:20.522716 [debug] [MainThread]: On master: COMMIT
[0m22:59:20.523718 [debug] [MainThread]: Using postgres connection "master"
[0m22:59:20.523718 [debug] [MainThread]: On master: COMMIT
[0m22:59:20.530880 [debug] [MainThread]: SQL status: COMMIT in 0.006 seconds
[0m22:59:20.530880 [debug] [MainThread]: On master: Close
[0m22:59:20.531884 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:59:20.532889 [debug] [MainThread]: Connection 'list_neondb_public_marts' was properly closed.
[0m22:59:20.532889 [debug] [MainThread]: Connection 'list_neondb_public_staging' was properly closed.
[0m22:59:20.532889 [debug] [MainThread]: Connection 'test.its_on_sale.relationships_stg_price_history_product_id__product_id__ref_stg_product_.055b801818' was properly closed.
[0m22:59:20.533895 [debug] [MainThread]: Connection 'test.its_on_sale.unique_stg_product_product_id.fd1037e514' was properly closed.
[0m22:59:20.533895 [debug] [MainThread]: Connection 'test.its_on_sale.unique_stg_product_url.35c93a6d66' was properly closed.
[0m22:59:20.534902 [debug] [MainThread]: Connection 'test.its_on_sale.unique_stg_price_history_id.b6bbfe8a58' was properly closed.
[0m22:59:20.534902 [info ] [MainThread]: 
[0m22:59:20.535913 [info ] [MainThread]: Finished running 14 data tests in 0 hours 0 minutes and 1.05 seconds (1.05s).
[0m22:59:20.538929 [debug] [MainThread]: Command end result
[0m22:59:20.574632 [info ] [MainThread]: 
[0m22:59:20.576652 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m22:59:20.577660 [info ] [MainThread]: 
[0m22:59:20.577660 [error] [MainThread]:   Database Error in test not_null_fact_price_history_ts_utc (models\marts\marts.yml)
  relation "public_marts.fact_price_history" does not exist
  LINE 14: from "neondb"."public_marts"."fact_price_history"
                ^
  compiled code at target\run\its_on_sale\models\marts\marts.yml\not_null_fact_price_history_ts_utc.sql
[0m22:59:20.578667 [info ] [MainThread]: 
[0m22:59:20.578667 [error] [MainThread]:   Database Error in test not_null_fact_price_history_id (models\marts\marts.yml)
  relation "public_marts.fact_price_history" does not exist
  LINE 14: from "neondb"."public_marts"."fact_price_history"
                ^
  compiled code at target\run\its_on_sale\models\marts\marts.yml\not_null_fact_price_history_id.sql
[0m22:59:20.579674 [info ] [MainThread]: 
[0m22:59:20.580685 [error] [MainThread]:   Database Error in test relationships_fact_price_history_product_id__product_id__ref_stg_product_ (models\marts\marts.yml)
  relation "public_marts.fact_price_history" does not exist
  LINE 13:     from "neondb"."public_marts"."fact_price_history"
                    ^
  compiled code at target\run\its_on_sale\models\marts\marts.yml\relationships_fact_price_histo_850030980a5b931f9742074e40b00449.sql
[0m22:59:20.580685 [info ] [MainThread]: 
[0m22:59:20.581693 [error] [MainThread]:   Database Error in test unique_fact_price_history_id (models\marts\marts.yml)
  relation "public_marts.fact_price_history" does not exist
  LINE 15: from "neondb"."public_marts"."fact_price_history"
                ^
  compiled code at target\run\its_on_sale\models\marts\marts.yml\unique_fact_price_history_id.sql
[0m22:59:20.582698 [info ] [MainThread]: 
[0m22:59:20.582698 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=4 SKIP=0 TOTAL=14
[0m22:59:20.584715 [debug] [MainThread]: Command `dbt test` failed at 22:59:20.584715 after 1.79 seconds
[0m22:59:20.585719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E78AA0D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E78AA0CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E012E9D90>]}
[0m22:59:20.585719 [debug] [MainThread]: Flushing usage events
[0m23:01:09.638012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD05902D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD06902F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD056ED090>]}


============================== 23:01:09.642498 | 3e677517-d134-489b-9c1d-428b4809d32e ==============================
[0m23:01:09.642498 [info ] [MainThread]: Running with dbt=1.8.8
[0m23:01:09.643505 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '..\\', 'log_path': "C:\\Users\\meg\\Documents\\cam\\proj\\It's On Sale\\its-on-sale-tracker\\pipeline\\transform\\its_on_sale\\logs", 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select fact_price_history --profiles-dir ..\\', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:01:09.877088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e677517-d134-489b-9c1d-428b4809d32e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD06A251D0>]}
[0m23:01:09.933359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e677517-d134-489b-9c1d-428b4809d32e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD02940790>]}
[0m23:01:09.935365 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:01:09.945611 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m23:01:10.121398 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:01:10.121398 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:01:10.159857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e677517-d134-489b-9c1d-428b4809d32e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD06AB1B10>]}
[0m23:01:10.266038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e677517-d134-489b-9c1d-428b4809d32e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD06A577D0>]}
[0m23:01:10.267043 [info ] [MainThread]: Found 3 models, 14 data tests, 423 macros
[0m23:01:10.268047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e677517-d134-489b-9c1d-428b4809d32e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD06A1F750>]}
[0m23:01:10.269050 [warn ] [MainThread]: The selection criterion 'fact_price_history' does not match any enabled nodes
[0m23:01:10.270071 [info ] [MainThread]: 
[0m23:01:10.271080 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:01:10.273135 [debug] [MainThread]: Command end result
[0m23:01:10.305834 [debug] [MainThread]: Command `dbt run` succeeded at 23:01:10.305834 after 0.74 seconds
[0m23:01:10.305834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD056EC850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD06AA7750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD05903F90>]}
[0m23:01:10.306837 [debug] [MainThread]: Flushing usage events
[0m23:02:14.987939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017972F70910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017972F6F350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017972F6FF50>]}


============================== 23:02:14.993228 | a0161f41-5479-4589-8609-5bdcb0df482d ==============================
[0m23:02:14.993228 [info ] [MainThread]: Running with dbt=1.8.8
[0m23:02:14.994228 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '..\\', 'log_path': "C:\\Users\\meg\\Documents\\cam\\proj\\It's On Sale\\its-on-sale-tracker\\pipeline\\transform\\its_on_sale\\logs", 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt ls --select fact_price_history --profiles-dir ..\\', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:02:15.222713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a0161f41-5479-4589-8609-5bdcb0df482d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017973FB5FD0>]}
[0m23:02:15.277373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a0161f41-5479-4589-8609-5bdcb0df482d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001796FFC4D10>]}
[0m23:02:15.279409 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:02:15.289752 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m23:02:15.471473 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:02:15.472528 [debug] [MainThread]: Partial parsing: updated file: its_on_sale://models\marts\fact_price_history.sql
[0m23:02:15.681482 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m23:02:15.682487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a0161f41-5479-4589-8609-5bdcb0df482d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017973FA14D0>]}
[0m23:02:15.923249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a0161f41-5479-4589-8609-5bdcb0df482d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017974505850>]}
[0m23:02:16.039378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a0161f41-5479-4589-8609-5bdcb0df482d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017973FB7E50>]}
[0m23:02:16.040427 [info ] [MainThread]: Found 3 models, 14 data tests, 423 macros
[0m23:02:16.040427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0161f41-5479-4589-8609-5bdcb0df482d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179740C5490>]}
[0m23:02:16.042943 [debug] [MainThread]: Command `dbt ls` succeeded at 23:02:16.042943 after 1.13 seconds
[0m23:02:16.042943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001796B790F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001797043AE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001796B4C2FD0>]}
[0m23:02:16.043943 [debug] [MainThread]: Flushing usage events
[0m23:02:20.561113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000147A5B33B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000147A591CE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000147A5B33F50>]}


============================== 23:02:20.565496 | 9b69d3d1-4247-47ad-aa7b-be822a462249 ==============================
[0m23:02:20.565496 [info ] [MainThread]: Running with dbt=1.8.8
[0m23:02:20.566504 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '..\\', 'debug': 'False', 'fail_fast': 'False', 'log_path': "C:\\Users\\meg\\Documents\\cam\\proj\\It's On Sale\\its-on-sale-tracker\\pipeline\\transform\\its_on_sale\\logs", 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt compile --select fact_price_history --profiles-dir ..\\', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:02:20.789555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9b69d3d1-4247-47ad-aa7b-be822a462249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000147A6BE9B90>]}
[0m23:02:20.841752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9b69d3d1-4247-47ad-aa7b-be822a462249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000147A2B84290>]}
[0m23:02:20.843752 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:02:20.853803 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m23:02:21.036146 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:02:21.037200 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:02:21.074619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9b69d3d1-4247-47ad-aa7b-be822a462249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000147A6E78510>]}
[0m23:02:21.176738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9b69d3d1-4247-47ad-aa7b-be822a462249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000147A6C4A2D0>]}
[0m23:02:21.177741 [info ] [MainThread]: Found 3 models, 14 data tests, 423 macros
[0m23:02:21.177741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b69d3d1-4247-47ad-aa7b-be822a462249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000147A6D31F90>]}
[0m23:02:21.180201 [info ] [MainThread]: 
[0m23:02:21.181205 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:02:21.185231 [debug] [ThreadPool]: Acquiring new postgres connection 'list_neondb_public_marts'
[0m23:02:21.186235 [debug] [ThreadPool]: Acquiring new postgres connection 'list_neondb_public_staging'
[0m23:02:21.385448 [debug] [ThreadPool]: Using postgres connection "list_neondb_public_marts"
[0m23:02:21.385448 [debug] [ThreadPool]: Using postgres connection "list_neondb_public_staging"
[0m23:02:21.386455 [debug] [ThreadPool]: On list_neondb_public_marts: BEGIN
[0m23:02:21.386455 [debug] [ThreadPool]: On list_neondb_public_staging: BEGIN
[0m23:02:21.387460 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:02:21.387460 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:02:21.493360 [debug] [ThreadPool]: SQL status: BEGIN in 0.106 seconds
[0m23:02:21.493360 [debug] [ThreadPool]: Using postgres connection "list_neondb_public_marts"
[0m23:02:21.494362 [debug] [ThreadPool]: On list_neondb_public_marts: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "connection_name": "list_neondb_public_marts"} */
select
      'neondb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'neondb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'neondb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m23:02:21.501149 [debug] [ThreadPool]: SQL status: BEGIN in 0.113 seconds
[0m23:02:21.501149 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m23:02:21.502157 [debug] [ThreadPool]: Using postgres connection "list_neondb_public_staging"
[0m23:02:21.503168 [debug] [ThreadPool]: On list_neondb_public_marts: ROLLBACK
[0m23:02:21.504175 [debug] [ThreadPool]: On list_neondb_public_staging: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "connection_name": "list_neondb_public_staging"} */
select
      'neondb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'neondb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'neondb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m23:02:21.510535 [debug] [ThreadPool]: On list_neondb_public_marts: Close
[0m23:02:21.512575 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.008 seconds
[0m23:02:21.513582 [debug] [ThreadPool]: On list_neondb_public_staging: ROLLBACK
[0m23:02:21.520393 [debug] [ThreadPool]: On list_neondb_public_staging: Close
[0m23:02:21.525439 [debug] [MainThread]: Using postgres connection "master"
[0m23:02:21.525439 [debug] [MainThread]: On master: BEGIN
[0m23:02:21.526442 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:02:21.604071 [debug] [MainThread]: SQL status: BEGIN in 0.077 seconds
[0m23:02:21.604071 [debug] [MainThread]: Using postgres connection "master"
[0m23:02:21.605074 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:02:21.612764 [debug] [MainThread]: SQL status: SELECT 2 in 0.007 seconds
[0m23:02:21.613787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b69d3d1-4247-47ad-aa7b-be822a462249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000147A6C9C890>]}
[0m23:02:21.614807 [debug] [MainThread]: On master: ROLLBACK
[0m23:02:21.621351 [debug] [MainThread]: On master: Close
[0m23:02:21.621351 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:02:21.622366 [info ] [MainThread]: 
[0m23:02:21.626050 [debug] [Thread-1 (]: Began running node model.its_on_sale.fact_price_history
[0m23:02:21.627112 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.its_on_sale.fact_price_history'
[0m23:02:21.628127 [debug] [Thread-1 (]: Began compiling node model.its_on_sale.fact_price_history
[0m23:02:21.636313 [debug] [Thread-1 (]: Writing injected SQL for node "model.its_on_sale.fact_price_history"
[0m23:02:21.637319 [debug] [Thread-1 (]: Began executing node model.its_on_sale.fact_price_history
[0m23:02:21.638334 [debug] [Thread-1 (]: Finished running node model.its_on_sale.fact_price_history
[0m23:02:21.639365 [debug] [Thread-3 (]: Began running node test.its_on_sale.not_null_fact_price_history_id.110f7c1113
[0m23:02:21.640587 [debug] [Thread-4 (]: Began running node test.its_on_sale.not_null_fact_price_history_ts_utc.78d3e6c462
[0m23:02:21.640587 [debug] [Thread-2 (]: Began running node test.its_on_sale.relationships_fact_price_history_product_id__product_id__ref_stg_product_.42bbec0ccf
[0m23:02:21.641587 [debug] [Thread-1 (]: Began running node test.its_on_sale.unique_fact_price_history_id.0da56e5a2d
[0m23:02:21.641587 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.its_on_sale.not_null_fact_price_history_id.110f7c1113'
[0m23:02:21.642681 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.its_on_sale.not_null_fact_price_history_ts_utc.78d3e6c462'
[0m23:02:21.643688 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.its_on_sale.relationships_fact_price_history_product_id__product_id__ref_stg_product_.42bbec0ccf'
[0m23:02:21.644691 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.its_on_sale.fact_price_history, now test.its_on_sale.unique_fact_price_history_id.0da56e5a2d)
[0m23:02:21.645806 [debug] [Thread-3 (]: Began compiling node test.its_on_sale.not_null_fact_price_history_id.110f7c1113
[0m23:02:21.645806 [debug] [Thread-4 (]: Began compiling node test.its_on_sale.not_null_fact_price_history_ts_utc.78d3e6c462
[0m23:02:21.647020 [debug] [Thread-2 (]: Began compiling node test.its_on_sale.relationships_fact_price_history_product_id__product_id__ref_stg_product_.42bbec0ccf
[0m23:02:21.647020 [debug] [Thread-1 (]: Began compiling node test.its_on_sale.unique_fact_price_history_id.0da56e5a2d
[0m23:02:21.659509 [debug] [Thread-3 (]: Writing injected SQL for node "test.its_on_sale.not_null_fact_price_history_id.110f7c1113"
[0m23:02:21.664633 [debug] [Thread-4 (]: Writing injected SQL for node "test.its_on_sale.not_null_fact_price_history_ts_utc.78d3e6c462"
[0m23:02:21.672753 [debug] [Thread-2 (]: Writing injected SQL for node "test.its_on_sale.relationships_fact_price_history_product_id__product_id__ref_stg_product_.42bbec0ccf"
[0m23:02:21.679806 [debug] [Thread-1 (]: Writing injected SQL for node "test.its_on_sale.unique_fact_price_history_id.0da56e5a2d"
[0m23:02:21.680812 [debug] [Thread-3 (]: Began executing node test.its_on_sale.not_null_fact_price_history_id.110f7c1113
[0m23:02:21.681815 [debug] [Thread-4 (]: Began executing node test.its_on_sale.not_null_fact_price_history_ts_utc.78d3e6c462
[0m23:02:21.682879 [debug] [Thread-3 (]: Finished running node test.its_on_sale.not_null_fact_price_history_id.110f7c1113
[0m23:02:21.682879 [debug] [Thread-2 (]: Began executing node test.its_on_sale.relationships_fact_price_history_product_id__product_id__ref_stg_product_.42bbec0ccf
[0m23:02:21.683888 [debug] [Thread-1 (]: Began executing node test.its_on_sale.unique_fact_price_history_id.0da56e5a2d
[0m23:02:21.684908 [debug] [Thread-4 (]: Finished running node test.its_on_sale.not_null_fact_price_history_ts_utc.78d3e6c462
[0m23:02:21.685913 [debug] [Thread-2 (]: Finished running node test.its_on_sale.relationships_fact_price_history_product_id__product_id__ref_stg_product_.42bbec0ccf
[0m23:02:21.686917 [debug] [Thread-1 (]: Finished running node test.its_on_sale.unique_fact_price_history_id.0da56e5a2d
[0m23:02:21.688926 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:02:21.688926 [debug] [MainThread]: Connection 'list_neondb_public_marts' was properly closed.
[0m23:02:21.689932 [debug] [MainThread]: Connection 'list_neondb_public_staging' was properly closed.
[0m23:02:21.689932 [debug] [MainThread]: Connection 'test.its_on_sale.unique_fact_price_history_id.0da56e5a2d' was properly closed.
[0m23:02:21.691039 [debug] [MainThread]: Connection 'test.its_on_sale.not_null_fact_price_history_id.110f7c1113' was properly closed.
[0m23:02:21.691039 [debug] [MainThread]: Connection 'test.its_on_sale.not_null_fact_price_history_ts_utc.78d3e6c462' was properly closed.
[0m23:02:21.692043 [debug] [MainThread]: Connection 'test.its_on_sale.relationships_fact_price_history_product_id__product_id__ref_stg_product_.42bbec0ccf' was properly closed.
[0m23:02:21.693050 [debug] [MainThread]: Command end result
[0m23:02:21.729526 [debug] [MainThread]: Excluded node 'not_null_fact_price_history_id' from results
[0m23:02:21.730554 [debug] [MainThread]: Excluded node 'not_null_fact_price_history_ts_utc' from results
[0m23:02:21.730554 [debug] [MainThread]: Excluded node 'relationships_fact_price_history_product_id__product_id__ref_stg_product_' from results
[0m23:02:21.731563 [debug] [MainThread]: Excluded node 'unique_fact_price_history_id' from results
[0m23:02:21.731563 [info ] [MainThread]: Compiled node 'fact_price_history' is:
-- Fact table for price time series

select
  ph.id,
  ph.product_id,
  p.site,
  p.url,
  p.name,
  ph.ts_utc,
  ph.price,
  ph.currency,
  ph.in_stock,
  ph.on_sale
from "neondb"."public_staging"."stg_price_history" ph
join "neondb"."public_staging"."stg_product" p
  on p.product_id = ph.product_id
[0m23:02:21.733625 [debug] [MainThread]: Command `dbt compile` succeeded at 23:02:21.733625 after 1.24 seconds
[0m23:02:21.734629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000147A589D3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001479E072FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001479E072D90>]}
[0m23:02:21.734629 [debug] [MainThread]: Flushing usage events
[0m23:02:45.844344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D6592E1190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D65A2FACD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D65A2F9850>]}


============================== 23:02:45.849385 | 5af1a79d-abad-435c-bacc-82311a982078 ==============================
[0m23:02:45.849385 [info ] [MainThread]: Running with dbt=1.8.8
[0m23:02:45.850388 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': "C:\\Users\\meg\\Documents\\cam\\proj\\It's On Sale\\its-on-sale-tracker\\pipeline\\transform\\its_on_sale\\logs", 'profiles_dir': '..\\', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir ..\\', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:02:46.075430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5af1a79d-abad-435c-bacc-82311a982078', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D6590CC850>]}
[0m23:02:46.129270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5af1a79d-abad-435c-bacc-82311a982078', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D65633CA50>]}
[0m23:02:46.131279 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:02:46.141292 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m23:02:46.313277 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:02:46.313277 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:02:46.351906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5af1a79d-abad-435c-bacc-82311a982078', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D65A57C790>]}
[0m23:02:46.464992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5af1a79d-abad-435c-bacc-82311a982078', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D65A435350>]}
[0m23:02:46.466064 [info ] [MainThread]: Found 3 models, 14 data tests, 423 macros
[0m23:02:46.466064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5af1a79d-abad-435c-bacc-82311a982078', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D65A55D790>]}
[0m23:02:46.469082 [info ] [MainThread]: 
[0m23:02:46.470086 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:02:46.475121 [debug] [ThreadPool]: Acquiring new postgres connection 'list_neondb'
[0m23:02:46.475121 [debug] [ThreadPool]: Acquiring new postgres connection 'list_neondb'
[0m23:02:46.670483 [debug] [ThreadPool]: Using postgres connection "list_neondb"
[0m23:02:46.670483 [debug] [ThreadPool]: Using postgres connection "list_neondb"
[0m23:02:46.671487 [debug] [ThreadPool]: On list_neondb: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "connection_name": "list_neondb"} */

    select distinct nspname from pg_namespace
  
[0m23:02:46.671487 [debug] [ThreadPool]: On list_neondb: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "connection_name": "list_neondb"} */

    select distinct nspname from pg_namespace
  
[0m23:02:46.672493 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:02:46.672493 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:02:46.768434 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.096 seconds
[0m23:02:46.769444 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.096 seconds
[0m23:02:46.770450 [debug] [ThreadPool]: On list_neondb: Close
[0m23:02:46.771455 [debug] [ThreadPool]: On list_neondb: Close
[0m23:02:46.772461 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_neondb, now create_neondb_public_marts)
[0m23:02:46.773518 [debug] [ThreadPool]: Creating schema "database: "neondb"
schema: "public_marts"
"
[0m23:02:46.779519 [debug] [ThreadPool]: Using postgres connection "create_neondb_public_marts"
[0m23:02:46.779519 [debug] [ThreadPool]: On create_neondb_public_marts: BEGIN
[0m23:02:46.780519 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:02:46.837786 [debug] [ThreadPool]: SQL status: BEGIN in 0.058 seconds
[0m23:02:46.838795 [debug] [ThreadPool]: Using postgres connection "create_neondb_public_marts"
[0m23:02:46.839816 [debug] [ThreadPool]: On create_neondb_public_marts: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "connection_name": "create_neondb_public_marts"} */
create schema if not exists "public_marts"
[0m23:02:46.845750 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.005 seconds
[0m23:02:46.846756 [debug] [ThreadPool]: On create_neondb_public_marts: COMMIT
[0m23:02:46.846756 [debug] [ThreadPool]: Using postgres connection "create_neondb_public_marts"
[0m23:02:46.847760 [debug] [ThreadPool]: On create_neondb_public_marts: COMMIT
[0m23:02:46.854752 [debug] [ThreadPool]: SQL status: COMMIT in 0.007 seconds
[0m23:02:46.855771 [debug] [ThreadPool]: On create_neondb_public_marts: Close
[0m23:02:46.857788 [debug] [ThreadPool]: Acquiring new postgres connection 'list_neondb_public_marts'
[0m23:02:46.857788 [debug] [ThreadPool]: Acquiring new postgres connection 'list_neondb_public_staging'
[0m23:02:46.864841 [debug] [ThreadPool]: Using postgres connection "list_neondb_public_marts"
[0m23:02:46.867923 [debug] [ThreadPool]: Using postgres connection "list_neondb_public_staging"
[0m23:02:46.867923 [debug] [ThreadPool]: On list_neondb_public_marts: BEGIN
[0m23:02:46.868929 [debug] [ThreadPool]: On list_neondb_public_staging: BEGIN
[0m23:02:46.868929 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:02:46.870047 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:02:46.926749 [debug] [ThreadPool]: SQL status: BEGIN in 0.057 seconds
[0m23:02:46.927757 [debug] [ThreadPool]: Using postgres connection "list_neondb_public_staging"
[0m23:02:46.927757 [debug] [ThreadPool]: On list_neondb_public_staging: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "connection_name": "list_neondb_public_staging"} */
select
      'neondb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'neondb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'neondb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m23:02:46.936762 [debug] [ThreadPool]: SQL status: BEGIN in 0.067 seconds
[0m23:02:46.936762 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.008 seconds
[0m23:02:46.937919 [debug] [ThreadPool]: Using postgres connection "list_neondb_public_marts"
[0m23:02:46.938927 [debug] [ThreadPool]: On list_neondb_public_staging: ROLLBACK
[0m23:02:46.938927 [debug] [ThreadPool]: On list_neondb_public_marts: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "connection_name": "list_neondb_public_marts"} */
select
      'neondb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'neondb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'neondb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m23:02:46.947050 [debug] [ThreadPool]: On list_neondb_public_staging: Close
[0m23:02:46.949080 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.009 seconds
[0m23:02:46.950108 [debug] [ThreadPool]: On list_neondb_public_marts: ROLLBACK
[0m23:02:46.957766 [debug] [ThreadPool]: On list_neondb_public_marts: Close
[0m23:02:46.962973 [debug] [MainThread]: Using postgres connection "master"
[0m23:02:46.963979 [debug] [MainThread]: On master: BEGIN
[0m23:02:46.963979 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:02:47.027862 [debug] [MainThread]: SQL status: BEGIN in 0.064 seconds
[0m23:02:47.028966 [debug] [MainThread]: Using postgres connection "master"
[0m23:02:47.029975 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:02:47.038774 [debug] [MainThread]: SQL status: SELECT 2 in 0.009 seconds
[0m23:02:47.040789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5af1a79d-abad-435c-bacc-82311a982078', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D65A508250>]}
[0m23:02:47.040789 [debug] [MainThread]: On master: ROLLBACK
[0m23:02:47.050216 [debug] [MainThread]: Using postgres connection "master"
[0m23:02:47.050216 [debug] [MainThread]: On master: BEGIN
[0m23:02:47.064556 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m23:02:47.064556 [debug] [MainThread]: On master: COMMIT
[0m23:02:47.065561 [debug] [MainThread]: Using postgres connection "master"
[0m23:02:47.065561 [debug] [MainThread]: On master: COMMIT
[0m23:02:47.072302 [debug] [MainThread]: SQL status: COMMIT in 0.006 seconds
[0m23:02:47.072302 [debug] [MainThread]: On master: Close
[0m23:02:47.073309 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:02:47.074313 [info ] [MainThread]: 
[0m23:02:47.078346 [debug] [Thread-1 (]: Began running node model.its_on_sale.stg_price_history
[0m23:02:47.078346 [debug] [Thread-2 (]: Began running node model.its_on_sale.stg_product
[0m23:02:47.079366 [info ] [Thread-1 (]: 1 of 3 START sql view model public_staging.stg_price_history ................... [RUN]
[0m23:02:47.080374 [info ] [Thread-2 (]: 2 of 3 START sql view model public_staging.stg_product ......................... [RUN]
[0m23:02:47.081378 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.its_on_sale.stg_price_history'
[0m23:02:47.081378 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.its_on_sale.stg_product'
[0m23:02:47.082387 [debug] [Thread-1 (]: Began compiling node model.its_on_sale.stg_price_history
[0m23:02:47.083392 [debug] [Thread-2 (]: Began compiling node model.its_on_sale.stg_product
[0m23:02:47.090492 [debug] [Thread-1 (]: Writing injected SQL for node "model.its_on_sale.stg_price_history"
[0m23:02:47.093515 [debug] [Thread-2 (]: Writing injected SQL for node "model.its_on_sale.stg_product"
[0m23:02:47.094533 [debug] [Thread-1 (]: Began executing node model.its_on_sale.stg_price_history
[0m23:02:47.099566 [debug] [Thread-2 (]: Began executing node model.its_on_sale.stg_product
[0m23:02:47.132103 [debug] [Thread-1 (]: Writing runtime sql for node "model.its_on_sale.stg_price_history"
[0m23:02:47.138138 [debug] [Thread-2 (]: Writing runtime sql for node "model.its_on_sale.stg_product"
[0m23:02:47.139144 [debug] [Thread-1 (]: Using postgres connection "model.its_on_sale.stg_price_history"
[0m23:02:47.140170 [debug] [Thread-1 (]: On model.its_on_sale.stg_price_history: BEGIN
[0m23:02:47.140170 [debug] [Thread-2 (]: Using postgres connection "model.its_on_sale.stg_product"
[0m23:02:47.141174 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:02:47.141174 [debug] [Thread-2 (]: On model.its_on_sale.stg_product: BEGIN
[0m23:02:47.142181 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:02:47.208485 [debug] [Thread-1 (]: SQL status: BEGIN in 0.068 seconds
[0m23:02:47.209493 [debug] [Thread-1 (]: Using postgres connection "model.its_on_sale.stg_price_history"
[0m23:02:47.210497 [debug] [Thread-1 (]: On model.its_on_sale.stg_price_history: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "node_id": "model.its_on_sale.stg_price_history"} */

  create view "neondb"."public_staging"."stg_price_history__dbt_tmp"
    
    
  as (
    -- Basic staging view over price_history

select
  id,
  product_id,
  ts_utc,
  cast(price_numeric as numeric(12,2)) as price,
  currency,
  in_stock_bool as in_stock,
  on_sale_bool as on_sale,
  source_hash
from public.price_history
  );
[0m23:02:47.223171 [debug] [Thread-2 (]: SQL status: BEGIN in 0.081 seconds
[0m23:02:47.223171 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m23:02:47.224180 [debug] [Thread-2 (]: Using postgres connection "model.its_on_sale.stg_product"
[0m23:02:47.230219 [debug] [Thread-1 (]: Using postgres connection "model.its_on_sale.stg_price_history"
[0m23:02:47.231225 [debug] [Thread-2 (]: On model.its_on_sale.stg_product: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "node_id": "model.its_on_sale.stg_product"} */

  create view "neondb"."public_staging"."stg_product__dbt_tmp"
    
    
  as (
    -- Basic staging view over product

select
  product_id,
  site,
  url,
  name,
  created_at
from public.product
  );
[0m23:02:47.232231 [debug] [Thread-1 (]: On model.its_on_sale.stg_price_history: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "node_id": "model.its_on_sale.stg_price_history"} */
alter table "neondb"."public_staging"."stg_price_history" rename to "stg_price_history__dbt_backup"
[0m23:02:47.239652 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m23:02:47.242671 [debug] [Thread-1 (]: Using postgres connection "model.its_on_sale.stg_price_history"
[0m23:02:47.242671 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m23:02:47.243675 [debug] [Thread-1 (]: On model.its_on_sale.stg_price_history: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "node_id": "model.its_on_sale.stg_price_history"} */
alter table "neondb"."public_staging"."stg_price_history__dbt_tmp" rename to "stg_price_history"
[0m23:02:47.246705 [debug] [Thread-2 (]: Using postgres connection "model.its_on_sale.stg_product"
[0m23:02:47.247708 [debug] [Thread-2 (]: On model.its_on_sale.stg_product: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "node_id": "model.its_on_sale.stg_product"} */
alter table "neondb"."public_staging"."stg_product" rename to "stg_product__dbt_backup"
[0m23:02:47.254664 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m23:02:47.254664 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m23:02:47.257678 [debug] [Thread-2 (]: Using postgres connection "model.its_on_sale.stg_product"
[0m23:02:47.274844 [debug] [Thread-1 (]: On model.its_on_sale.stg_price_history: COMMIT
[0m23:02:47.275849 [debug] [Thread-2 (]: On model.its_on_sale.stg_product: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "node_id": "model.its_on_sale.stg_product"} */
alter table "neondb"."public_staging"."stg_product__dbt_tmp" rename to "stg_product"
[0m23:02:47.276853 [debug] [Thread-1 (]: Using postgres connection "model.its_on_sale.stg_price_history"
[0m23:02:47.276853 [debug] [Thread-1 (]: On model.its_on_sale.stg_price_history: COMMIT
[0m23:02:47.283331 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m23:02:47.284369 [debug] [Thread-2 (]: On model.its_on_sale.stg_product: COMMIT
[0m23:02:47.285435 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m23:02:47.286443 [debug] [Thread-2 (]: Using postgres connection "model.its_on_sale.stg_product"
[0m23:02:47.292489 [debug] [Thread-1 (]: Applying DROP to: "neondb"."public_staging"."stg_price_history__dbt_backup"
[0m23:02:47.293498 [debug] [Thread-2 (]: On model.its_on_sale.stg_product: COMMIT
[0m23:02:47.298515 [debug] [Thread-1 (]: Using postgres connection "model.its_on_sale.stg_price_history"
[0m23:02:47.299522 [debug] [Thread-1 (]: On model.its_on_sale.stg_price_history: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "node_id": "model.its_on_sale.stg_price_history"} */
drop view if exists "neondb"."public_staging"."stg_price_history__dbt_backup" cascade
[0m23:02:47.305610 [debug] [Thread-2 (]: SQL status: COMMIT in 0.006 seconds
[0m23:02:47.308629 [debug] [Thread-2 (]: Applying DROP to: "neondb"."public_staging"."stg_product__dbt_backup"
[0m23:02:47.308629 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.009 seconds
[0m23:02:47.309633 [debug] [Thread-2 (]: Using postgres connection "model.its_on_sale.stg_product"
[0m23:02:47.312650 [debug] [Thread-1 (]: On model.its_on_sale.stg_price_history: Close
[0m23:02:47.312650 [debug] [Thread-2 (]: On model.its_on_sale.stg_product: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "node_id": "model.its_on_sale.stg_product"} */
drop view if exists "neondb"."public_staging"."stg_product__dbt_backup" cascade
[0m23:02:47.314661 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5af1a79d-abad-435c-bacc-82311a982078', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D65A7B9E90>]}
[0m23:02:47.315743 [info ] [Thread-1 (]: 1 of 3 OK created sql view model public_staging.stg_price_history .............. [[32mCREATE VIEW[0m in 0.23s]
[0m23:02:47.316749 [debug] [Thread-1 (]: Finished running node model.its_on_sale.stg_price_history
[0m23:02:47.322595 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.009 seconds
[0m23:02:47.323601 [debug] [Thread-2 (]: On model.its_on_sale.stg_product: Close
[0m23:02:47.324605 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5af1a79d-abad-435c-bacc-82311a982078', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D65ABD7B10>]}
[0m23:02:47.325609 [info ] [Thread-2 (]: 2 of 3 OK created sql view model public_staging.stg_product .................... [[32mCREATE VIEW[0m in 0.24s]
[0m23:02:47.326613 [debug] [Thread-2 (]: Finished running node model.its_on_sale.stg_product
[0m23:02:47.327621 [debug] [Thread-4 (]: Began running node model.its_on_sale.fact_price_history
[0m23:02:47.328630 [info ] [Thread-4 (]: 3 of 3 START sql view model public_marts.fact_price_history .................... [RUN]
[0m23:02:47.329635 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.its_on_sale.fact_price_history'
[0m23:02:47.329635 [debug] [Thread-4 (]: Began compiling node model.its_on_sale.fact_price_history
[0m23:02:47.332885 [debug] [Thread-4 (]: Writing injected SQL for node "model.its_on_sale.fact_price_history"
[0m23:02:47.335041 [debug] [Thread-4 (]: Began executing node model.its_on_sale.fact_price_history
[0m23:02:47.339288 [debug] [Thread-4 (]: Writing runtime sql for node "model.its_on_sale.fact_price_history"
[0m23:02:47.340292 [debug] [Thread-4 (]: Using postgres connection "model.its_on_sale.fact_price_history"
[0m23:02:47.341304 [debug] [Thread-4 (]: On model.its_on_sale.fact_price_history: BEGIN
[0m23:02:47.341304 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:02:47.396930 [debug] [Thread-4 (]: SQL status: BEGIN in 0.056 seconds
[0m23:02:47.398007 [debug] [Thread-4 (]: Using postgres connection "model.its_on_sale.fact_price_history"
[0m23:02:47.399017 [debug] [Thread-4 (]: On model.its_on_sale.fact_price_history: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "node_id": "model.its_on_sale.fact_price_history"} */

  create view "neondb"."public_marts"."fact_price_history__dbt_tmp"
    
    
  as (
    -- Fact table for price time series

select
  ph.id,
  ph.product_id,
  p.site,
  p.url,
  p.name,
  ph.ts_utc,
  ph.price,
  ph.currency,
  ph.in_stock,
  ph.on_sale
from "neondb"."public_staging"."stg_price_history" ph
join "neondb"."public_staging"."stg_product" p
  on p.product_id = ph.product_id
  );
[0m23:02:47.407111 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m23:02:47.411112 [debug] [Thread-4 (]: Using postgres connection "model.its_on_sale.fact_price_history"
[0m23:02:47.411112 [debug] [Thread-4 (]: On model.its_on_sale.fact_price_history: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "node_id": "model.its_on_sale.fact_price_history"} */
alter table "neondb"."public_marts"."fact_price_history__dbt_tmp" rename to "fact_price_history"
[0m23:02:47.417415 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m23:02:47.418422 [debug] [Thread-4 (]: On model.its_on_sale.fact_price_history: COMMIT
[0m23:02:47.419872 [debug] [Thread-4 (]: Using postgres connection "model.its_on_sale.fact_price_history"
[0m23:02:47.419872 [debug] [Thread-4 (]: On model.its_on_sale.fact_price_history: COMMIT
[0m23:02:47.426792 [debug] [Thread-4 (]: SQL status: COMMIT in 0.006 seconds
[0m23:02:47.430807 [debug] [Thread-4 (]: Applying DROP to: "neondb"."public_marts"."fact_price_history__dbt_backup"
[0m23:02:47.431850 [debug] [Thread-4 (]: Using postgres connection "model.its_on_sale.fact_price_history"
[0m23:02:47.432849 [debug] [Thread-4 (]: On model.its_on_sale.fact_price_history: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "node_id": "model.its_on_sale.fact_price_history"} */
drop view if exists "neondb"."public_marts"."fact_price_history__dbt_backup" cascade
[0m23:02:47.438292 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.006 seconds
[0m23:02:47.440728 [debug] [Thread-4 (]: On model.its_on_sale.fact_price_history: Close
[0m23:02:47.441733 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5af1a79d-abad-435c-bacc-82311a982078', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D65A7C7610>]}
[0m23:02:47.442736 [info ] [Thread-4 (]: 3 of 3 OK created sql view model public_marts.fact_price_history ............... [[32mCREATE VIEW[0m in 0.11s]
[0m23:02:47.443747 [debug] [Thread-4 (]: Finished running node model.its_on_sale.fact_price_history
[0m23:02:47.444755 [debug] [MainThread]: Using postgres connection "master"
[0m23:02:47.445764 [debug] [MainThread]: On master: BEGIN
[0m23:02:47.445764 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:02:47.521773 [debug] [MainThread]: SQL status: BEGIN in 0.076 seconds
[0m23:02:47.522783 [debug] [MainThread]: On master: COMMIT
[0m23:02:47.522783 [debug] [MainThread]: Using postgres connection "master"
[0m23:02:47.523787 [debug] [MainThread]: On master: COMMIT
[0m23:02:47.530749 [debug] [MainThread]: SQL status: COMMIT in 0.007 seconds
[0m23:02:47.530749 [debug] [MainThread]: On master: Close
[0m23:02:47.531880 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:02:47.532888 [debug] [MainThread]: Connection 'create_neondb_public_marts' was properly closed.
[0m23:02:47.532888 [debug] [MainThread]: Connection 'list_neondb' was properly closed.
[0m23:02:47.533893 [debug] [MainThread]: Connection 'list_neondb_public_marts' was properly closed.
[0m23:02:47.533893 [debug] [MainThread]: Connection 'list_neondb_public_staging' was properly closed.
[0m23:02:47.534898 [debug] [MainThread]: Connection 'model.its_on_sale.stg_price_history' was properly closed.
[0m23:02:47.534898 [debug] [MainThread]: Connection 'model.its_on_sale.stg_product' was properly closed.
[0m23:02:47.535905 [debug] [MainThread]: Connection 'model.its_on_sale.fact_price_history' was properly closed.
[0m23:02:47.535905 [info ] [MainThread]: 
[0m23:02:47.536908 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 1.07 seconds (1.07s).
[0m23:02:47.538930 [debug] [MainThread]: Command end result
[0m23:02:47.575298 [info ] [MainThread]: 
[0m23:02:47.576302 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:02:47.576302 [info ] [MainThread]: 
[0m23:02:47.577313 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m23:02:47.579478 [debug] [MainThread]: Command `dbt run` succeeded at 23:02:47.579478 after 1.81 seconds
[0m23:02:47.580482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D651BB0E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D651BB0D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D6518E7210>]}
[0m23:02:47.580482 [debug] [MainThread]: Flushing usage events
[0m23:02:52.144075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F4E940250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F4F95B290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F4F95A950>]}


============================== 23:02:52.149183 | d89da833-3340-48b5-b8bf-3f220f4ca2c9 ==============================
[0m23:02:52.149183 [info ] [MainThread]: Running with dbt=1.8.8
[0m23:02:52.150203 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '..\\', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': "C:\\Users\\meg\\Documents\\cam\\proj\\It's On Sale\\its-on-sale-tracker\\pipeline\\transform\\its_on_sale\\logs", 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --profiles-dir ..\\', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:02:52.389803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd89da833-3340-48b5-b8bf-3f220f4ca2c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F4FA23A50>]}
[0m23:02:52.443780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd89da833-3340-48b5-b8bf-3f220f4ca2c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F4B980550>]}
[0m23:02:52.445832 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:02:52.454999 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m23:02:52.625739 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:02:52.625739 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:02:52.664699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd89da833-3340-48b5-b8bf-3f220f4ca2c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F4FC88490>]}
[0m23:02:52.779758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd89da833-3340-48b5-b8bf-3f220f4ca2c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F4FEAFF10>]}
[0m23:02:52.780762 [info ] [MainThread]: Found 3 models, 14 data tests, 423 macros
[0m23:02:52.781766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd89da833-3340-48b5-b8bf-3f220f4ca2c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F4FB60CD0>]}
[0m23:02:52.783824 [info ] [MainThread]: 
[0m23:02:52.784827 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:02:52.789907 [debug] [ThreadPool]: Acquiring new postgres connection 'list_neondb_public_marts'
[0m23:02:52.790913 [debug] [ThreadPool]: Acquiring new postgres connection 'list_neondb_public_staging'
[0m23:02:52.992776 [debug] [ThreadPool]: Using postgres connection "list_neondb_public_marts"
[0m23:02:52.992776 [debug] [ThreadPool]: Using postgres connection "list_neondb_public_staging"
[0m23:02:52.993780 [debug] [ThreadPool]: On list_neondb_public_marts: BEGIN
[0m23:02:52.993780 [debug] [ThreadPool]: On list_neondb_public_staging: BEGIN
[0m23:02:52.994790 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:02:52.994790 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:02:53.068785 [debug] [ThreadPool]: SQL status: BEGIN in 0.074 seconds
[0m23:02:53.068785 [debug] [ThreadPool]: Using postgres connection "list_neondb_public_marts"
[0m23:02:53.069821 [debug] [ThreadPool]: On list_neondb_public_marts: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "connection_name": "list_neondb_public_marts"} */
select
      'neondb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'neondb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'neondb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m23:02:53.076235 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m23:02:53.077240 [debug] [ThreadPool]: On list_neondb_public_marts: ROLLBACK
[0m23:02:53.078252 [debug] [ThreadPool]: SQL status: BEGIN in 0.083 seconds
[0m23:02:53.078252 [debug] [ThreadPool]: Using postgres connection "list_neondb_public_staging"
[0m23:02:53.079256 [debug] [ThreadPool]: On list_neondb_public_staging: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "connection_name": "list_neondb_public_staging"} */
select
      'neondb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'neondb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'neondb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m23:02:53.084071 [debug] [ThreadPool]: On list_neondb_public_marts: Close
[0m23:02:53.086014 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.006 seconds
[0m23:02:53.087244 [debug] [ThreadPool]: On list_neondb_public_staging: ROLLBACK
[0m23:02:53.095341 [debug] [ThreadPool]: On list_neondb_public_staging: Close
[0m23:02:53.100364 [debug] [MainThread]: Using postgres connection "master"
[0m23:02:53.101367 [debug] [MainThread]: On master: BEGIN
[0m23:02:53.102374 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:02:53.160888 [debug] [MainThread]: SQL status: BEGIN in 0.059 seconds
[0m23:02:53.160888 [debug] [MainThread]: Using postgres connection "master"
[0m23:02:53.161896 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:02:53.169231 [debug] [MainThread]: SQL status: SELECT 4 in 0.006 seconds
[0m23:02:53.171256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd89da833-3340-48b5-b8bf-3f220f4ca2c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F4DF064D0>]}
[0m23:02:53.171256 [debug] [MainThread]: On master: ROLLBACK
[0m23:02:53.177928 [debug] [MainThread]: Using postgres connection "master"
[0m23:02:53.178934 [debug] [MainThread]: On master: BEGIN
[0m23:02:53.189959 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m23:02:53.189959 [debug] [MainThread]: On master: COMMIT
[0m23:02:53.190961 [debug] [MainThread]: Using postgres connection "master"
[0m23:02:53.191971 [debug] [MainThread]: On master: COMMIT
[0m23:02:53.196998 [debug] [MainThread]: SQL status: COMMIT in 0.005 seconds
[0m23:02:53.196998 [debug] [MainThread]: On master: Close
[0m23:02:53.198004 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:02:53.199007 [info ] [MainThread]: 
[0m23:02:53.203116 [debug] [Thread-1 (]: Began running node test.its_on_sale.not_null_fact_price_history_id.110f7c1113
[0m23:02:53.203116 [debug] [Thread-2 (]: Began running node test.its_on_sale.not_null_fact_price_history_ts_utc.78d3e6c462
[0m23:02:53.204167 [debug] [Thread-3 (]: Began running node test.its_on_sale.not_null_stg_price_history_id.cb86572049
[0m23:02:53.204167 [debug] [Thread-4 (]: Began running node test.its_on_sale.not_null_stg_price_history_product_id.082361509e
[0m23:02:53.205171 [info ] [Thread-1 (]: 1 of 14 START test not_null_fact_price_history_id .............................. [RUN]
[0m23:02:53.205171 [info ] [Thread-2 (]: 2 of 14 START test not_null_fact_price_history_ts_utc .......................... [RUN]
[0m23:02:53.206202 [info ] [Thread-3 (]: 3 of 14 START test not_null_stg_price_history_id ............................... [RUN]
[0m23:02:53.207286 [info ] [Thread-4 (]: 4 of 14 START test not_null_stg_price_history_product_id ....................... [RUN]
[0m23:02:53.208291 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.its_on_sale.not_null_fact_price_history_id.110f7c1113'
[0m23:02:53.209301 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.its_on_sale.not_null_fact_price_history_ts_utc.78d3e6c462'
[0m23:02:53.209301 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.its_on_sale.not_null_stg_price_history_id.cb86572049'
[0m23:02:53.210304 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.its_on_sale.not_null_stg_price_history_product_id.082361509e'
[0m23:02:53.211541 [debug] [Thread-1 (]: Began compiling node test.its_on_sale.not_null_fact_price_history_id.110f7c1113
[0m23:02:53.212549 [debug] [Thread-2 (]: Began compiling node test.its_on_sale.not_null_fact_price_history_ts_utc.78d3e6c462
[0m23:02:53.212549 [debug] [Thread-3 (]: Began compiling node test.its_on_sale.not_null_stg_price_history_id.cb86572049
[0m23:02:53.213553 [debug] [Thread-4 (]: Began compiling node test.its_on_sale.not_null_stg_price_history_product_id.082361509e
[0m23:02:53.233744 [debug] [Thread-1 (]: Writing injected SQL for node "test.its_on_sale.not_null_fact_price_history_id.110f7c1113"
[0m23:02:53.237899 [debug] [Thread-2 (]: Writing injected SQL for node "test.its_on_sale.not_null_fact_price_history_ts_utc.78d3e6c462"
[0m23:02:53.244084 [debug] [Thread-3 (]: Writing injected SQL for node "test.its_on_sale.not_null_stg_price_history_id.cb86572049"
[0m23:02:53.248107 [debug] [Thread-4 (]: Writing injected SQL for node "test.its_on_sale.not_null_stg_price_history_product_id.082361509e"
[0m23:02:53.250584 [debug] [Thread-1 (]: Began executing node test.its_on_sale.not_null_fact_price_history_id.110f7c1113
[0m23:02:53.250584 [debug] [Thread-2 (]: Began executing node test.its_on_sale.not_null_fact_price_history_ts_utc.78d3e6c462
[0m23:02:53.264681 [debug] [Thread-4 (]: Began executing node test.its_on_sale.not_null_stg_price_history_product_id.082361509e
[0m23:02:53.267805 [debug] [Thread-1 (]: Writing runtime sql for node "test.its_on_sale.not_null_fact_price_history_id.110f7c1113"
[0m23:02:53.267805 [debug] [Thread-3 (]: Began executing node test.its_on_sale.not_null_stg_price_history_id.cb86572049
[0m23:02:53.270820 [debug] [Thread-2 (]: Writing runtime sql for node "test.its_on_sale.not_null_fact_price_history_ts_utc.78d3e6c462"
[0m23:02:53.273827 [debug] [Thread-4 (]: Writing runtime sql for node "test.its_on_sale.not_null_stg_price_history_product_id.082361509e"
[0m23:02:53.276220 [debug] [Thread-3 (]: Writing runtime sql for node "test.its_on_sale.not_null_stg_price_history_id.cb86572049"
[0m23:02:53.277224 [debug] [Thread-1 (]: Using postgres connection "test.its_on_sale.not_null_fact_price_history_id.110f7c1113"
[0m23:02:53.278227 [debug] [Thread-2 (]: Using postgres connection "test.its_on_sale.not_null_fact_price_history_ts_utc.78d3e6c462"
[0m23:02:53.278227 [debug] [Thread-1 (]: On test.its_on_sale.not_null_fact_price_history_id.110f7c1113: BEGIN
[0m23:02:53.279491 [debug] [Thread-4 (]: Using postgres connection "test.its_on_sale.not_null_stg_price_history_product_id.082361509e"
[0m23:02:53.279491 [debug] [Thread-2 (]: On test.its_on_sale.not_null_fact_price_history_ts_utc.78d3e6c462: BEGIN
[0m23:02:53.280506 [debug] [Thread-3 (]: Using postgres connection "test.its_on_sale.not_null_stg_price_history_id.cb86572049"
[0m23:02:53.280506 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:02:53.281575 [debug] [Thread-4 (]: On test.its_on_sale.not_null_stg_price_history_product_id.082361509e: BEGIN
[0m23:02:53.281575 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:02:53.282615 [debug] [Thread-3 (]: On test.its_on_sale.not_null_stg_price_history_id.cb86572049: BEGIN
[0m23:02:53.283621 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:02:53.284703 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:02:53.344903 [debug] [Thread-3 (]: SQL status: BEGIN in 0.060 seconds
[0m23:02:53.344903 [debug] [Thread-3 (]: Using postgres connection "test.its_on_sale.not_null_stg_price_history_id.cb86572049"
[0m23:02:53.345910 [debug] [Thread-4 (]: SQL status: BEGIN in 0.062 seconds
[0m23:02:53.346915 [debug] [Thread-3 (]: On test.its_on_sale.not_null_stg_price_history_id.cb86572049: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "node_id": "test.its_on_sale.not_null_stg_price_history_id.cb86572049"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "neondb"."public_staging"."stg_price_history"
where id is null



      
    ) dbt_internal_test
[0m23:02:53.346915 [debug] [Thread-4 (]: Using postgres connection "test.its_on_sale.not_null_stg_price_history_product_id.082361509e"
[0m23:02:53.347926 [debug] [Thread-4 (]: On test.its_on_sale.not_null_stg_price_history_product_id.082361509e: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "node_id": "test.its_on_sale.not_null_stg_price_history_product_id.082361509e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from "neondb"."public_staging"."stg_price_history"
where product_id is null



      
    ) dbt_internal_test
[0m23:02:53.353652 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.006 seconds
[0m23:02:53.353652 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m23:02:53.358017 [debug] [Thread-3 (]: On test.its_on_sale.not_null_stg_price_history_id.cb86572049: ROLLBACK
[0m23:02:53.359021 [debug] [Thread-4 (]: On test.its_on_sale.not_null_stg_price_history_product_id.082361509e: ROLLBACK
[0m23:02:53.360025 [debug] [Thread-2 (]: SQL status: BEGIN in 0.078 seconds
[0m23:02:53.361030 [debug] [Thread-2 (]: Using postgres connection "test.its_on_sale.not_null_fact_price_history_ts_utc.78d3e6c462"
[0m23:02:53.361030 [debug] [Thread-1 (]: SQL status: BEGIN in 0.081 seconds
[0m23:02:53.362045 [debug] [Thread-2 (]: On test.its_on_sale.not_null_fact_price_history_ts_utc.78d3e6c462: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "node_id": "test.its_on_sale.not_null_fact_price_history_ts_utc.78d3e6c462"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ts_utc
from "neondb"."public_marts"."fact_price_history"
where ts_utc is null



      
    ) dbt_internal_test
[0m23:02:53.362045 [debug] [Thread-1 (]: Using postgres connection "test.its_on_sale.not_null_fact_price_history_id.110f7c1113"
[0m23:02:53.363056 [debug] [Thread-1 (]: On test.its_on_sale.not_null_fact_price_history_id.110f7c1113: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "node_id": "test.its_on_sale.not_null_fact_price_history_id.110f7c1113"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "neondb"."public_marts"."fact_price_history"
where id is null



      
    ) dbt_internal_test
[0m23:02:53.366725 [debug] [Thread-4 (]: On test.its_on_sale.not_null_stg_price_history_product_id.082361509e: Close
[0m23:02:53.366725 [debug] [Thread-3 (]: On test.its_on_sale.not_null_stg_price_history_id.cb86572049: Close
[0m23:02:53.368033 [info ] [Thread-4 (]: 4 of 14 PASS not_null_stg_price_history_product_id ............................. [[32mPASS[0m in 0.16s]
[0m23:02:53.368033 [info ] [Thread-3 (]: 3 of 14 PASS not_null_stg_price_history_id ..................................... [[32mPASS[0m in 0.16s]
[0m23:02:53.369124 [debug] [Thread-4 (]: Finished running node test.its_on_sale.not_null_stg_price_history_product_id.082361509e
[0m23:02:53.370308 [debug] [Thread-3 (]: Finished running node test.its_on_sale.not_null_stg_price_history_id.cb86572049
[0m23:02:53.370308 [debug] [Thread-4 (]: Began running node test.its_on_sale.not_null_stg_price_history_ts_utc.a6f1e7003a
[0m23:02:53.371311 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.009 seconds
[0m23:02:53.371311 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.008 seconds
[0m23:02:53.372604 [debug] [Thread-3 (]: Began running node test.its_on_sale.not_null_stg_product_product_id.5e35fa3f95
[0m23:02:53.372604 [info ] [Thread-4 (]: 5 of 14 START test not_null_stg_price_history_ts_utc ........................... [RUN]
[0m23:02:53.374674 [debug] [Thread-2 (]: On test.its_on_sale.not_null_fact_price_history_ts_utc.78d3e6c462: ROLLBACK
[0m23:02:53.376746 [debug] [Thread-1 (]: On test.its_on_sale.not_null_fact_price_history_id.110f7c1113: ROLLBACK
[0m23:02:53.377750 [info ] [Thread-3 (]: 6 of 14 START test not_null_stg_product_product_id ............................. [RUN]
[0m23:02:53.377750 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.its_on_sale.not_null_stg_price_history_product_id.082361509e, now test.its_on_sale.not_null_stg_price_history_ts_utc.a6f1e7003a)
[0m23:02:53.379776 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.its_on_sale.not_null_stg_price_history_id.cb86572049, now test.its_on_sale.not_null_stg_product_product_id.5e35fa3f95)
[0m23:02:53.380780 [debug] [Thread-4 (]: Began compiling node test.its_on_sale.not_null_stg_price_history_ts_utc.a6f1e7003a
[0m23:02:53.380780 [debug] [Thread-3 (]: Began compiling node test.its_on_sale.not_null_stg_product_product_id.5e35fa3f95
[0m23:02:53.385786 [debug] [Thread-4 (]: Writing injected SQL for node "test.its_on_sale.not_null_stg_price_history_ts_utc.a6f1e7003a"
[0m23:02:53.385786 [debug] [Thread-2 (]: On test.its_on_sale.not_null_fact_price_history_ts_utc.78d3e6c462: Close
[0m23:02:53.385786 [debug] [Thread-1 (]: On test.its_on_sale.not_null_fact_price_history_id.110f7c1113: Close
[0m23:02:53.391220 [debug] [Thread-3 (]: Writing injected SQL for node "test.its_on_sale.not_null_stg_product_product_id.5e35fa3f95"
[0m23:02:53.392545 [debug] [Thread-4 (]: Began executing node test.its_on_sale.not_null_stg_price_history_ts_utc.a6f1e7003a
[0m23:02:53.392545 [info ] [Thread-2 (]: 2 of 14 PASS not_null_fact_price_history_ts_utc ................................ [[32mPASS[0m in 0.18s]
[0m23:02:53.393556 [info ] [Thread-1 (]: 1 of 14 PASS not_null_fact_price_history_id .................................... [[32mPASS[0m in 0.19s]
[0m23:02:53.397717 [debug] [Thread-4 (]: Writing runtime sql for node "test.its_on_sale.not_null_stg_price_history_ts_utc.a6f1e7003a"
[0m23:02:53.398741 [debug] [Thread-3 (]: Began executing node test.its_on_sale.not_null_stg_product_product_id.5e35fa3f95
[0m23:02:53.398741 [debug] [Thread-2 (]: Finished running node test.its_on_sale.not_null_fact_price_history_ts_utc.78d3e6c462
[0m23:02:53.399905 [debug] [Thread-1 (]: Finished running node test.its_on_sale.not_null_fact_price_history_id.110f7c1113
[0m23:02:53.404227 [debug] [Thread-3 (]: Writing runtime sql for node "test.its_on_sale.not_null_stg_product_product_id.5e35fa3f95"
[0m23:02:53.405231 [debug] [Thread-4 (]: Using postgres connection "test.its_on_sale.not_null_stg_price_history_ts_utc.a6f1e7003a"
[0m23:02:53.405231 [debug] [Thread-2 (]: Began running node test.its_on_sale.not_null_stg_product_site.712843232d
[0m23:02:53.406574 [debug] [Thread-1 (]: Began running node test.its_on_sale.not_null_stg_product_url.2f8ccdc1e9
[0m23:02:53.406574 [debug] [Thread-4 (]: On test.its_on_sale.not_null_stg_price_history_ts_utc.a6f1e7003a: BEGIN
[0m23:02:53.407587 [debug] [Thread-3 (]: Using postgres connection "test.its_on_sale.not_null_stg_product_product_id.5e35fa3f95"
[0m23:02:53.407587 [info ] [Thread-2 (]: 7 of 14 START test not_null_stg_product_site ................................... [RUN]
[0m23:02:53.408858 [info ] [Thread-1 (]: 8 of 14 START test not_null_stg_product_url .................................... [RUN]
[0m23:02:53.409887 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:02:53.410901 [debug] [Thread-3 (]: On test.its_on_sale.not_null_stg_product_product_id.5e35fa3f95: BEGIN
[0m23:02:53.410901 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.its_on_sale.not_null_fact_price_history_ts_utc.78d3e6c462, now test.its_on_sale.not_null_stg_product_site.712843232d)
[0m23:02:53.412011 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.its_on_sale.not_null_fact_price_history_id.110f7c1113, now test.its_on_sale.not_null_stg_product_url.2f8ccdc1e9)
[0m23:02:53.413019 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:02:53.414021 [debug] [Thread-2 (]: Began compiling node test.its_on_sale.not_null_stg_product_site.712843232d
[0m23:02:53.415056 [debug] [Thread-1 (]: Began compiling node test.its_on_sale.not_null_stg_product_url.2f8ccdc1e9
[0m23:02:53.421250 [debug] [Thread-2 (]: Writing injected SQL for node "test.its_on_sale.not_null_stg_product_site.712843232d"
[0m23:02:53.427540 [debug] [Thread-1 (]: Writing injected SQL for node "test.its_on_sale.not_null_stg_product_url.2f8ccdc1e9"
[0m23:02:53.428545 [debug] [Thread-2 (]: Began executing node test.its_on_sale.not_null_stg_product_site.712843232d
[0m23:02:53.431977 [debug] [Thread-2 (]: Writing runtime sql for node "test.its_on_sale.not_null_stg_product_site.712843232d"
[0m23:02:53.432987 [debug] [Thread-1 (]: Began executing node test.its_on_sale.not_null_stg_product_url.2f8ccdc1e9
[0m23:02:53.436203 [debug] [Thread-1 (]: Writing runtime sql for node "test.its_on_sale.not_null_stg_product_url.2f8ccdc1e9"
[0m23:02:53.437206 [debug] [Thread-2 (]: Using postgres connection "test.its_on_sale.not_null_stg_product_site.712843232d"
[0m23:02:53.438367 [debug] [Thread-2 (]: On test.its_on_sale.not_null_stg_product_site.712843232d: BEGIN
[0m23:02:53.438367 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:02:53.439435 [debug] [Thread-1 (]: Using postgres connection "test.its_on_sale.not_null_stg_product_url.2f8ccdc1e9"
[0m23:02:53.440439 [debug] [Thread-1 (]: On test.its_on_sale.not_null_stg_product_url.2f8ccdc1e9: BEGIN
[0m23:02:53.440439 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:02:53.469518 [debug] [Thread-4 (]: SQL status: BEGIN in 0.060 seconds
[0m23:02:53.469518 [debug] [Thread-3 (]: SQL status: BEGIN in 0.057 seconds
[0m23:02:53.470535 [debug] [Thread-4 (]: Using postgres connection "test.its_on_sale.not_null_stg_price_history_ts_utc.a6f1e7003a"
[0m23:02:53.471539 [debug] [Thread-3 (]: Using postgres connection "test.its_on_sale.not_null_stg_product_product_id.5e35fa3f95"
[0m23:02:53.471539 [debug] [Thread-4 (]: On test.its_on_sale.not_null_stg_price_history_ts_utc.a6f1e7003a: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "node_id": "test.its_on_sale.not_null_stg_price_history_ts_utc.a6f1e7003a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ts_utc
from "neondb"."public_staging"."stg_price_history"
where ts_utc is null



      
    ) dbt_internal_test
[0m23:02:53.472548 [debug] [Thread-3 (]: On test.its_on_sale.not_null_stg_product_product_id.5e35fa3f95: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "node_id": "test.its_on_sale.not_null_stg_product_product_id.5e35fa3f95"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from "neondb"."public_staging"."stg_product"
where product_id is null



      
    ) dbt_internal_test
[0m23:02:53.478537 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.005 seconds
[0m23:02:53.478537 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.006 seconds
[0m23:02:53.480566 [debug] [Thread-3 (]: On test.its_on_sale.not_null_stg_product_product_id.5e35fa3f95: ROLLBACK
[0m23:02:53.481657 [debug] [Thread-4 (]: On test.its_on_sale.not_null_stg_price_history_ts_utc.a6f1e7003a: ROLLBACK
[0m23:02:53.488298 [debug] [Thread-3 (]: On test.its_on_sale.not_null_stg_product_product_id.5e35fa3f95: Close
[0m23:02:53.488298 [debug] [Thread-4 (]: On test.its_on_sale.not_null_stg_price_history_ts_utc.a6f1e7003a: Close
[0m23:02:53.489305 [info ] [Thread-3 (]: 6 of 14 PASS not_null_stg_product_product_id ................................... [[32mPASS[0m in 0.11s]
[0m23:02:53.490312 [info ] [Thread-4 (]: 5 of 14 PASS not_null_stg_price_history_ts_utc ................................. [[32mPASS[0m in 0.11s]
[0m23:02:53.490312 [debug] [Thread-3 (]: Finished running node test.its_on_sale.not_null_stg_product_product_id.5e35fa3f95
[0m23:02:53.491320 [debug] [Thread-4 (]: Finished running node test.its_on_sale.not_null_stg_price_history_ts_utc.a6f1e7003a
[0m23:02:53.492326 [debug] [Thread-3 (]: Began running node test.its_on_sale.relationships_fact_price_history_product_id__product_id__ref_stg_product_.42bbec0ccf
[0m23:02:53.492326 [debug] [Thread-4 (]: Began running node test.its_on_sale.relationships_stg_price_history_product_id__product_id__ref_stg_product_.055b801818
[0m23:02:53.493336 [debug] [Thread-1 (]: SQL status: BEGIN in 0.053 seconds
[0m23:02:53.493336 [info ] [Thread-3 (]: 9 of 14 START test relationships_fact_price_history_product_id__product_id__ref_stg_product_  [RUN]
[0m23:02:53.494350 [info ] [Thread-4 (]: 10 of 14 START test relationships_stg_price_history_product_id__product_id__ref_stg_product_  [RUN]
[0m23:02:53.495357 [debug] [Thread-1 (]: Using postgres connection "test.its_on_sale.not_null_stg_product_url.2f8ccdc1e9"
[0m23:02:53.496438 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.its_on_sale.not_null_stg_product_product_id.5e35fa3f95, now test.its_on_sale.relationships_fact_price_history_product_id__product_id__ref_stg_product_.42bbec0ccf)
[0m23:02:53.497450 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.its_on_sale.not_null_stg_price_history_ts_utc.a6f1e7003a, now test.its_on_sale.relationships_stg_price_history_product_id__product_id__ref_stg_product_.055b801818)
[0m23:02:53.497450 [debug] [Thread-1 (]: On test.its_on_sale.not_null_stg_product_url.2f8ccdc1e9: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "node_id": "test.its_on_sale.not_null_stg_product_url.2f8ccdc1e9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select url
from "neondb"."public_staging"."stg_product"
where url is null



      
    ) dbt_internal_test
[0m23:02:53.498461 [debug] [Thread-3 (]: Began compiling node test.its_on_sale.relationships_fact_price_history_product_id__product_id__ref_stg_product_.42bbec0ccf
[0m23:02:53.499505 [debug] [Thread-4 (]: Began compiling node test.its_on_sale.relationships_stg_price_history_product_id__product_id__ref_stg_product_.055b801818
[0m23:02:53.508587 [debug] [Thread-3 (]: Writing injected SQL for node "test.its_on_sale.relationships_fact_price_history_product_id__product_id__ref_stg_product_.42bbec0ccf"
[0m23:02:53.508587 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.009 seconds
[0m23:02:53.513729 [debug] [Thread-4 (]: Writing injected SQL for node "test.its_on_sale.relationships_stg_price_history_product_id__product_id__ref_stg_product_.055b801818"
[0m23:02:53.514766 [debug] [Thread-2 (]: SQL status: BEGIN in 0.076 seconds
[0m23:02:53.516780 [debug] [Thread-1 (]: On test.its_on_sale.not_null_stg_product_url.2f8ccdc1e9: ROLLBACK
[0m23:02:53.516780 [debug] [Thread-3 (]: Began executing node test.its_on_sale.relationships_fact_price_history_product_id__product_id__ref_stg_product_.42bbec0ccf
[0m23:02:53.517785 [debug] [Thread-2 (]: Using postgres connection "test.its_on_sale.not_null_stg_product_site.712843232d"
[0m23:02:53.518791 [debug] [Thread-4 (]: Began executing node test.its_on_sale.relationships_stg_price_history_product_id__product_id__ref_stg_product_.055b801818
[0m23:02:53.520810 [debug] [Thread-3 (]: Writing runtime sql for node "test.its_on_sale.relationships_fact_price_history_product_id__product_id__ref_stg_product_.42bbec0ccf"
[0m23:02:53.521820 [debug] [Thread-2 (]: On test.its_on_sale.not_null_stg_product_site.712843232d: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "node_id": "test.its_on_sale.not_null_stg_product_site.712843232d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select site
from "neondb"."public_staging"."stg_product"
where site is null



      
    ) dbt_internal_test
[0m23:02:53.524843 [debug] [Thread-4 (]: Writing runtime sql for node "test.its_on_sale.relationships_stg_price_history_product_id__product_id__ref_stg_product_.055b801818"
[0m23:02:53.524843 [debug] [Thread-1 (]: On test.its_on_sale.not_null_stg_product_url.2f8ccdc1e9: Close
[0m23:02:53.526917 [debug] [Thread-3 (]: Using postgres connection "test.its_on_sale.relationships_fact_price_history_product_id__product_id__ref_stg_product_.42bbec0ccf"
[0m23:02:53.527923 [debug] [Thread-3 (]: On test.its_on_sale.relationships_fact_price_history_product_id__product_id__ref_stg_product_.42bbec0ccf: BEGIN
[0m23:02:53.528933 [debug] [Thread-4 (]: Using postgres connection "test.its_on_sale.relationships_stg_price_history_product_id__product_id__ref_stg_product_.055b801818"
[0m23:02:53.527923 [info ] [Thread-1 (]: 8 of 14 PASS not_null_stg_product_url .......................................... [[32mPASS[0m in 0.12s]
[0m23:02:53.528933 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:02:53.529963 [debug] [Thread-4 (]: On test.its_on_sale.relationships_stg_price_history_product_id__product_id__ref_stg_product_.055b801818: BEGIN
[0m23:02:53.530970 [debug] [Thread-1 (]: Finished running node test.its_on_sale.not_null_stg_product_url.2f8ccdc1e9
[0m23:02:53.531980 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:02:53.532989 [debug] [Thread-1 (]: Began running node test.its_on_sale.unique_fact_price_history_id.0da56e5a2d
[0m23:02:53.533998 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.008 seconds
[0m23:02:53.535004 [info ] [Thread-1 (]: 11 of 14 START test unique_fact_price_history_id ............................... [RUN]
[0m23:02:53.537044 [debug] [Thread-2 (]: On test.its_on_sale.not_null_stg_product_site.712843232d: ROLLBACK
[0m23:02:53.538048 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.its_on_sale.not_null_stg_product_url.2f8ccdc1e9, now test.its_on_sale.unique_fact_price_history_id.0da56e5a2d)
[0m23:02:53.538048 [debug] [Thread-1 (]: Began compiling node test.its_on_sale.unique_fact_price_history_id.0da56e5a2d
[0m23:02:53.546201 [debug] [Thread-1 (]: Writing injected SQL for node "test.its_on_sale.unique_fact_price_history_id.0da56e5a2d"
[0m23:02:53.547208 [debug] [Thread-2 (]: On test.its_on_sale.not_null_stg_product_site.712843232d: Close
[0m23:02:53.548211 [info ] [Thread-2 (]: 7 of 14 PASS not_null_stg_product_site ......................................... [[32mPASS[0m in 0.14s]
[0m23:02:53.549223 [debug] [Thread-1 (]: Began executing node test.its_on_sale.unique_fact_price_history_id.0da56e5a2d
[0m23:02:53.550234 [debug] [Thread-2 (]: Finished running node test.its_on_sale.not_null_stg_product_site.712843232d
[0m23:02:53.553249 [debug] [Thread-1 (]: Writing runtime sql for node "test.its_on_sale.unique_fact_price_history_id.0da56e5a2d"
[0m23:02:53.554253 [debug] [Thread-2 (]: Began running node test.its_on_sale.unique_stg_price_history_id.b6bbfe8a58
[0m23:02:53.555257 [info ] [Thread-2 (]: 12 of 14 START test unique_stg_price_history_id ................................ [RUN]
[0m23:02:53.556267 [debug] [Thread-1 (]: Using postgres connection "test.its_on_sale.unique_fact_price_history_id.0da56e5a2d"
[0m23:02:53.556267 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.its_on_sale.not_null_stg_product_site.712843232d, now test.its_on_sale.unique_stg_price_history_id.b6bbfe8a58)
[0m23:02:53.557342 [debug] [Thread-1 (]: On test.its_on_sale.unique_fact_price_history_id.0da56e5a2d: BEGIN
[0m23:02:53.558348 [debug] [Thread-2 (]: Began compiling node test.its_on_sale.unique_stg_price_history_id.b6bbfe8a58
[0m23:02:53.558348 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:02:53.563394 [debug] [Thread-2 (]: Writing injected SQL for node "test.its_on_sale.unique_stg_price_history_id.b6bbfe8a58"
[0m23:02:53.564397 [debug] [Thread-2 (]: Began executing node test.its_on_sale.unique_stg_price_history_id.b6bbfe8a58
[0m23:02:53.567412 [debug] [Thread-2 (]: Writing runtime sql for node "test.its_on_sale.unique_stg_price_history_id.b6bbfe8a58"
[0m23:02:53.569420 [debug] [Thread-2 (]: Using postgres connection "test.its_on_sale.unique_stg_price_history_id.b6bbfe8a58"
[0m23:02:53.569420 [debug] [Thread-2 (]: On test.its_on_sale.unique_stg_price_history_id.b6bbfe8a58: BEGIN
[0m23:02:53.570429 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:02:53.583102 [debug] [Thread-4 (]: SQL status: BEGIN in 0.051 seconds
[0m23:02:53.584107 [debug] [Thread-4 (]: Using postgres connection "test.its_on_sale.relationships_stg_price_history_product_id__product_id__ref_stg_product_.055b801818"
[0m23:02:53.584107 [debug] [Thread-4 (]: On test.its_on_sale.relationships_stg_price_history_product_id__product_id__ref_stg_product_.055b801818: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "node_id": "test.its_on_sale.relationships_stg_price_history_product_id__product_id__ref_stg_product_.055b801818"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_id as from_field
    from "neondb"."public_staging"."stg_price_history"
    where product_id is not null
),

parent as (
    select product_id as to_field
    from "neondb"."public_staging"."stg_product"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m23:02:53.588738 [debug] [Thread-3 (]: SQL status: BEGIN in 0.059 seconds
[0m23:02:53.589757 [debug] [Thread-3 (]: Using postgres connection "test.its_on_sale.relationships_fact_price_history_product_id__product_id__ref_stg_product_.42bbec0ccf"
[0m23:02:53.589757 [debug] [Thread-3 (]: On test.its_on_sale.relationships_fact_price_history_product_id__product_id__ref_stg_product_.42bbec0ccf: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "node_id": "test.its_on_sale.relationships_fact_price_history_product_id__product_id__ref_stg_product_.42bbec0ccf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_id as from_field
    from "neondb"."public_marts"."fact_price_history"
    where product_id is not null
),

parent as (
    select product_id as to_field
    from "neondb"."public_staging"."stg_product"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m23:02:53.591784 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.007 seconds
[0m23:02:53.592792 [debug] [Thread-4 (]: On test.its_on_sale.relationships_stg_price_history_product_id__product_id__ref_stg_product_.055b801818: ROLLBACK
[0m23:02:53.596816 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.006 seconds
[0m23:02:53.597823 [debug] [Thread-3 (]: On test.its_on_sale.relationships_fact_price_history_product_id__product_id__ref_stg_product_.42bbec0ccf: ROLLBACK
[0m23:02:53.598833 [debug] [Thread-4 (]: On test.its_on_sale.relationships_stg_price_history_product_id__product_id__ref_stg_product_.055b801818: Close
[0m23:02:53.599837 [info ] [Thread-4 (]: 10 of 14 PASS relationships_stg_price_history_product_id__product_id__ref_stg_product_  [[32mPASS[0m in 0.10s]
[0m23:02:53.601136 [debug] [Thread-4 (]: Finished running node test.its_on_sale.relationships_stg_price_history_product_id__product_id__ref_stg_product_.055b801818
[0m23:02:53.601136 [debug] [Thread-4 (]: Began running node test.its_on_sale.unique_stg_product_product_id.fd1037e514
[0m23:02:53.602141 [info ] [Thread-4 (]: 13 of 14 START test unique_stg_product_product_id .............................. [RUN]
[0m23:02:53.603201 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.its_on_sale.relationships_stg_price_history_product_id__product_id__ref_stg_product_.055b801818, now test.its_on_sale.unique_stg_product_product_id.fd1037e514)
[0m23:02:53.603201 [debug] [Thread-4 (]: Began compiling node test.its_on_sale.unique_stg_product_product_id.fd1037e514
[0m23:02:53.607338 [debug] [Thread-4 (]: Writing injected SQL for node "test.its_on_sale.unique_stg_product_product_id.fd1037e514"
[0m23:02:53.608342 [debug] [Thread-3 (]: On test.its_on_sale.relationships_fact_price_history_product_id__product_id__ref_stg_product_.42bbec0ccf: Close
[0m23:02:53.609351 [debug] [Thread-4 (]: Began executing node test.its_on_sale.unique_stg_product_product_id.fd1037e514
[0m23:02:53.609351 [info ] [Thread-3 (]: 9 of 14 PASS relationships_fact_price_history_product_id__product_id__ref_stg_product_  [[32mPASS[0m in 0.11s]
[0m23:02:53.613605 [debug] [Thread-4 (]: Writing runtime sql for node "test.its_on_sale.unique_stg_product_product_id.fd1037e514"
[0m23:02:53.614605 [debug] [Thread-3 (]: Finished running node test.its_on_sale.relationships_fact_price_history_product_id__product_id__ref_stg_product_.42bbec0ccf
[0m23:02:53.615821 [debug] [Thread-3 (]: Began running node test.its_on_sale.unique_stg_product_url.35c93a6d66
[0m23:02:53.616954 [info ] [Thread-3 (]: 14 of 14 START test unique_stg_product_url ..................................... [RUN]
[0m23:02:53.616954 [debug] [Thread-4 (]: Using postgres connection "test.its_on_sale.unique_stg_product_product_id.fd1037e514"
[0m23:02:53.618029 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.its_on_sale.relationships_fact_price_history_product_id__product_id__ref_stg_product_.42bbec0ccf, now test.its_on_sale.unique_stg_product_url.35c93a6d66)
[0m23:02:53.619051 [debug] [Thread-4 (]: On test.its_on_sale.unique_stg_product_product_id.fd1037e514: BEGIN
[0m23:02:53.619051 [debug] [Thread-1 (]: SQL status: BEGIN in 0.061 seconds
[0m23:02:53.620150 [debug] [Thread-3 (]: Began compiling node test.its_on_sale.unique_stg_product_url.35c93a6d66
[0m23:02:53.620150 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:02:53.621154 [debug] [Thread-1 (]: Using postgres connection "test.its_on_sale.unique_fact_price_history_id.0da56e5a2d"
[0m23:02:53.625413 [debug] [Thread-3 (]: Writing injected SQL for node "test.its_on_sale.unique_stg_product_url.35c93a6d66"
[0m23:02:53.626422 [debug] [Thread-2 (]: SQL status: BEGIN in 0.056 seconds
[0m23:02:53.627425 [debug] [Thread-1 (]: On test.its_on_sale.unique_fact_price_history_id.0da56e5a2d: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "node_id": "test.its_on_sale.unique_fact_price_history_id.0da56e5a2d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "neondb"."public_marts"."fact_price_history"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:02:53.628493 [debug] [Thread-2 (]: Using postgres connection "test.its_on_sale.unique_stg_price_history_id.b6bbfe8a58"
[0m23:02:53.629497 [debug] [Thread-3 (]: Began executing node test.its_on_sale.unique_stg_product_url.35c93a6d66
[0m23:02:53.629497 [debug] [Thread-2 (]: On test.its_on_sale.unique_stg_price_history_id.b6bbfe8a58: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "node_id": "test.its_on_sale.unique_stg_price_history_id.b6bbfe8a58"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "neondb"."public_staging"."stg_price_history"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:02:53.632524 [debug] [Thread-3 (]: Writing runtime sql for node "test.its_on_sale.unique_stg_product_url.35c93a6d66"
[0m23:02:53.634626 [debug] [Thread-3 (]: Using postgres connection "test.its_on_sale.unique_stg_product_url.35c93a6d66"
[0m23:02:53.634626 [debug] [Thread-3 (]: On test.its_on_sale.unique_stg_product_url.35c93a6d66: BEGIN
[0m23:02:53.635631 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:02:53.638645 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.005 seconds
[0m23:02:53.640662 [debug] [Thread-2 (]: On test.its_on_sale.unique_stg_price_history_id.b6bbfe8a58: ROLLBACK
[0m23:02:53.640662 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.012 seconds
[0m23:02:53.642673 [debug] [Thread-1 (]: On test.its_on_sale.unique_fact_price_history_id.0da56e5a2d: ROLLBACK
[0m23:02:53.646665 [debug] [Thread-2 (]: On test.its_on_sale.unique_stg_price_history_id.b6bbfe8a58: Close
[0m23:02:53.647670 [info ] [Thread-2 (]: 12 of 14 PASS unique_stg_price_history_id ...................................... [[32mPASS[0m in 0.09s]
[0m23:02:53.648743 [debug] [Thread-2 (]: Finished running node test.its_on_sale.unique_stg_price_history_id.b6bbfe8a58
[0m23:02:53.649762 [debug] [Thread-1 (]: On test.its_on_sale.unique_fact_price_history_id.0da56e5a2d: Close
[0m23:02:53.650770 [info ] [Thread-1 (]: 11 of 14 PASS unique_fact_price_history_id ..................................... [[32mPASS[0m in 0.11s]
[0m23:02:53.651775 [debug] [Thread-1 (]: Finished running node test.its_on_sale.unique_fact_price_history_id.0da56e5a2d
[0m23:02:53.675744 [debug] [Thread-4 (]: SQL status: BEGIN in 0.055 seconds
[0m23:02:53.676753 [debug] [Thread-4 (]: Using postgres connection "test.its_on_sale.unique_stg_product_product_id.fd1037e514"
[0m23:02:53.676753 [debug] [Thread-4 (]: On test.its_on_sale.unique_stg_product_product_id.fd1037e514: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "node_id": "test.its_on_sale.unique_stg_product_product_id.fd1037e514"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "neondb"."public_staging"."stg_product"
where product_id is not null
group by product_id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:02:53.682871 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m23:02:53.684871 [debug] [Thread-4 (]: On test.its_on_sale.unique_stg_product_product_id.fd1037e514: ROLLBACK
[0m23:02:53.690111 [debug] [Thread-4 (]: On test.its_on_sale.unique_stg_product_product_id.fd1037e514: Close
[0m23:02:53.691154 [info ] [Thread-4 (]: 13 of 14 PASS unique_stg_product_product_id .................................... [[32mPASS[0m in 0.09s]
[0m23:02:53.692158 [debug] [Thread-4 (]: Finished running node test.its_on_sale.unique_stg_product_product_id.fd1037e514
[0m23:02:53.692158 [debug] [Thread-3 (]: SQL status: BEGIN in 0.057 seconds
[0m23:02:53.693167 [debug] [Thread-3 (]: Using postgres connection "test.its_on_sale.unique_stg_product_url.35c93a6d66"
[0m23:02:53.694190 [debug] [Thread-3 (]: On test.its_on_sale.unique_stg_product_url.35c93a6d66: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "its_on_sale", "target_name": "dev", "node_id": "test.its_on_sale.unique_stg_product_url.35c93a6d66"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    url as unique_field,
    count(*) as n_records

from "neondb"."public_staging"."stg_product"
where url is not null
group by url
having count(*) > 1



      
    ) dbt_internal_test
[0m23:02:53.700310 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.006 seconds
[0m23:02:53.702327 [debug] [Thread-3 (]: On test.its_on_sale.unique_stg_product_url.35c93a6d66: ROLLBACK
[0m23:02:53.710248 [debug] [Thread-3 (]: On test.its_on_sale.unique_stg_product_url.35c93a6d66: Close
[0m23:02:53.711316 [info ] [Thread-3 (]: 14 of 14 PASS unique_stg_product_url ........................................... [[32mPASS[0m in 0.09s]
[0m23:02:53.712323 [debug] [Thread-3 (]: Finished running node test.its_on_sale.unique_stg_product_url.35c93a6d66
[0m23:02:53.714375 [debug] [MainThread]: Using postgres connection "master"
[0m23:02:53.714375 [debug] [MainThread]: On master: BEGIN
[0m23:02:53.715379 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:02:53.770556 [debug] [MainThread]: SQL status: BEGIN in 0.055 seconds
[0m23:02:53.771020 [debug] [MainThread]: On master: COMMIT
[0m23:02:53.772019 [debug] [MainThread]: Using postgres connection "master"
[0m23:02:53.772019 [debug] [MainThread]: On master: COMMIT
[0m23:02:53.777259 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m23:02:53.777259 [debug] [MainThread]: On master: Close
[0m23:02:53.778267 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:02:53.779274 [debug] [MainThread]: Connection 'list_neondb_public_marts' was properly closed.
[0m23:02:53.779274 [debug] [MainThread]: Connection 'list_neondb_public_staging' was properly closed.
[0m23:02:53.779274 [debug] [MainThread]: Connection 'test.its_on_sale.unique_fact_price_history_id.0da56e5a2d' was properly closed.
[0m23:02:53.780278 [debug] [MainThread]: Connection 'test.its_on_sale.unique_stg_price_history_id.b6bbfe8a58' was properly closed.
[0m23:02:53.780278 [debug] [MainThread]: Connection 'test.its_on_sale.unique_stg_product_url.35c93a6d66' was properly closed.
[0m23:02:53.781282 [debug] [MainThread]: Connection 'test.its_on_sale.unique_stg_product_product_id.fd1037e514' was properly closed.
[0m23:02:53.781282 [info ] [MainThread]: 
[0m23:02:53.782288 [info ] [MainThread]: Finished running 14 data tests in 0 hours 0 minutes and 1.00 seconds (1.00s).
[0m23:02:53.785322 [debug] [MainThread]: Command end result
[0m23:02:53.821777 [info ] [MainThread]: 
[0m23:02:53.822784 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:02:53.822784 [info ] [MainThread]: 
[0m23:02:53.823787 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 TOTAL=14
[0m23:02:53.825834 [debug] [MainThread]: Command `dbt test` succeeded at 23:02:53.824830 after 1.76 seconds
[0m23:02:53.825834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F4E93FE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F4F962C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F47120E10>]}
[0m23:02:53.826843 [debug] [MainThread]: Flushing usage events
